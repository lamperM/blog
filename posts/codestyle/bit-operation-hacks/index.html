<!doctype html><html><head><title>Bit Operation Hacks</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content="Some hacks about bit-operation. Updating..."><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/journal.min.3a21bd8eada75dab789b65a02a5e996329b32588dce385571d7c9a838ee2a361.css integrity="sha256-OiG9jq2nXat4m2WgKl6ZYymzJYjc44VXHXyag47io2E=" media=screen><link rel=stylesheet href=/scss/dark-mode.min.3ca7c5dafeea4e7cfb748d1ee31008edf99025ad05594f8ac00f0bd1befa08ee.css integrity="sha256-PKfF2v7qTnz7dI0e4xAI7fmQJa0FWU+KwA8L0b76CO4=" media=screen><script src=/vendor/js/loadCSS.js></script>
<script>loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons")</script><script src=/js/toc.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script>
<script src=/vendor/js/md5.min.js></script>
<script>var gitalk=new Gitalk({clientID:"12dfb0f809e5e6afde3d",clientSecret:"72aaf5660b3a7b43b0bffb4d683a605a7ea65dad",repo:"blogcomments_gitalk",owner:"wangloo",admin:["wangloo"],id:md5(location.pathname),distractionFreeMode:"false"});window.onload=function(){gitalk.render("gitalk-container")}</script></head><body><div id=app><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://wangloo.github.io/><div class=nav-title>Soben's Secret Base</div><div class=nav-subtitle>花有重开日, 人无再少年</div></a><div class=nav-link-list><a class="a-block nav-link-item active" href=/posts>Archive</a>
<a class="a-block nav-link-item false" href=/tags>Tags</a>
<a class="a-block nav-link-item false" href=/categories>Categories</a></div><div class=nav-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
@2019 Notepadium.</div></div><div id=extraContainer class=extra-container><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc-content><center>- CATALOG -</center><ul><ul><li><a href=#%e5%88%a4%e6%96%ad%e4%b8%80%e4%b8%aa%e6%95%b0%e6%98%af%e5%90%a6%e4%b8%ba2%e7%9a%84%e5%b9%82 onclick="onNavClick(`#判断一个数是否为2的幂-nav`)" id=判断一个数是否为2的幂-nav>判断一个数是否为2的幂</a></li><li><a href=#%e7%bb%9f%e8%ae%a1%e4%b8%80%e4%b8%aa%e6%95%b0%e7%9a%84%e4%ba%8c%e8%bf%9b%e5%88%b6%e4%b8%ad1%e7%9a%84%e6%95%b0%e9%87%8f onclick="onNavClick(`#统计一个数的二进制中1的数量-nav`)" id=统计一个数的二进制中1的数量-nav>统计一个数的二进制中1的数量</a></li><li><a href=#%e5%b0%86%e4%b8%80%e4%b8%aa%e6%95%b0%e5%90%91%e4%b8%8a%e5%8f%96%e6%95%b4%e4%b8%ba2%e7%9a%84%e5%b9%82 onclick="onNavClick(`#将一个数向上取整为2的幂-nav`)" id=将一个数向上取整为2的幂-nav>将一个数向上取整为2的幂</a></li><li><a href=#%e5%90%91%e4%b8%8a%e5%90%91%e4%b8%8b%e5%af%b9%e9%bd%90-%e6%a3%80%e6%9f%a5%e6%98%af%e5%90%a6%e5%af%b9%e9%bd%90 onclick="onNavClick(`#向上向下对齐-检查是否对齐-nav`)" id=向上向下对齐-检查是否对齐-nav>向上/向下对齐, 检查是否对齐</a></li><li><a href=#%e6%a3%80%e6%9f%a5%e4%b8%a4%e4%b8%aa%e6%9c%89%e7%ac%a6%e5%8f%b7%e6%95%b0%e6%98%af%e5%90%a6%e5%bc%82%e5%8f%b7 onclick="onNavClick(`#检查两个有符号数是否异号-nav`)" id=检查两个有符号数是否异号-nav>检查两个有符号数是否异号</a></li><li><a href=#%e5%a4%a7%e5%b0%8f%e7%ab%af%e8%bd%ac%e6%8d%a2 onclick="onNavClick(`#大小端转换-nav`)" id=大小端转换-nav>大小端转换</a></li><li><a href=#%e5%af%b9%e6%9f%90%e4%b8%aa%e4%bd%8d%e7%9a%84getsetclear%e6%93%8d%e4%bd%9c onclick="onNavClick(`#对某个位的getsetclear操作-nav`)" id=对某个位的getsetclear操作-nav>对某个位的get/set/clear操作</a></li><li><a href=#sign-extending-from-a-varaiable-bit-width onclick="onNavClick(`#sign-extending-from-a-varaiable-bit-width-nav`)" id=sign-extending-from-a-varaiable-bit-width-nav>Sign extending from a varaiable bit-width</a></li><li><a href=#%e5%ad%97%e7%ac%a6%e5%ad%97%e7%ac%a6%e6%95%b0%e7%bb%84%e7%9a%84%e5%a4%a7%e5%b0%8f%e5%86%99%e8%bd%ac%e6%8d%a2 onclick="onNavClick(`#字符字符数组的大小写转换-nav`)" id=字符字符数组的大小写转换-nav>字符/字符数组的大小写转换</a></li></ul></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a>
<a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item active" href=/posts>Archive</a>
<a class="a-block drawer-menu-item false" href=/tags>Tags</a>
<a class="a-block drawer-menu-item false" href=/categories>Categories</a><div class=toc><div class=toc-content><center>- CATALOG -</center><ul><ul><li><a href=#%e5%88%a4%e6%96%ad%e4%b8%80%e4%b8%aa%e6%95%b0%e6%98%af%e5%90%a6%e4%b8%ba2%e7%9a%84%e5%b9%82 onclick="onNavClick(`#判断一个数是否为2的幂-nav`)" id=判断一个数是否为2的幂-nav>判断一个数是否为2的幂</a></li><li><a href=#%e7%bb%9f%e8%ae%a1%e4%b8%80%e4%b8%aa%e6%95%b0%e7%9a%84%e4%ba%8c%e8%bf%9b%e5%88%b6%e4%b8%ad1%e7%9a%84%e6%95%b0%e9%87%8f onclick="onNavClick(`#统计一个数的二进制中1的数量-nav`)" id=统计一个数的二进制中1的数量-nav>统计一个数的二进制中1的数量</a></li><li><a href=#%e5%b0%86%e4%b8%80%e4%b8%aa%e6%95%b0%e5%90%91%e4%b8%8a%e5%8f%96%e6%95%b4%e4%b8%ba2%e7%9a%84%e5%b9%82 onclick="onNavClick(`#将一个数向上取整为2的幂-nav`)" id=将一个数向上取整为2的幂-nav>将一个数向上取整为2的幂</a></li><li><a href=#%e5%90%91%e4%b8%8a%e5%90%91%e4%b8%8b%e5%af%b9%e9%bd%90-%e6%a3%80%e6%9f%a5%e6%98%af%e5%90%a6%e5%af%b9%e9%bd%90 onclick="onNavClick(`#向上向下对齐-检查是否对齐-nav`)" id=向上向下对齐-检查是否对齐-nav>向上/向下对齐, 检查是否对齐</a></li><li><a href=#%e6%a3%80%e6%9f%a5%e4%b8%a4%e4%b8%aa%e6%9c%89%e7%ac%a6%e5%8f%b7%e6%95%b0%e6%98%af%e5%90%a6%e5%bc%82%e5%8f%b7 onclick="onNavClick(`#检查两个有符号数是否异号-nav`)" id=检查两个有符号数是否异号-nav>检查两个有符号数是否异号</a></li><li><a href=#%e5%a4%a7%e5%b0%8f%e7%ab%af%e8%bd%ac%e6%8d%a2 onclick="onNavClick(`#大小端转换-nav`)" id=大小端转换-nav>大小端转换</a></li><li><a href=#%e5%af%b9%e6%9f%90%e4%b8%aa%e4%bd%8d%e7%9a%84getsetclear%e6%93%8d%e4%bd%9c onclick="onNavClick(`#对某个位的getsetclear操作-nav`)" id=对某个位的getsetclear操作-nav>对某个位的get/set/clear操作</a></li><li><a href=#sign-extending-from-a-varaiable-bit-width onclick="onNavClick(`#sign-extending-from-a-varaiable-bit-width-nav`)" id=sign-extending-from-a-varaiable-bit-width-nav>Sign extending from a varaiable bit-width</a></li><li><a href=#%e5%ad%97%e7%ac%a6%e5%ad%97%e7%ac%a6%e6%95%b0%e7%bb%84%e7%9a%84%e5%a4%a7%e5%b0%8f%e5%86%99%e8%bd%ac%e6%8d%a2 onclick="onNavClick(`#字符字符数组的大小写转换-nav`)" id=字符字符数组的大小写转换-nav>字符/字符数组的大小写转换</a></li></ul></div></div></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu</i></button>
<a id=navTitle class=navbar-brand href=https://wangloo.github.io/>Soben's Secret Base</a>
<button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://wangloo.github.io/><div class=single-column-header-title>Soben's Secret Base</div><div class=single-column-header-subtitle>花有重开日, 人无再少年</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only><div class=post-title>Bit Operation Hacks<div class=post-subtitle>Some hacks about bit-operation. Updating...</div><div class=post-meta><time itemprop=datePublished>2022-07-03 09:44</time>
<i class=material-icons>label</i>
<a href=/tags/c>c</a>
&nbsp;
<a href=/tags/weapons>weapons</a>
&nbsp;
<i class=material-icons>schedule</i>
2 min
52 s.</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><h2 id=判断一个数是否为2的幂>判断一个数是否为2的幂</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8be9fd>unsigned</span> <span style=color:#8be9fd>int</span> v;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>if</span> ((v <span style=color:#ff79c6>&amp;</span> (v <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>)) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>) 
</span></span><span style=display:flex><span>    printf(<span style=color:#f1fa8c>&#34;v is a power of 2</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>else</span> 
</span></span><span style=display:flex><span>    <span style=color:#50fa7b>printf</span>(<span style=color:#f1fa8c>&#34;v is not a power of 2</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>);
</span></span></code></pre></div><p> </p><h2 id=统计一个数的二进制中1的数量>统计一个数的二进制中1的数量</h2><p>依然是利用<code>v & (v -1)</code>的运算结果会将v的最低位的<code>1</code>(如果有的话)置<code>0</code>.</p><p>循环执行此操作就可统计v中<code>1</code>的数量.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>numberof1</span>(<span style=color:#8be9fd>int</span> v) {
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> count <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span>(v) {
</span></span><span style=display:flex><span>        count<span style=color:#ff79c6>++</span>;
</span></span><span style=display:flex><span>        v <span style=color:#ff79c6>=</span> v <span style=color:#ff79c6>&amp;</span> (v <span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> count;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p> </p><h2 id=将一个数向上取整为2的幂>将一个数向上取整为2的幂</h2><p>用一个<code>1</code>一直左移, 直到比这个数大为止.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8be9fd>uint32_t</span> <span style=color:#50fa7b>roundup_pow_op_two</span>(<span style=color:#ff79c6>const</span> <span style=color:#8be9fd>uint32_t</span> x) {
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>uint32_t</span> ret <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span> (ret <span style=color:#ff79c6>&lt;</span> x) {
</span></span><span style=display:flex><span>        ret <span style=color:#ff79c6>=</span> ret <span style=color:#ff79c6>&lt;&lt;</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> ret;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p> </p><h2 id=向上向下对齐-检查是否对齐>向上/向下对齐, 检查是否对齐</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#6272a4>/* uintptr_t 代表指针的位数
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * 加uintptr_t转换的原因是: (void *)不能进行运算
</span></span></span><span style=display:flex><span><span style=color:#6272a4> */</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>#define IS_ALIGNED(X, align)  (((uintptr_t)(const void *)(X)) % (align) == 0)
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>#define ALIGN_UP(X, align)   (((X) + ((align) - 1)) &amp; ~((align) - 1))
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>#define ALIGN_DOWN(x, align) ((X) &amp; ~((align) - 1))
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>#define X      (0x12345675)
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>#define align  (1 &lt;&lt; 2)
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> v <span style=color:#ff79c6>=</span> IS_ALIGNED(X, align);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> (<span style=color:#bd93f9>0</span> <span style=color:#ff79c6>==</span> v) {
</span></span><span style=display:flex><span>        printf(<span style=color:#f1fa8c>&#34;Given X(0x%x) is not align to 0x%08x</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, X, align);
</span></span><span style=display:flex><span>        printf(<span style=color:#f1fa8c>&#34;After align up,   new X = 0x%x</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, ALIGN_UP(X, align));
</span></span><span style=display:flex><span>        printf(<span style=color:#f1fa8c>&#34;After align down, new X = 0x%x</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, ALIGN_DOWN(X, align));
</span></span><span style=display:flex><span>    } <span style=color:#ff79c6>else</span> {
</span></span><span style=display:flex><span>        printf(<span style=color:#f1fa8c>&#34;Give X(0x%x) is aligned to 0x%08x</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, X, align);
</span></span><span style=display:flex><span>        printf(<span style=color:#f1fa8c>&#34;After align up,   new X = 0x%x</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, ALIGN_UP(X, align));
</span></span><span style=display:flex><span>        printf(<span style=color:#f1fa8c>&#34;After align down, new X = 0x%x</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, ALIGN_DOWN(X, align));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p> </p><h2 id=检查两个有符号数是否异号>检查两个有符号数是否异号</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8be9fd>int</span> x,y;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>if</span> ((x <span style=color:#ff79c6>^</span> y) <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>0</span>) 
</span></span><span style=display:flex><span>    printf(<span style=color:#f1fa8c>&#34;They have opposite signs</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>else</span>
</span></span><span style=display:flex><span>    <span style=color:#50fa7b>printf</span>(<span style=color:#f1fa8c>&#34;They have same signs</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>);
</span></span></code></pre></div><p> </p><h2 id=大小端转换>大小端转换</h2><p> </p><h2 id=对某个位的getsetclear操作>对某个位的get/set/clear操作</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#ff79c6>#define GET_BIT(x, bit)     ( ((x) &amp; (1ULL &lt;&lt; (bit))) &gt;&gt; (bit) )
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>#define SET_BIT(x, bit)     ( (x) |= (1ULL &lt;&lt; (bit)) )
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>#define CLEAR_BIT(x, bit)   ( (x) &amp;= ~(1ULL &lt;&lt; (bit)) )
</span></span></span></code></pre></div><blockquote><p>Release note:</p><ol><li>添加对<code>unsigned long long</code>长度的支持</li></ol></blockquote><p> </p><h2 id=sign-extending-from-a-varaiable-bit-width>Sign extending from a varaiable bit-width</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>    <span style=color:#8be9fd>int</span> bits <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>8</span>; <span style=color:#6272a4>// number of bits representing the number in x
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#8be9fd>int</span> x <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0xFFC1</span>;   <span style=color:#6272a4>// ready to get sign-extended
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#8be9fd>int</span> rst;          <span style=color:#6272a4>// resulting sign-extended number
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#8be9fd>int</span> <span style=color:#ff79c6>const</span> mask <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1U</span> <span style=color:#ff79c6>&lt;&lt;</span> (bits <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>); <span style=color:#6272a4>// mask can be  pre-computed if bits if fixed.
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>
</span></span><span style=display:flex><span>    x <span style=color:#ff79c6>=</span> x <span style=color:#ff79c6>&amp;</span> ((<span style=color:#bd93f9>1U</span> <span style=color:#ff79c6>&lt;&lt;</span> bits) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>); <span style=color:#6272a4>// cut x if it holds more bits
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    rst <span style=color:#ff79c6>=</span> (x <span style=color:#ff79c6>^</span> mask) <span style=color:#ff79c6>-</span> mask;    <span style=color:#6272a4>// excellent trick!
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>
</span></span><span style=display:flex><span>    printf(<span style=color:#f1fa8c>&#34;INPUT: 0x%x, RESULT: 0x%x</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, x, rst);
</span></span></code></pre></div><p> </p><h2 id=字符字符数组的大小写转换>字符/字符数组的大小写转换</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#ff79c6>#define TO_LOWER(c) (unsigned char)((c &gt;= &#39;A&#39; &amp;&amp; c &lt;= &#39;Z&#39;) ? (c | 0x20) : c)
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>#define TO_UPPER(c) (unsigned char)((c &gt;= &#39;a&#39; &amp;&amp; c &lt;= &#39;z&#39;) ? (c &amp; ~0x20) : c)
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>#define TO_LOWER_STR(s, len) { \
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>    for (int i = 0; i &lt; len &amp;&amp; s[i] != &#39;\0&#39;; i++) { \
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>        s[i] = TO_LOWER(s[i]); \
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>    } \
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>}
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>#define TO_UPPER_STR(s, len) {\
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>    for (int i = 0; i &lt; len &amp;&amp; s[i] != &#39;\0&#39;; i++) { \
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>        s[i] = TO_UPPER(s[i]); \
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>    } \
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>}
</span></span></span></code></pre></div><hr width=100% id=EOF><p style=color:#777>Last modified on 2022-08-16</p></div></div><nav class=post-pagination><a class=newer-posts href=/posts/shell-script/>Next<br>Useful Shell Script Examples</a>
<a class=older-posts href=/posts/os-learning/stack-and-heap/>Previous<br>Stack and Heap</a></nav><div class=post-comment-wrapper><div id=gitalk-container></div></div></div></div></div></div><div id=single-column-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
@2019 Notepadium.</div></div><script src=/js/journal.js></script></body></html>