<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://gcore.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><title>Vim-YouCompleteMeæ’ä»¶å›½å†…å®‰è£…</title></head><body><div id=app><div id=sideContainer class=side-container><div class=nav-link-list><div class="a-block nav-link-item" href>BACK</div><div class="a-block nav-link-item"><a href=/posts>æœ€è¿‘ä¿®æ”¹</a></div><div class="a-block nav-link-item"><a href=/categories>åˆ†ç±» Categories</a></div><div class="a-block nav-link-item"><a href=/tags>æ ‡ç­¾ Tags</a></div><div class="a-block nav-link-item"><a href=/index.xml>RSS Feed</a></div></div></div><div id=extraContainer class=extra-container><div class="a-block nav-link-item" href><div id=fastSearch><input id=searchInput placeholder="Press '/' to focus on me"><ul id=searchResults></ul></div></div><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#vim%e6%8f%92%e4%bb%b6youcompleteme%e5%9b%bd%e5%86%85%e5%ae%89%e8%a3%85 aria-label=Vimæ’ä»¶YouCompleteMeå›½å†…å®‰è£…>Vimæ’ä»¶YouCompleteMeå›½å†…å®‰è£…</a><ul><li><a href=#%e4%b8%8b%e8%bd%bd aria-label=ä¸‹è½½>ä¸‹è½½</a></li><li><a href=#%e7%bc%96%e8%af%91 aria-label=ç¼–è¯‘>ç¼–è¯‘</a></li><li><a href=#%e9%85%8d%e7%bd%ae aria-label=é…ç½®>é…ç½®</a></li><li><a href=#%e4%bd%bf%e7%94%a8%e6%96%b9%e5%bc%8f aria-label=ä½¿ç”¨æ–¹å¼>ä½¿ç”¨æ–¹å¼</a></li></ul></li></ul></div></details></div></div></div><script src=/js/fuse.js></script>
<script src=/js/fastsearch.js></script><main class=container><article><header><div class=post-title>Vim-YouCompleteMeæ’ä»¶å›½å†…å®‰è£…</div></header><h1 id=vimæ’ä»¶youcompletemeå›½å†…å®‰è£…>Vimæ’ä»¶YouCompleteMeå›½å†…å®‰è£…</h1><blockquote><p>Update 2023/11/23: vimä¸‹ç°åœ¨æˆ‘ä¸ç”¨YCMäº†ï¼Œæ¢æˆCoc.nvimæ¥è¿›è¡Œä»£ç è¡¥å…¨ã€‚
ä¸è¿‡åœ¨æˆ‘çœ‹æ¥å…¶å®æ²¡æœ‰ç‰¹åˆ«æ˜æ˜¾çš„ä¼˜åŠ¿ï¼Œæ‰€ä»¥YCMçš„é…ç½®æ³¨æ„äº‹é¡¹è¿˜æ˜¯ç•™åœ¨è¿™å§ã€‚</p></blockquote><p>YCM æ’ä»¶å¯¹ python, vim çš„ç‰ˆæœ¬å‡æœ‰è¦æ±‚ã€‚</p><h2 id=ä¸‹è½½>ä¸‹è½½</h2><p>å¯ä»¥ä½¿ç”¨ vim-plug ç­‰å·¥å…·ä¸‹è½½, ä¹Ÿå¯ä»¥ä¸‹è½½æºç ç„¶åæ‹·è´åˆ°<code>.vim</code>ç›®å½•ä¸‹</p><h2 id=ç¼–è¯‘>ç¼–è¯‘</h2><p>ç¼–è¯‘ç”¨åˆ° python3, è¿™é‡Œæ˜¯é—®é¢˜æœ€å¤šçš„ä¸€æ­¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#6272a4># ç¼–è¯‘å¹¶æ·»åŠ å¯¹Cçš„æç¤ºæ”¯æŒ</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>python3 install.py --clangd-completer --verbose
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>Searching Python 3.8 libraries...
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>...
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>Downloading Clangd from https://github.com/ycm-core/llvm/releases/download/13.0.0/clangd-13.0.0-x86_64-unknown-linux-gnu.tar.bz2...
</span></span></code></pre></div><p>ä½¿ç”¨<code>--clangd-completer</code>å‚æ•°æ—¶, è„šæœ¬ä¼šå»ä¸‹è½½ clangd-14.0.0-x86_64-unknown-linux-gnu.tar.bz2 æ–‡ä»¶, æ¯”è¾ƒæ…¢. ä¹Ÿå¯ä»¥<strong>æå‰æ ¹æ®æç¤ºçš„ç½‘ç«™è‡ªå·±æ‰‹åŠ¨ä¸‹è½½</strong>å‹ç¼©åŒ….</p><p>ä¸‹è½½å®Œæˆå, æ”¾åˆ°æœ¬åœ°ç›®å½•ä¸‹:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>:~/.vim/plugged/YouCompleteMe/third_party/ycmd/third_party/clangd/cache$ ls
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>clangd-14.0.0-x86_64-unknown-linux-gnu.tar.bz2
</span></span></code></pre></div><p>è¿˜éœ€å¯¹è„šæœ¬<code>YouCompleteMe/third_party/ycmd/build.py</code>è¿›è¡Œä¿®æ”¹, é˜²æ­¢é‡æ–°ä¸‹è½½.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>DownloadClangd</span>( printer ):
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>  <span style=color:#ff79c6>...</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>  MakeCleanDirectory( CLANGD_OUTPUT_DIR )
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>not</span> p<span style=color:#ff79c6>.</span>exists( CLANGD_CACHE_DIR ):
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    os<span style=color:#ff79c6>.</span>makedirs( CLANGD_CACHE_DIR )
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    <span style=color:#6272a4># æ³¨é‡Šä¸‹é¢çš„è¯­å¥</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    <span style=color:#6272a4>#  elif p.exists( file_name ) and not CheckFileIntegrity( file_name, check_sum ):</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>    <span style=color:#6272a4>#  printer( &#39;Cached Clangd archive does not match checksum. Removing...&#39; )</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    <span style=color:#6272a4>#  os.remove( file_name )</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  <span style=color:#ff79c6>if</span> p<span style=color:#ff79c6>.</span>exists( file_name ):
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    printer( <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#39;Using cached Clangd: </span><span style=color:#f1fa8c>{</span> file_name <span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#39;</span> )
</span></span></code></pre></div><h2 id=é…ç½®>é…ç½®</h2><p>YCM é…åˆä¸€ä¸ªé…ç½®æ–‡ä»¶<code>.ycm_c_c++_conf.py</code>, YCM æœç´¢çš„ä½ç½®åœ¨ vimrc ä¸­æŒ‡å®š:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vimrc data-lang=vimrc><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>Plug <span style=color:#f1fa8c>&#39;rdnetto/YCM-Generator&#39;</span>, { <span style=color:#f1fa8c>&#39;branch&#39;</span>: <span style=color:#f1fa8c>&#39;stable&#39;</span> }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#ff79c6>let</span> g:ycm_global_ycm_extra_conf = <span style=color:#f1fa8c>&#34;~/.ycm_c_c++_conf.py&#34;</span>
</span></span></code></pre></div><p>å…¶å†…å®¹çš„ example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff79c6>import</span> os
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff79c6>import</span> ycm_core
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>flags <span style=color:#ff79c6>=</span> [
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  <span style=color:#f1fa8c>&#39;-Wall&#39;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  <span style=color:#f1fa8c>&#39;-Wextra&#39;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#6272a4>#  &#39;-Werror&#39;,</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  <span style=color:#f1fa8c>&#39;-Wno-long-long&#39;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#6272a4>#  &#39;-Wno-variadic-macros&#39;,</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  <span style=color:#f1fa8c>&#39;-fexceptions&#39;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  <span style=color:#f1fa8c>&#39;-ferror-limit=10000&#39;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  <span style=color:#f1fa8c>&#39;-DNDEBUG&#39;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  <span style=color:#f1fa8c>&#39;-std=c99&#39;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  <span style=color:#f1fa8c>&#39;-xc&#39;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>  <span style=color:#f1fa8c>&#39;-isystem/usr/include/&#39;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>  ]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>SOURCE_EXTENSIONS <span style=color:#ff79c6>=</span> [ <span style=color:#f1fa8c>&#39;.cpp&#39;</span>, <span style=color:#f1fa8c>&#39;.cxx&#39;</span>, <span style=color:#f1fa8c>&#39;.cc&#39;</span>, <span style=color:#f1fa8c>&#39;.c&#39;</span>, ]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>FlagsForFile</span>( filename, <span style=color:#ff79c6>**</span>kwargs ):
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>  <span style=color:#ff79c6>return</span> {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>  <span style=color:#f1fa8c>&#39;flags&#39;</span>: flags,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>  <span style=color:#f1fa8c>&#39;do_cache&#39;</span>: <span style=color:#ff79c6>True</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>  }
</span></span></code></pre></div><h2 id=ä½¿ç”¨æ–¹å¼>ä½¿ç”¨æ–¹å¼</h2><p>ğŸ”» å¯¹äºC/C++æ¥è¯´, YCMçš„ä½¿ç”¨æœ€å¥½é…åˆ<em>compilation database</em> æ¥ä½¿ç”¨, ä¾‹å¦‚<a href=https://github.com/nickdiego/compiledb>compiledb</a>. å¦åˆ™, å¯èƒ½å¤´æ–‡ä»¶çš„pathè¯†åˆ«å‡ºé—®é¢˜(<a href=https://stackoverflow.com/questions/64277317/youcompleteme-not-work-properly-for-c-headers.>stackoverflow</a>).</p><p>2022å¹´2æœˆ13æ—¥æˆ‘ä½¿ç”¨çš„compilation databaseç”Ÿæˆå·¥å…·ä»<code>compiledb</code>æ¢æˆäº†<code>bear</code>, å› ä¸º<code>bear</code>æ›´å¥½çš„æ”¯æŒé€’å½’, å³æœ‰<code>make -C</code>çš„æƒ…å†µ.</p><p>éœ€è¦çš„compilation databaseç”Ÿæˆå·¥å…·ä»‹ç»: <a href=https://sarcasm.github.io/notes/dev/compilation-database.html>Compilation database â€” Sarcasm notebook</a></p></article></body><hr width=100% id=EOF><p style=color:#777>åˆ›å»ºäº: 2023-11-17T19:28:12, Lastmod: 2023-11-30T17:56:18</p></main></div></body></html>