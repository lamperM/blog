<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://gcore.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><title>Hugo 主题创建(0): 脚手架</title></head><body><div id=app><div id=sideContainer class=side-container><div class=nav-link-list><div class="a-block nav-link-item" href>BACK</div><div class="a-block nav-link-item"><a href=/posts>所有文章</a></div><div class="a-block nav-link-item"><a href=/tags>Tags</a></div><div class="a-block nav-link-item"><a href=/index.xml>RSS Feed</a></div><div class="a-block nav-link-item" href><div id=fastSearch><input id=searchInput><ul id=searchResults></ul></div></div><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e8%83%8c%e6%99%af%e4%ba%a4%e4%bb%a3 aria-label=背景交代>背景交代</a></li><li><a href=#%e8%ae%a1%e5%88%92 aria-label=计划>计划</a></li><li><a href=#%e5%bc%80%e5%a7%8b%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e8%84%9a%e6%89%8b%e6%9e%b6 aria-label=开始动手：搭建脚手架>开始动手：搭建脚手架</a></li><li><a href=#%e7%9b%ae%e5%bd%95%e7%bb%93%e6%9e%84 aria-label=目录结构>目录结构</a></li><li><a href=#%e5%8f%82%e8%80%83 aria-label=参考>参考</a></li></ul></div></details></div></div></div></div><script src=/js/fuse.js></script>
<script src=/js/fastsearch.js></script><main class=container><article><header><div class=post-title>Hugo 主题创建(0): 脚手架</div></header><blockquote><p>commit: <a href=https://github.com/wangloo/hugo-theme-puer/commit/c014d1fae09eea1fcc44e03c69b6dd4d185f91fd>https://github.com/wangloo/hugo-theme-puer/commit/c014d1fae09eea1fcc44e03c69b6dd4d185f91fd</a></p></blockquote><h1 id=背景交代>背景交代</h1><p>到现在为止我使用hugo也一年多了, 记了几十条的博客，对于使用频率如此高的工具来说，
有一个顺眼的外观、方便的功能布局简直是梦寐以求。</p><p>然而，试过了这么多的现有主题，始终没有一个让我觉得满意，可能我的要求过于苛刻：</p><ol><li>搜索；我经常需要翻阅之前的博客/笔记，期望可以检索Tag，且不需要二次点击（
上方直接是一个搜索框而不是一个按钮）。</li><li>TOC；要求可是展开显示三级的目录，且布局好看些。</li><li>外观；简洁，不花里胡哨，代码高亮看起来舒服。</li><li>xxx</li></ol><p>所以，既然Hugo是一个开源的、社区环境较好的工具，那么为什么不尝试打造一款属于自己主题呢。</p><p>我是一名嵌入式开发工程师，对于前端的知识生疏，希望在良好的社区环境下能帮助我早日完成满足我个人需求的主题。</p><h1 id=计划>计划</h1><ol><li>搭建框架</li><li>制作模板，熟悉模板的概念，各个模板负责的区域</li><li>在上面的了解过程中逐渐加入对布局的调整，这一块可能需要学习css的知识</li><li>观摩学习前人的代码，结合百家之长，磨合出适合自己的布局和功能</li></ol><h1 id=开始动手搭建脚手架>开始动手：搭建脚手架</h1><p>创建的过程可以参考这个<a href=https://blog.gimo.me/posts/creating-a-hugo-theme/>博客</a>
, 我主要想按照我的理解对整个框架进行详细的介绍。</p><h1 id=目录结构>目录结构</h1><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>.
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>├── layouts
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>│   ├── 404.html
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>│   ├── _default   &lt;--- 此次重点研究
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>│   │   ├── baseof.html 
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>│   │   ├── section.html
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>│   │   ├── single.html
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>│   │   └── list.html
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>│   ├── index.html  &lt;--- 此次重点研究
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>│   └── partials 
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>│       ├── footer.html
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>│       ├── header.html
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>│       ├── head.html
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>│       └── script.html
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>├── LICENSE
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>├── static      &lt;--- 目前是空的, 后续再研究
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>│   ├── css
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>│   └── js
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>└── theme.toml  &lt;--- 干什么用的不清楚,后续研究
</span></span></code></pre></div><p>此次重点探讨<code>index.html</code>和<code>_default</code>目录下的文件.</p><p>index.html 是整个网站的首页, 打开你的站点最先看到的就是它的内容.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>{{ define &#34;title&#34; }}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>    首页
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>{{ end }}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>{{ define &#34;main&#34; }}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>    &lt;p&gt; 这里是个人站的首页, 仅展示用, 请DIY自己的首页覆盖它 :] &lt;/p&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>{{ end }}
</span></span></code></pre></div><p>你可能看不懂这段代码, 这不是正常的html, 但马上你就能明白了.</p><p><code>_dafult</code>下的文件被hugo称之为<strong>模板</strong>, 顾名思义他们的存在是为了减少代码的重复度.
不同名称的模板代表了hugo将页面划分为不同的类, 这个在官方文档中应该有介绍,
后续可以插入个链接(TODO).</p><ul><li>single.html: 普通页面的模板, 我们写的博客中的内容页面就算是single page</li><li>list.html: 列表页面的模板, 好几个博客分布在同一个子目录下, 访问这个目录的
地址就是 list page</li><li>section.html: <code>content/</code>是hugo工程放置内容的目录, 其下需要建立子目录,
比如<code>posts/</code>代表这是一些博客</li></ul><p>baseof.html需要着重介绍, 它相当于<strong>模板的模板</strong>, 目的是为了消除模板代码中的重复,
其中使用hugo提供的<code>block</code>语法, 建立基础模板, 目前我们baseof.html的内容如下:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#00f>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>&lt;html&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>&lt;head&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    {{- partial &#34;head.html&#34; . -}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    &lt;title&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>        {{ block &#34;title&#34; . }}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>        {{ .Site.Title }}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>        {{ end }}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    &lt;/title&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>&lt;/head&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>&lt;body&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    {{- partial &#34;header.html&#34; . -}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>    &lt;main class=<span style=color:#a31515>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>        {{- block &#34;main&#34; . }} 
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>        {{- end }}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>    &lt;/main&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>    {{- partial &#34;footer.html&#34; . -}} 
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>    {{- partial &#34;script.html&#34; . -}}
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>&lt;/body&gt;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>&lt;/html&gt;
</span></span></code></pre></div><p>这还稍微像一点html, 能看出是一个html的框架, 其中用<code>block</code>声明了<code>title</code>和<code>main</code>变量.</p><p>其他的模板文件中(包括<code>index.html</code>), 只要实现这两个变量, 就相当于把整段的代码都拷过来,
并且将<code>{{ block "xx" }}</code> 和 <code>{{ end }}</code> 之间的内容替换为你define的内容.</p><p>在<code>baseof.html</code>中对<code>{{ block "xx" }}</code> 和 <code>{{ end }}</code> 之间提前填充就实现了,
对网页的title设置了一个默认值, 如果重定义了, 那么覆盖原先的默认值.
看<code>index.html</code>就能明白, 它将网站的title替换成了"首页", 内容也改变了, 其他的都是相当于和
<code>baseof.html</code>相同.</p><blockquote><p>这里不介绍hugo的更多详细语法使用, 官方文档中都有</p></blockquote><blockquote><p>这里先不介绍优先级的概念, 假设这些模板文件在全局中只有一个</p></blockquote><h1 id=参考>参考</h1><ul><li><a href=https://gohugo.io/templates/base/>https://gohugo.io/templates/base/</a></li></ul></article></body><hr width=100% id=EOF><p style=color:#777>创建于: 2023-08-10T17:39:42, Lastmod: 2023-09-02T15:27:14</p></main></div></body></html>