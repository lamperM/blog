<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://gcore.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><title>Linux SLAB 内存分配器(3): SLUB/SLOB</title></head><body><div id=app><div id=sideContainer class=side-container><div class=nav-link-list><div class="a-block nav-link-item" href>BACK</div><div class="a-block nav-link-item"><a href=/posts>所有文章</a></div><div class="a-block nav-link-item"><a href=/tags>Tags</a></div><div class="a-block nav-link-item"><a href=/index.xml>RSS Feed</a></div></div></div><div id=extraContainer class=extra-container><div class="a-block nav-link-item" href><div id=fastSearch><input id=searchInput placeholder="Press '/' to focus on me"><ul id=searchResults></ul></div></div><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#slub aria-label=SLUB>SLUB</a></li><li><a href=#slob aria-label=SLOB>SLOB</a></li></ul></div></details></div></div></div><script src=/js/fuse.js></script>
<script src=/js/fastsearch.js></script><main class=container><article><header><div class=post-title>Linux SLAB 内存分配器(3): SLUB/SLOB</div></header><p>slub 和 slob 是基于 slab 思想针对某些场景下的优化实现。</p><h3 id=slub>SLUB</h3><ol><li>当 slab 分配器面对过多的申请需求时，cache 中就会有多个 slab (struct slab),
在以前的 slab 分配器设计中， slab 描述符是放在物理页中的，即物理页的结构为：
（slab 描述符+freelist+对象 s）,管理数据结构的开销就比较大。后期 SLUB 首先将
slab 描述符与<code>struct page</code>共用（通过 union 实现）。后面该思想被 SLAB 采纳。</li><li>SLAB 中每个 cache node 有三个 list: free, partial, full， 管理起来很麻烦，
SLUB 中只有一个 partial 链表。</li><li>放弃着色，效果不明显</li></ol><h3 id=slob>SLOB</h3><p>SLOB 的设计更加简洁，只有 600 行左右代码（SLAB，SLUB 都是 4000+），适合小内存的嵌入式设备。</p><p>SLOB 中没有对象的概念，每个 slab 中分配的小块内存<strong>大小可以是不同的</strong>，
通过长度+偏移来记录下一个小块内存的位置。</p><p>另外，SLOB 基本上放弃了 cache 的思想，系统中通过创建三个全局的链表:
small, medium, large, 分别应对&lt;256b, &lt;1k, &lt;PAGESIZE 的请求，
slab 直接挂在这三个链表上，因为 slab 中的内存分配大小可以不同，
用三个链表可以加速查找。</p><blockquote><p>从思想上，SLOB 仅仅保留 slab 中分配小块内存的思想，舍弃了 cache
的设计方案，所以实现上非常简单。</p></blockquote></article></body><hr width=100% id=EOF><p style=color:#777>创建于: 2023-05-26T18:51:49, Lastmod: 2023-09-24T18:08:59</p></main></div></body></html>