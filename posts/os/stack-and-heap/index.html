<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://gcore.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><title>Stack and Heap</title></head><body><div id=app><div id=sideContainer class=side-container><div class=nav-link-list><div class="a-block nav-link-item" href>BACK</div><div class="a-block nav-link-item"><a href=/posts>最近修改</a></div><div class="a-block nav-link-item"><a href=/categories>分类 Categories</a></div><div class="a-block nav-link-item"><a href=/tags>标签 Tags</a></div><div class="a-block nav-link-item"><a href=/index.xml>RSS Feed</a></div></div></div><div id=extraContainer class=extra-container><div class="a-block nav-link-item" href><div id=fastSearch><input id=searchInput placeholder="Press '/' to focus on me"><ul id=searchResults></ul></div></div><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%a0%86%e7%9a%84%e5%90%ab%e4%b9%89 aria-label=堆的含义>堆的含义</a></li><li><a href=#%e5%a0%86%e7%a9%ba%e9%97%b4%e7%9a%84%e7%ae%a1%e7%90%86 aria-label=堆空间的管理>堆空间的管理</a></li></ul></div></details></div></div></div><script src=/js/fuse.js></script>
<script src=/js/fastsearch.js></script><main class=container><article><header><div class=post-title>Stack and Heap</div></header><p> </p><h2 id=堆的含义>堆的含义</h2><p>我们都知道<code>malloc</code>动态申请的变量是存放在堆中. 所以相比栈来说, 堆是动态的.</p><p>堆占据进程虚拟地址空间的大部分, 我们可能通过堆来申请<code>1GB</code>的数组, 但是栈通常不行
, 大多也就几兆的空间.</p><p> </p><h2 id=堆空间的管理>堆空间的管理</h2><p>进程中堆空间的管理是<code>运行库</code>负责的, 在Linux中是<code>GLIBC</code>.</p><p>运行库在初始化时会像操作系统申请一大块的堆空间, 再为每个进行分别分配需求. 当然,
如果某些程序的需求过大, 运行库也可以使用<code>mmap</code>系统调用直接向操作系统申请, 然后
返回给用户进程.</p><blockquote><p>GLIBC的<code>malloc</code>函数的处理方式是: 对于小于<code>128KB</code>的申请, 会从运行库"批发的"堆空间
里分出一块来; 但若申请的空间过大, 则使用<code>mmap</code>系统调用来创建匿名空间分配给用户.</p></blockquote><blockquote><p>Linux中虚拟地址块(VMA)的管理使用了红黑树, 可以用于运行库管理自己向操作系统
&ldquo;批发"的堆空间. 使得用户程序动态申请和释放内存性能提高.</p></blockquote></article></body><hr width=100% id=EOF><p style=color:#777>创建于: 2022-06-28T16:41:54, Lastmod: 2023-09-24T18:08:59</p></main></div></body></html>