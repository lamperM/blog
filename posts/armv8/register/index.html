<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://gcore.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><title>AArch64 å¯„å­˜å™¨</title></head><body><div id=app><div id=sideContainer class=side-container><div class=nav-link-list><div class="a-block nav-link-item" href>BACK</div><div class="a-block nav-link-item"><a href=/posts>æœ€è¿‘ä¿®æ”¹</a></div><div class="a-block nav-link-item"><a href=/categories>åˆ†ç±» Categories</a></div><div class="a-block nav-link-item"><a href=/tags>æ ‡ç­¾ Tags</a></div><div class="a-block nav-link-item"><a href=/index.xml>RSS Feed</a></div></div></div><div id=extraContainer class=extra-container><div class="a-block nav-link-item" href><div id=fastSearch><input id=searchInput placeholder="Press '/' to focus on me"><ul id=searchResults></ul></div></div><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%af%84%e5%ad%98%e5%99%a8%e5%88%86%e7%b1%bb aria-label=å¯„å­˜å™¨åˆ†ç±»>å¯„å­˜å™¨åˆ†ç±»</a><ul><li><a href=#%e9%80%9a%e7%94%a8%e5%af%84%e5%ad%98%e5%99%a8 aria-label=é€šç”¨å¯„å­˜å™¨>é€šç”¨å¯„å­˜å™¨</a></li><li><a href=#%e6%af%8f%e4%b8%aael%e7%9a%84%e7%89%b9%e6%ae%8a%e5%af%84%e5%ad%98%e5%99%a8 aria-label=æ¯ä¸ªELçš„ç‰¹æ®Šå¯„å­˜å™¨>æ¯ä¸ªELçš„ç‰¹æ®Šå¯„å­˜å™¨</a></li></ul></li></ul></div></details></div></div></div><script src=/js/fuse.js></script>
<script src=/js/fastsearch.js></script><main class=container><article><header><div class=post-title>AArch64 å¯„å­˜å™¨</div></header><h1 id=å¯„å­˜å™¨åˆ†ç±»>å¯„å­˜å™¨åˆ†ç±»</h1><h2 id=é€šç”¨å¯„å­˜å™¨>é€šç”¨å¯„å­˜å™¨</h2><ol><li><code>x0-x7</code> å‚æ•°å¯„å­˜å™¨: Restore function parameters and return vaule.</li><li><code>x9-x15</code> caller-saved ä¸´æ—¶å¯„å­˜å™¨: callee é»˜è®¤å¯ä»¥ç›´æ¥ä½¿ç”¨æ¥ä¿å­˜ä¸´æ—¶å˜é‡, ä¸éœ€è¦ä¿å­˜å’Œæ¢å¤. å¦‚æœ caller åœ¨é‡Œé¢å­˜å‚¨äº†éä¸´æ—¶ä¿¡æ¯, é‚£ä¹ˆåœ¨å‡½æ•°è°ƒç”¨ä¹‹å‰åº”å½“ç”± caller è´Ÿè´£ä¿å­˜.</li><li><code>x19-x28</code> callee-saved å¯„å­˜å™¨: callee åº”è¯¥é¿å…ä½¿ç”¨. å¦‚æœå¿…é¡»è¦ä½¿ç”¨ï¼Œé‚£ä¹ˆåœ¨è¿”å›å‰å¿…é¡»æ¢å¤.</li><li>special registers:<ul><li><code>x8</code> restore indirect result. Commonly used when returning a struct.</li><li><code>x18</code> platform reserved register.</li><li><code>x29</code> frame pointer register(FP).</li><li><code>x30</code> link register(LR).</li></ul></li></ol><blockquote><p>All general-purpose register <code>xN</code> is 64-bit width. They all have corresponding <code>wN</code> register using the lower 32-bit of <code>xN</code>. And write to <code>wN</code> will clear the upper 32bit of <code>xN</code>.</p></blockquote><blockquote><p>ğŸ’« The different between <strong>Caller-saved</strong> and <strong>callee-saved</strong> registers</p><ul><li>Caller-saved å¯„å­˜å™¨åˆç§°ä¸º<em>ä¸´æ—¶å¯„å­˜å™¨</em>, å¸¸ç”¨æ¥å­˜æ”¾ä¸´æ—¶å˜é‡. ä¾‹å¦‚A() è°ƒç”¨ B(), é‚£ä¹ˆ B() å¯ä»¥ç›´æ¥ä½¿ç”¨ caller-saved å¯„å­˜å™¨, ä¹Ÿå°±æ˜¯è¯´ A() åœ¨è°ƒç”¨ B() ä¹‹å‰ä¸ä¼šåœ¨è¿™äº›å¯„å­˜å™¨é‡Œä¿å­˜é‡è¦ä¿¡æ¯(ç¼–è¯‘å™¨å®ç°), ä¸èƒ½ä¿è¯è°ƒç”¨ B() å‰åå…¶å€¼ä¸å˜. å¦‚æœå¿…é¡»è¦ä¿è¯, é‚£ä¹ˆä¿å­˜å’Œæ¢å¤(åˆ©ç”¨æ ˆ)è¿™ä»¶äº‹æ˜¯ A() æ¥åš.</li><li>Callee-saved å¯„å­˜å™¨åˆ™ç›¸å, é€šå¸¸æŒç»­ä½¿ç”¨çš„å€¼ä¼šä¿å­˜åˆ°è¿™äº›å¯„å­˜å™¨ä¸­. è¿˜æ˜¯æ‹¿ A() call B() æ¥ä¸¾ä¾‹. å¦‚æœ A() ä¸­çš„ä¸€ä¸ªå˜é‡éœ€è¦åœ¨è°ƒç”¨ B() å‰åæŒç»­æœ‰æ•ˆ, é‚£ä¹ˆå®ƒåº”å½“ä¿å­˜åˆ° callee-saved å¯„å­˜å™¨ä¸­. è€Œä¸” B() æ­£å¸¸æ¥è¯´ä¸åº”è¯¥åŠ¨è¿™äº›å¯„å­˜å™¨, å¦‚æœéå¾—åŠ¨(ä¾‹å¦‚å¯„å­˜å™¨ä¸å¤Ÿç”¨), é‚£ä¹ˆ B() éœ€è¦åœ¨ä½¿ç”¨ä»–ä»¬çš„å‰åè¿›è¡Œä¿å­˜å’Œæ¢å¤(åˆ©ç”¨æ ˆ).</li></ul></blockquote><h2 id=æ¯ä¸ªelçš„ç‰¹æ®Šå¯„å­˜å™¨>æ¯ä¸ªELçš„ç‰¹æ®Šå¯„å­˜å™¨</h2><ol><li><code>sp_el0/1/2/3</code> stack pointer register of each EL.</li><li><code>elr_el1/2/3</code> exception link register of each EL except EL0.</li><li><code>spsr_el1/2/3</code> save program status register of each EL except EL0.</li></ol><blockquote><p><code>sp</code> is an alias of <code>sp_el0</code>. Do NOT treat <code>sp</code> as general-purpose register.</p></blockquote></article></body><hr width=100% id=EOF><p style=color:#777>åˆ›å»ºäº: 2022-05-07T20:19:44, Lastmod: 2023-09-24T18:08:59</p></main></div></body></html>