<?xml-stylesheet href="/rss.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Homepage ğŸŒˆ on Wangloo's BLOG</title><link>https://wangloo.github.io/</link><description>Recent content in Homepage ğŸŒˆ on Wangloo's BLOG</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>@2019 Notepadium.</copyright><lastBuildDate>Thu, 15 Sep 2022 15:14:05 +0800</lastBuildDate><atom:link href="https://wangloo.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>GNU äºŒè¿›åˆ¶å·¥å…·é›†</title><link>https://wangloo.github.io/posts/os/gnu_tools/</link><pubDate>Sat, 03 Dec 2022 19:08:22 +0800</pubDate><guid>https://wangloo.github.io/posts/os/gnu_tools/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/os/gnu_tools/ -&lt;p>..&lt;/p>
&lt;h2 id="nm---åˆ—å‡ºç¬¦å·">nm - åˆ—å‡ºç¬¦å·&lt;/h2>
&lt;p>&lt;a href="https://sourceware.org/binutils/docs/binutils/nm.html">nm (GNU Binary Utilities) (sourceware.org)&lt;/a>&lt;/p>
- https://wangloo.github.io/posts/os/gnu_tools/ - @2019 Notepadium.</description></item><item><title>Makefile ä¸€äº›æŠ€å·§</title><link>https://wangloo.github.io/posts/c/makefile_tricks/</link><pubDate>Sat, 03 Dec 2022 19:08:22 +0800</pubDate><guid>https://wangloo.github.io/posts/c/makefile_tricks/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/c/makefile_tricks/ -&lt;h2 id="ä¼ªç›®æ ‡çš„ä¾èµ–å…³ç³»">ä¼ªç›®æ ‡çš„ä¾èµ–å…³ç³»&lt;/h2>
&lt;p>Makefile ä¸­çš„ä¾èµ–å…³ç³»æŒ‡çš„æ˜¯ç›®æ ‡å’Œä¾èµ–ä¹‹é—´å»ºç«‹çš„å…³ç³»ï¼Œç›®æ ‡å¯¹åº”è§„åˆ™ä¸­çš„è¯­å¥æ˜¯å¦æ‰§è¡Œå–å†³äºä¾èµ–çš„çŠ¶æ€ã€‚&lt;/p>
&lt;p>æœ€ç®€å•çš„ä¾èµ–å…³ç³»å¯ä»¥æ‹¿ä¸¤ä¸ªæ–‡ä»¶æ¥ä¸¾ä¾‹:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-makefile" data-lang="makefile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># gccè¯­å¥æ‰§è¡Œå½“å‰ä»…å½“ main.c æ–°äº main.elf
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#50fa7b">main.elf&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> main.c
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> gcc main.c -o main.elf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>make åœ¨æ‰§è¡Œ&lt;code>main.elf&lt;/code>çš„è§„åˆ™æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­ä¾èµ–å…³ç³»ã€‚æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œ
gcc è¯­å¥æ˜¯å¦æ‰§è¡Œå–å†³äº&lt;code>main.c&lt;/code> å’Œ &lt;code>main.elf&lt;/code>çš„ä¿®æ”¹æ—¶é—´ï¼Œ&lt;strong>åªæœ‰å½“
ä¾èµ–æ–°ä¸ç›®æ ‡æ—¶ï¼Œè§„åˆ™è¯­å¥æ‰ä¼šæ‰§è¡Œ&lt;/strong>ã€‚&lt;/p>
&lt;p>ç„¶è€Œè®¸å¤šæƒ…å†µä¸‹ï¼Œç›®æ ‡æˆ–è€…ä¾èµ–å¹¶ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œæ˜¯&lt;strong>è™šæ‹Ÿç›®æ ‡&lt;/strong>ã€‚è™šæ‹Ÿç›®æ ‡
å¹¶ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå³å®ƒæ²¡æœ‰ä¿®æ”¹æ—¶é—´è¿™ä¸ªå±æ€§ï¼Œæ­¤æ—¶ make å°±ä¸èƒ½ä½œæ¯”è¾ƒï¼Œç»“æœå°±æ˜¯
&lt;strong>å¦‚æœç›®æ ‡æ˜¯ä¼ªç›®æ ‡ï¼Œé‚£ä¹ˆä¸ç®¡ä¾èµ–å¦‚ä½•éƒ½æ‰§è¡Œè§„åˆ™è¯­å¥ï¼›å¦‚æœä¾èµ–æ˜¯ä¼ªç›®æ ‡ï¼Œ
é‚£ä¹ˆç›®æ ‡çš„è§„åˆ™è¯­å¥ä¹Ÿæ°¸è¿œè¢«æ‰§è¡Œ&lt;/strong>ã€‚ä¸‹é¢æ˜¯ä¸¤ä¸ªä¾‹å­ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-make" data-lang="make">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># ä¼ªç›®æ ‡ä½œä¸ºç›®æ ‡æ–‡ä»¶å‡ºç°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># build finishæ€»æ˜¯è¾“å‡ºï¼Œ è€Œgccè¯­å¥ä»…å½“main.cæ¯”main.elfæ–°æ—¶æ‰æ‰§è¡Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#50fa7b">.PHONY &lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> all
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">all&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> main.elf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @echo &lt;span style="color:#f1fa8c">&amp;#39;build finish&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">main.elf&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> main.c
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> gcc $&amp;lt; -o &lt;span style="color:#8be9fd;font-style:italic">$@&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-make" data-lang="make">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># ä¼ªç›®æ ‡ä½œä¸ºä¾èµ–æ–‡ä»¶ä¸­å‡ºç°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># ä¸ç®¡main.cæ˜¯å¦æ¯”main.elfæ›´æ–°ï¼Œå› ä¸ºpre-workæ˜¯ä¼ªç›®æ ‡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># æ‰€ä»¥gccè¯­å¥æ€»æ˜¯æ‰§è¡Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#50fa7b">.PHONY &lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> pre-work
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">main.elf&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> main.c pre-work
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> gcc $&amp;lt; -o &lt;span style="color:#8be9fd;font-style:italic">$@&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šé¢çš„ä»£ç çš„æ•ˆæœæ˜¯ï¼šä¸¤æ¡è§„åˆ™ä¸­çš„è¯­å¥éƒ½ä¼šæ‰§è¡Œï¼Œå³ä½¿ä½ å¹¶æ²¡æœ‰å¯¹ main.c åšä»»ä½•ä¿®æ”¹ï¼&lt;/p>
&lt;h2 id="ææ€–çš„ç©ºæ ¼">ææ€–çš„ç©ºæ ¼&lt;/h2>
&lt;p>Makefile ä¸­çš„å˜é‡ç»“åˆå¾ˆå¸¸è§ï¼Œä¾‹å¦‚&lt;code>$(FIXDEP)=$(FIXDEP_PATH)/build/fixdep&lt;/code>.&lt;/p>
&lt;p>ç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬è¿™äº›è¯­å¥æ˜¯ä»æŸäº›åœ°æ–¹ç²˜è´´è¿‡æ¥ï¼Œè¦ç‰¹åˆ«æ³¨æ„å˜é‡ä¸­æ˜¯å¦æœ‰ç©ºæ ¼ï¼ŒMakefile éå¸¸é‡è§†è¿™ä¸ªã€‚å‡å¦‚&lt;code>$(FIXDEP_PATH)&lt;/code>ä¸­æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œé‚£ä¹ˆ&lt;code>$(FIXDEP)&lt;/code>å°±å˜æˆ&lt;strong>ä¸¤ä¸ªå®&lt;/strong>äº†ï¼ˆä¸çŸ¥é“å«å®åˆä¸åˆé€‚ï¼‰ã€‚è€Œä¸” Make çš„æ‰§è¡Œè¿‡ç¨‹å¾ˆéš¾æ£€æŸ¥å‡ºæ¥ã€‚&lt;/p>
&lt;h2 id="è§„åˆ™çš„æ‰§è¡Œé¡ºåº">è§„åˆ™çš„æ‰§è¡Œé¡ºåº&lt;/h2>
&lt;p>å¦‚æœä¸ä»å‘½ä»¤è¡Œä¼ å…¥ç›®æ ‡, Makefile ä¸­å®šä¹‰çš„è§„åˆ™å…¶å®æ˜¯ä»¥&lt;strong>ä»ä¸Šè€Œä¸‹&lt;/strong>çš„é¡ºåºæ‰§è¡Œçš„, ä½†æ˜¯æˆ‘ä¹ æƒ¯æŠŠ &lt;code>all&lt;/code> è¿™ç§é»˜è®¤è§„åˆ™æ”¾åœ¨æœ€ä¸‹é¢, æ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¾ˆå¤š Makefile ä¼šåœ¨å¼€å¤´å†™ä¸€å¥è§„åˆ™&lt;code>all:&lt;/code>, ä½œç”¨å°±æ˜¯å‘Šè¯‰ make é»˜è®¤(ä¸æ˜¾å¼æŒ‡å®š)çš„ç›®æ ‡æ˜¯&lt;code>all&lt;/code>.&lt;/p>
&lt;blockquote>
&lt;p>Busybox æ ¹ç›®å½• Makefile ä¸­çš„åšæ³•ç¤ºä¾‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-makefile" data-lang="makefile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># That&amp;#39;s our default target when &amp;gt;none is given on the command line
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#50fa7b">.PHONY&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> _all
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">_all&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/blockquote>
&lt;h2 id="å‡½æ•°çš„é­”æ³•">å‡½æ•°çš„é­”æ³•&lt;/h2>
&lt;h3 id="patsubst">patsubst&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-make" data-lang="make">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">patsubst&lt;/span> &amp;lt;&lt;span style="color:#8be9fd;font-style:italic">pattern&lt;/span>&amp;gt;,&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">replacement&lt;/span>&amp;gt;,&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">text&lt;/span>&amp;gt;&lt;span style="color:#ff79c6">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åŠŸèƒ½ï¼šæŸ¥æ‰¾&lt;code>&amp;lt;text&amp;gt;&lt;/code>ä¸­çš„å•è¯ï¼ˆä»¥ç©ºæ ¼ï¼Œtabï¼Œå›è½¦ï¼Œæ¢è¡Œåˆ†å‰²ï¼‰ï¼Œçœ‹å…¶æ˜¯å¦ç¬¦åˆ&lt;code>&amp;lt;pattern&amp;gt;&lt;/code>,
å¦‚æœç¬¦åˆï¼Œå°†å…¶ä½¿ç”¨&lt;code>&amp;lt;replacement&amp;gt;&lt;/code>æ›¿æ¢ã€‚å¯ä»¥ä½¿ç”¨é€šé…ç¬¦&lt;code>%&lt;/code>ã€‚&lt;/p>
&lt;p>ä»¥ä¸‹ä¸¤å¯¹æ˜¯ç­‰æ•ˆçš„, æ˜æ˜¾è¿˜æ˜¯ç›´æ¥ä½¿ç”¨å˜é‡çš„æ›¿æ¢è¯­æ³•æ“ä½œç®€å•:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-make" data-lang="make">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">patsubst&lt;/span> &amp;lt;&lt;span style="color:#8be9fd;font-style:italic">pattern&lt;/span>&amp;gt;,&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">replacement&lt;/span>&amp;gt;,&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">var&lt;/span>&lt;span style="color:#ff79c6">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">$(var&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span>&amp;lt;pattern&amp;gt;=&amp;lt;replacement&amp;gt;;)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">patsubst&lt;/span> %&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">suffix&lt;/span>&amp;gt;,%&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">replacement&lt;/span>&amp;gt;,&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">var&lt;/span>&lt;span style="color:#ff79c6">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">$(var&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span>&amp;lt;suffix&amp;gt;=&amp;lt;replacement&amp;gt;)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ä½¿ç”¨-shell-å˜é‡">ä½¿ç”¨ shell å˜é‡&lt;/h2>
&lt;p>Make å°† &lt;code>$$var&lt;/code> è½¬ä¹‰ä¸º&lt;code>$var&lt;/code>, ä¾› shell å¤„ç†.&lt;/p>
&lt;p>demo(æºè‡ª 6.828 æ ¹ç›®å½•&lt;code>GNUmakefile&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-makefile" data-lang="makefile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">handin-check&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @if &lt;span style="color:#8be9fd;font-style:italic">test&lt;/span> -n &lt;span style="color:#f1fa8c">&amp;#34;`git status -s`&amp;#34;&lt;/span>; &lt;span style="color:#ff79c6">then&lt;/span> &lt;span style="color:#f1fa8c">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f1fa8c">&lt;/span> git status -s; &lt;span style="color:#f1fa8c">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f1fa8c">&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">read&lt;/span> -p &lt;span style="color:#f1fa8c">&amp;#34;Untracked files will not be handed in. Continue? [y/N] &amp;#34;&lt;/span> r; &lt;span style="color:#f1fa8c">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f1fa8c">&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">test&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">$$&lt;/span>&lt;span style="color:#f1fa8c">r&amp;#34;&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> y; &lt;span style="color:#f1fa8c">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f1fa8c">&lt;/span> &lt;span style="color:#ff79c6">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>ä»¥ä¸Š demo è¿˜ä½¿ç”¨äº† test å‘½ä»¤æ¥ç»ˆæ­¢ make çš„æ‰§è¡Œ, å¦‚æœç”¨æˆ·æ²¡æœ‰è¾“å…¥&lt;code>y&lt;/code>, make å°†ä¼šç»ˆæ­¢æ‰§è¡Œ&lt;/p>
&lt;/blockquote>
- https://wangloo.github.io/posts/c/makefile_tricks/ - @2019 Notepadium.</description></item><item><title>Uboot: å¸¸ç”¨å‘½ä»¤</title><link>https://wangloo.github.io/posts/os/uboot/commands/</link><pubDate>Sun, 27 Nov 2022 22:03:48 +0800</pubDate><guid>https://wangloo.github.io/posts/os/uboot/commands/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/os/uboot/commands/ -&lt;hr>
&lt;p>..&lt;/p>
&lt;h2 id="ç¯å¢ƒå˜é‡ç›¸å…³">ç¯å¢ƒå˜é‡ç›¸å…³&lt;/h2>
&lt;h2 id="å†…å­˜æ“ä½œ">å†…å­˜æ“ä½œ&lt;/h2>
&lt;h2 id="ç½‘ç»œæ“ä½œ">ç½‘ç»œæ“ä½œ&lt;/h2>
&lt;h2 id="emmcå’Œsdå¡">EMMCå’ŒSDå¡&lt;/h2>
&lt;h2 id="bootæ“ä½œæŒ‡ä»¤">BOOTæ“ä½œæŒ‡ä»¤&lt;/h2>
&lt;h3 id="bootm">bootm&lt;/h3>
&lt;h3 id="go">go&lt;/h3>
&lt;h2 id="å…¶ä»–å‘½ä»¤">å…¶ä»–å‘½ä»¤&lt;/h2>
&lt;p>å¯åŠ¨ç›¸å…³&lt;/p>
&lt;p>md&lt;/p>
&lt;p>mmcinfo&lt;/p>
&lt;p>cp&lt;/p>
- https://wangloo.github.io/posts/os/uboot/commands/ - @2019 Notepadium.</description></item><item><title>å¸¸ç”¨çš„ shell å‘½ä»¤</title><link>https://wangloo.github.io/posts/shell/shell-commands/</link><pubDate>Sun, 27 Nov 2022 14:45:58 +0800</pubDate><guid>https://wangloo.github.io/posts/shell/shell-commands/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/shell/shell-commands/ -&lt;blockquote>
&lt;p>æˆ‘ä½¿ç”¨çš„ shell æ˜¯ Bash&lt;/p>
&lt;/blockquote>
&lt;h3 id="mount-ç›¸å…³">mount ç›¸å…³&lt;/h3>
&lt;p>&lt;code>mount&lt;/code> è¾“å‡ºå½“å‰å·²ç»æŒ‚åœ¨çš„åˆ†åŒº&lt;/p>
&lt;h3 id="where-and-which">where and which&lt;/h3>
&lt;p>which æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>$ which python3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/usr/bin/python3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>whereis é™¤äº†å¯æ‰§è¡Œæ–‡ä»¶è¿˜èƒ½æœç´¢å…¶ä»–ç±»å‹çš„æ–‡ä»¶, ä¸å¸¸ç”¨, è¯¦è§ &lt;code>man whereis&lt;/code>&lt;/p>
&lt;h3 id="--çš„å¦™ç”¨">&lt;code>-&lt;/code> çš„å¦™ç”¨&lt;/h3>
&lt;p>ä¸€äº›å‘½ä»¤æ”¯æŒä½¿ç”¨ &lt;code>-&lt;/code> ä»£æ›¿æ–‡ä»¶å, è¾“å…¥è¾“å‡ºéƒ½å¯ä»¥:&lt;/p>
&lt;ul>
&lt;li>ä»£æ›¿æ ‡å‡†è¾“å‡º; ä¸€äº›å‘½ä»¤ä¼šå°†&lt;code>-o/-O&lt;/code> åé¢çš„&lt;code>-&lt;/code>åˆ¤å®šä¸ºè¾“å‡ºåˆ°&lt;em>STDOUT&lt;/em>, è¯¦è§ä¸‹é¢ç¤ºä¾‹.&lt;/li>
&lt;li>ä»£æ›¿æ ‡å‡†è¾“å…¥;&lt;/li>
&lt;/ul>
&lt;p>ä¸‹é¢ç»™å‡ºä¸¤ä¸ªåŒæ—¶ä»£æ›¿è¾“å…¥è¾“å‡ºçš„ä¾‹å­:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># å°†æ ‡å‡†è¾“å…¥(STDIN)çš„å†…å®¹ä½œä¸ºgccçš„è¾“å…¥, ç¼–è¯‘åçš„ç»“æœè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º(STDOUT)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd;font-style:italic">echo&lt;/span> &lt;span style="color:#f1fa8c">&amp;#39;void foo() {}&amp;#39;&lt;/span> | gcc -x c -o - -
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># å°†ä¸‹è½½çš„æ–‡ä»¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º, åŒæ—¶ä½œä¸ºtarå‘½ä»¤çš„è¾“å…¥æ–‡ä»¶, è¿›è¡Œè§£å‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wget -O - &lt;span style="color:#f1fa8c">&amp;#34;https://www.dropbox.com/download?plat=lnx.x86_64&amp;#34;&lt;/span> | tar xzf -
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>&lt;code>-&lt;/code> å¦‚ä½•è¢«è§£ææ˜¯&lt;strong>å–å†³äºå‘½ä»¤çš„å®ç°&lt;/strong>, éæ ‡å‡†. æ¯”å¦‚ &lt;code>cd -&lt;/code> å°±æœ‰ç‰¹æ®Šçš„å«ä¹‰&lt;/p>
&lt;/blockquote>
- https://wangloo.github.io/posts/shell/shell-commands/ - @2019 Notepadium.</description></item><item><title>Cè¯­è¨€ 'inline' å…³é”®å­—</title><link>https://wangloo.github.io/posts/c/inline/</link><pubDate>Thu, 24 Nov 2022 01:35:24 +0800</pubDate><guid>https://wangloo.github.io/posts/c/inline/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/c/inline/ -&lt;p>TODO: inline çš„å‘å±•å†ç¨‹: &lt;a href="https://gustedt.wordpress.com/2010/11/29/myth-and-reality-about-inline-in-c99/">Myth and reality about inline in C99 â€“ Jens Gustedt&amp;rsquo;s Blog (wordpress.com)&lt;/a>&lt;/p>
&lt;h2 id="gnu89">GNU89:&lt;/h2>
&lt;p>å‡½æ•°çš„&lt;strong>å®ç°&lt;/strong>ä¹‹å‰æ·»åŠ ä¸åŒçš„å…³é”®å­—:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>inline&lt;/code>: è¡¨æ˜è¿™ä¸ªå‡½æ•°å¯èƒ½è¢«ä¼˜åŒ–. å¦‚æœæ²¡æœ‰è¢«ä¼˜åŒ–, ç¼–è¯‘å™¨å°±ä¼šè§†ä¸ºä¸€ä¸ªå¸¸è§„å‡½æ•°çš„å®šä¹‰.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>extern inline&lt;/code>: è¡¨æ˜è¿™ä¸ªå‡½æ•°å¯èƒ½è¢«ä¼˜åŒ–. å¦‚æœæ²¡æœ‰è¢«ä¼˜åŒ–, ç¼–è¯‘å™¨å°±å°†è¿™ä¸ªå‡½æ•°çš„å®šä¹‰&lt;strong>è½¬æ¢ä¸ºè¯¥å‡½æ•°çš„å£°æ˜&lt;/strong>, å³ &lt;code>extern inline func();&lt;/code> å› æ­¤å½“æ­¤å‡½æ•°è¢«è°ƒç”¨æ—¶, å¯ä»¥è°ƒç”¨ä¸€ä¸ªå¤–éƒ¨çš„å‡½æ•°æ¥æ›¿ä»£. å¦‚æœæ²¡æœ‰å‡½æ•°è°ƒç”¨å®ƒ, é‚£ä¹ˆä¹Ÿå¯ä»¥æ²¡æœ‰å¤–éƒ¨çš„æ›¿ä»£å‡½æ•°å®ç°.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>static inline&lt;/code>: è¡¨æ˜è¿™ä¸ªå‡½æ•°å¯èƒ½è¢«ä¼˜åŒ–. å¦‚æœæ²¡æœ‰è¢«ä¼˜åŒ–, ç¼–è¯‘å™¨å°±ä¼šè§†ä¸ºä¸€ä¸ª&lt;strong>å¸¸è§„é™æ€å‡½æ•°&lt;/strong>.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="c99">C99:&lt;/h2>
&lt;p>å‡½æ•°çš„å®ç°ä¹‹å‰æ·»åŠ ä¸åŒçš„å…³é”®å­—:&lt;/p>
&lt;ul>
&lt;li>&lt;code>inline&lt;/code>: ç­‰æ•ˆäºgnu89ä¸­çš„&lt;code>extern inline&lt;/code>&lt;/li>
&lt;li>&lt;code>extern inline&lt;/code>: ç­‰æ•ˆäºgnu89ä¸­çš„&lt;code>inline&lt;/code>&lt;/li>
&lt;li>&lt;code>static inline&lt;/code>: ä¸gnu89ç›¸åŒå«ä¹‰.&lt;/li>
&lt;/ul>
&lt;h2 id="c">C++:&lt;/h2>
&lt;p>åªæœ‰&lt;code>inline&lt;/code>ä¸€ä¸ªå…³é”®å­—, å¦‚æœä¸èƒ½ä¼˜åŒ–å°±å®šä¹‰ä¸ºæ™®é€šå‡½æ•°&lt;/p>
&lt;blockquote>
&lt;p>Ref:&lt;/p>
&lt;p>&lt;a href="https://stackoverflow.com/questions/216510/what-does-extern-inline-do/216546#216546">c++ - What does extern inline do? - Stack Overflow&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://gustedt.wordpress.com/2010/11/29/myth-and-reality-about-inline-in-c99/">Myth and reality about inline in C99 â€“ Jens Gustedt&amp;rsquo;s Blog (wordpress.com)&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>&lt;a href="https://github.com/wangloo/inline-c99-gnu89-demo">C demo&lt;/a> å…³äºä»¥ä¸Šçš„å„ç§æƒ…å†µ&lt;/p>
&lt;/blockquote>
- https://wangloo.github.io/posts/c/inline/ - @2019 Notepadium.</description></item><item><title>Cè¯­è¨€å·¥å…·å®</title><link>https://wangloo.github.io/posts/c/c-macros/</link><pubDate>Thu, 24 Nov 2022 01:35:24 +0800</pubDate><guid>https://wangloo.github.io/posts/c/c-macros/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/c/c-macros/ -&lt;h3 id="è®¡ç®—æ•°ç»„å…ƒç´ çš„ä¸ªæ•°">è®¡ç®—æ•°ç»„å…ƒç´ çš„ä¸ªæ•°&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">#define nelem(array) sizeof(array)/sizeof(array[0])
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>- https://wangloo.github.io/posts/c/c-macros/ - @2019 Notepadium.</description></item><item><title>x86/ARMv8 å‡½æ•°è°ƒç”¨çº¦å®š</title><link>https://wangloo.github.io/posts/os/function-call-conventions/</link><pubDate>Mon, 21 Nov 2022 10:30:35 +0800</pubDate><guid>https://wangloo.github.io/posts/os/function-call-conventions/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/os/function-call-conventions/ -&lt;p>ç¬¦åˆè°ƒç”¨çº¦å®šä½¿å¾—è°ƒç”¨å‡½æ•°èƒ½å¤Ÿæ­£å¸¸è·å–å‚æ•°, calleeç»“æŸä¹‹åèƒ½å¤Ÿå›åˆ°åŸæ¥ä½ç½®ç»§ç»­æ‰§è¡Œ.&lt;/p>
&lt;h2 id="x86-è°ƒç”¨çº¦å®š">X86 è°ƒç”¨çº¦å®š&lt;/h2>
&lt;h3 id="å‡½æ•°è°ƒç”¨">å‡½æ•°è°ƒç”¨&lt;/h3>
&lt;p>x86æ¶æ„ä¸­, å‡½æ•°è°ƒç”¨ä»¥ä¸€æ¡&lt;code>call&lt;/code>æŒ‡ä»¤ä¸ºåˆ†ç•Œ.&lt;/p>
&lt;p>åœ¨&lt;code>call&lt;/code>æŒ‡ä»¤æ‰§è¡Œä¹‹å‰, æ‰€æœ‰çš„å‚æ•°å¿…é¡»éƒ½èººåœ¨æ ˆä¸­, å‚æ•°å…¥æ ˆçš„è§„åˆ™æ˜¯: &lt;strong>ç¬¬ä¸€ä¸ªå‚æ•°æœ€åå…¥æ ˆ&lt;/strong>.&lt;/p>
&lt;p>å¦å¤–, æ‰§è¡Œ&lt;code>call&lt;/code>æŒ‡ä»¤ä¹‹å‰, å¿…é¡»ç¡®ä¿æ ˆæŒ‡é’ˆ&lt;code>esp&lt;/code>æ˜¯16-byteå¯¹é½. è¿™é¡¹å·¥ä½œæ˜¯&lt;strong>ç¼–è¯‘å™¨&lt;/strong>å®Œæˆçš„, å¦‚æœå®ƒåˆ¤æ–­å‚æ•°å…¥æ ˆä¹‹åçš„&lt;code>esp&lt;/code> ä¸æ»¡è¶³å¯¹é½æ¡ä»¶, åˆ™ä¼šæ‰‹åŠ¨è°ƒæ•´&lt;code>esp&lt;/code>ä½¿ä¹‹å¯¹é½. å®ç°æ–¹å¼è§ä¸‹é¢ä¾‹å­.&lt;/p>
&lt;p>&lt;code>call&lt;/code> æŒ‡ä»¤çš„è¯­ä¹‰æ˜¯:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-asm" data-lang="asm">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">push&lt;/span> pc+&lt;span style="color:#bd93f9">1&lt;/span> &lt;span style="color:#6272a4">;push next insttuction
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>mov pc, func &lt;span style="color:#6272a4">;set pc = new function
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>call&lt;/code> æŒ‡ä»¤ä¹‹åçš„ä¸‹ä¸€æ¡æŒ‡ä»¤å°±æ˜¯calleeçš„å†…å®¹äº†, è‡³æ­¤å°±ç®—æ˜¯è¿›å…¥æ–°å‡½æ•°çš„åœ°ç›˜.&lt;/p>
&lt;p>ä½†æ˜¯åœ¨æ‰§è¡Œæ–°çš„ä»»åŠ¡ä¹‹å‰, calleeè¿˜éœ€è¦å®Œæˆ&lt;strong>æ ˆçš„è½¬æ¢&lt;/strong>, å› ä¸ºæ­¤æ—¶ä½¿ç”¨çš„æ ˆè¿˜æ˜¯callerçš„.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-asm" data-lang="asm">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">push&lt;/span> ebp &lt;span style="color:#6272a4">;preserve location of caller&amp;#39;s stack
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>mov ebp, esp &lt;span style="color:#6272a4">;new ebp is old esp
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>æ­¤æ—¶&lt;code>esp&lt;/code>ä¹Ÿå°±æ˜¯æ ˆæŒ‡é’ˆç­‰äº&lt;code>ebp&lt;/code>, è¿™æ˜¯calleeæ ˆçš„åˆå§‹æ¡ä»¶&lt;/strong>. ä¸‡äº‹ä¿±å¤‡, å¯ä»¥å¼€å§‹æ‰§è¡Œcalleeçš„å®é™…ä»»åŠ¡äº†.&lt;/p>
&lt;blockquote>
&lt;p>&lt;code>ebp&lt;/code>åœ¨æ•´ä¸ªå‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¯å›ºå®šçš„, å¥½å¤„æ˜¯: èƒ½å¤Ÿ&lt;strong>å¿«é€Ÿçš„æˆ–è€…å‡½æ•°å‚æ•°, è¿”å›åœ°å€&lt;/strong>.&lt;/p>
&lt;/blockquote>
&lt;h3 id="å‡½æ•°è¿”å›">å‡½æ•°è¿”å›&lt;/h3>
&lt;p>calleeæ‰§è¡Œå®Œæ¯•å, éœ€è¦è¿”å›åˆ°callerç»§ç»­æ‰§è¡Œ. åˆšæ‰è¯´è¿‡, calleeçš„è¿”å›åœ°å€åœ¨æ ˆä¸­, æ‰€ä»¥æˆ‘ä»¬è¦åšçš„æ˜¯æ‰¾åˆ°è¿”å›åœ°å€æ‰€åœ¨çš„ä½ç½®, ç„¶åä½¿&lt;code>pc = è¿”å›åœ°å€&lt;/code>. å½“ç„¶, è¿˜æœ‰å¦ä¸€ä¸ªé‡è¦çš„ä»»åŠ¡å°±æ˜¯&lt;strong>æ¢å¤callerçš„æ ˆ&lt;/strong>.&lt;/p>
&lt;p>ä¸Šè¿°ä»»åŠ¡çš„å®ç°ä½¿ç”¨ä¸¤æ¡æ±‡ç¼–è¯­å¥å°±å¯å®Œæˆ: &lt;code>leave&lt;/code> å’Œ &lt;code>ret&lt;/code>.&lt;/p>
&lt;p>&lt;code>leave&lt;/code> è´Ÿè´£æå®šæ ˆ, å…¶è¯­ä¹‰ä¸º:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-asm" data-lang="asm">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">mov&lt;/span> esp, ebp &lt;span style="color:#6272a4">;å›æ»šæ ˆç©ºé—´
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>pop ebp &lt;span style="color:#6272a4">;æ¢å¤callerçš„ebp
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ret&lt;/code> è´Ÿè´£æå®š&lt;code>pc&lt;/code>, å…¶è¯­ä¹‰ä¸º:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-asm" data-lang="asm">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">pop&lt;/span> ebx &lt;span style="color:#6272a4">;å–å‡ºè¿”å›åœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>mov pc, ebx &lt;span style="color:#6272a4">;jmp to è¿”å›åœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ret&lt;/code> ä¹‹å, å°±ç®—æ˜¯è¿”å›callerçš„åœ°ç›˜äº†. è¿˜æœ‰ä¸€ä»¶å°äº‹åˆ«å¿˜äº†åš: &lt;strong>ç”¨äºä¿å­˜å‚æ•°çš„æ ˆç©ºé—´è¿˜æ²¡æœ‰å›æ”¶&lt;/strong>, å›åˆ°callerä¹‹åéœ€è¦å…ˆå°†&lt;code>esp&lt;/code>çš„ä½ç½®è¿›è¡Œè°ƒæ•´.&lt;/p>
&lt;h3 id="example-å‡½æ•°çš„è°ƒç”¨å’Œè¿”å›">Example: å‡½æ•°çš„è°ƒç”¨å’Œè¿”å›&lt;/h3>
&lt;p>ä¸€ä¸ªå…³äºå‡½æ•°è°ƒç”¨å’Œè¿”å›å®ç°çš„å®Œæ•´ä¾‹å­.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd">void&lt;/span> &lt;span style="color:#50fa7b">caller&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Func(&lt;span style="color:#bd93f9">1&lt;/span>, &lt;span style="color:#bd93f9">2&lt;/span>, &lt;span style="color:#bd93f9">3&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd">void&lt;/span> &lt;span style="color:#50fa7b">Func&lt;/span>(&lt;span style="color:#8be9fd">int&lt;/span> a, &lt;span style="color:#8be9fd">int&lt;/span> b, &lt;span style="color:#8be9fd">int&lt;/span> c)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#6272a4">/* Do something */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>(ä»¥ä¸‹æ±‡ç¼–æ˜¯&lt;strong>AT&amp;amp;T&lt;/strong>æ ¼å¼çš„, è¯·è§è°…).&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-asm" data-lang="asm">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">; Caller
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#50fa7b">sub&lt;/span> $0x4,&lt;span style="color:#8be9fd;font-style:italic">%esp&lt;/span> &lt;span style="color:#6272a4">;make 16-bytes align before call. 0x4 æ˜¯ç”±ç¼–è¯‘å™¨è®¡ç®—çš„
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>push $0x3 &lt;span style="color:#6272a4">;push å‚æ•°, é¡ºåºæ˜¯ä»å³åˆ°å·¦
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>push $0x2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">push&lt;/span> $0x1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">call&lt;/span> &lt;span style="color:#bd93f9">f01000ad&lt;/span> &amp;lt;Func&amp;gt; &lt;span style="color:#6272a4">;Func()&amp;#39;addr is f01000ad
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">;===========&amp;gt;&amp;gt; Turn to callee
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#6272a4">;Func()
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span> push &lt;span style="color:#8be9fd;font-style:italic">%ebp&lt;/span> &lt;span style="color:#6272a4">;preserve old ebp
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span> mov &lt;span style="color:#8be9fd;font-style:italic">%esp&lt;/span>,&lt;span style="color:#8be9fd;font-style:italic">%ebp&lt;/span> &lt;span style="color:#6272a4">;set new ebp, ebp=esp now
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span> /* Do something */
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#50fa7b">leave&lt;/span> &lt;span style="color:#6272a4">;restore stack
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span> ret &lt;span style="color:#6272a4">;restore instruction point
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">;&amp;lt;&amp;lt;=========== Back to caller
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>add $0x10,&lt;span style="color:#8be9fd;font-style:italic">%esp&lt;/span> &lt;span style="color:#6272a4">;recycle stack(12 bytes parameters plus 4 bytes alignment)
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="armv8-è°ƒç”¨çº¦å®š">Armv8 è°ƒç”¨çº¦å®š&lt;/h2>
&lt;p>å¤§ä½“çš„æ€æƒ³ä¸x86ç›¸ä¼¼, åªæ˜¯ç»†èŠ‚æœ‰äº›è®¸ä¸åŒ&lt;/p>
&lt;h3 id="å‡½æ•°è°ƒç”¨-1">å‡½æ•°è°ƒç”¨&lt;/h3>
&lt;p>ARMv8æ¶æ„ä¸­, å‡½æ•°è°ƒç”¨ä»¥ä¸€æ¡&lt;code>bl&lt;/code>æŒ‡ä»¤ä¸ºåˆ†ç•Œ.&lt;/p>
&lt;p>æ‰§è¡Œ&lt;code>bl&lt;/code>æŒ‡ä»¤ä¹‹å‰, éœ€è¦å°†å‚æ•°å‡†å¤‡å¥½. æ³¨æ„, &lt;strong>ARMv8ä¸­, å°‘äº8ä¸ªå‚æ•°çš„å‡½æ•°åœ¨ä¼ å‚æ—¶, å‚æ•°æ˜¯æ”¾åœ¨x0-x7ä¸­&lt;/strong>, æœ€å·¦è¾¹çš„å‚æ•°å…ˆä½¿ç”¨x0, ä»¥æ­¤ç±»æ¨. å‚æ•°è¶…è¿‡8ä¸ªçš„æƒ…å†µä¸‹æ‰ä½¿ç”¨æ ˆ, è¿™ä¸x86çš„æ–¹å¼ä¸åŒ.&lt;/p>
&lt;p>&lt;code>bl&lt;/code>æŒ‡ä»¤ä¿å­˜è¿”å›åœ°å€, å¹¶è·³è½¬åˆ°calleeæ‰§è¡Œ, å…¶è¯­ä¹‰æ˜¯:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-asm" data-lang="asm">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">mov&lt;/span> lr, pc+&lt;span style="color:#bd93f9">1&lt;/span> &lt;span style="color:#6272a4">;preserve return address
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span> &lt;span style="color:#6272a4">;lr specially used for preservering return addr
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>mov pc, new_func &lt;span style="color:#6272a4">;set pc = new function
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸x86ç›¸åŒ, è·³è½¬åˆ°calleeä¹‹åå¿…é¡»å…ˆè¿›è¡Œæ ˆçš„è®¾ç½®, &lt;strong>Armä¸x86ä¸åŒçš„æ˜¯å®ƒä¸éœ€è¦ç®¡ç†æ ˆåº•å¯„å­˜å™¨&lt;/strong>. å› ä¸ºå‚æ•°å¤§éƒ¨åˆ†æ˜¯é€šè¿‡å¯„å­˜å™¨æ¥ä¼ é€’, è¿”å›åœ°å€ä¹Ÿæ˜¯å­˜å‚¨åœ¨&lt;code>lr(x30)&lt;/code>å¯„å­˜å™¨ä¸­, æ²¡å¿…è¦ä¸ºäº†æå°‘çš„æƒ…å†µæ¥åšä¼˜åŒ–.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-asm" data-lang="asm">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">sub&lt;/span> sp, sp, &lt;span style="color:#6272a4">#enough-space
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å‡½æ•°è¿”å›-1">å‡½æ•°è¿”å›&lt;/h3>
&lt;p>è¦å®Œæˆä¸¤ä»¶äº‹: (1) æ¢å¤æ ˆ (2)è¿”å›åŸæ¥ä½ç½®æ‰§è¡Œ&lt;/p>
&lt;p>å…ˆè¯´(2), ç”±äº&lt;code>lr&lt;/code>å¯„å­˜å™¨å§‹ç»ˆä¿å­˜è¿”å›åœ°å€, ç›´æ¥ &lt;code>mov sp, lr&lt;/code> å°±èƒ½è¿”å›callerç»§ç»­æ‰§è¡Œ. &lt;strong>è¿™ä¹Ÿå°±æ˜¯&lt;code>ret&lt;/code>æŒ‡ä»¤çš„è¯­ä¹‰&lt;/strong>.&lt;/p>
&lt;p>(1)æ¢å¤æ ˆçš„è¿™ä»¶äº‹åŒx86ä¸€æ ·ç”±calleeå®Œæˆ,&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-asm" data-lang="asm">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">add&lt;/span> sp, sp, &lt;span style="color:#6272a4">#enough-space
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚è€ƒ">å‚è€ƒ&lt;/h2>
&lt;ol>
&lt;li>x86 call æŒ‡ä»¤æ‰§è¡Œå‰éœ€è¦espå¯¹é½åˆ° 16-byte: &lt;a href="https://stackoverflow.com/questions/41971481/what-are-the-following-instructions-after-this-call-assembly">x86 - What are the following instructions after this call (assembly) - Stack Overflow&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://zhuanlan.zhihu.com/p/290689333">x86æ ˆå¸§åŸç† - çŸ¥ä¹ (zhihu.com)&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="ç»“è¯­">ç»“è¯­&lt;/h2>
&lt;p>èƒ½å¤Ÿæ­£ç¡®è¾¾åˆ°å‡½æ•°è°ƒç”¨å’Œè¿”å›çš„å®ç°æ–¹å¼æœ‰å¾ˆå¤š, &lt;strong>ä¸æ˜¯ä»…æœ‰è¿™ä¸€ç§æ–¹å¼&lt;/strong>, çº¦å®šä»…ä»…æ˜¯ä¸€ä¸ªçº¦å®š, å¤§å®¶éƒ½è¿™æ ·å»åšé™ä½äº†å¼€å‘çš„éš¾åº¦.&lt;/p>
- https://wangloo.github.io/posts/os/function-call-conventions/ - @2019 Notepadium.</description></item><item><title>äºŒçº§æŒ‡é’ˆæ“ä½œé“¾è¡¨</title><link>https://wangloo.github.io/posts/c/pointers-pointers-list/</link><pubDate>Sun, 20 Nov 2022 23:40:30 +0800</pubDate><guid>https://wangloo.github.io/posts/c/pointers-pointers-list/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/c/pointers-pointers-list/ -&lt;p>é—®é¢˜æºäºæˆ‘åœ¨çŸ¥ä¹åˆ·åˆ°çš„ä¸€ä¸ªå›ç­”: &lt;a href="https://www.zhihu.com/question/477832027/answer/2044206446">èƒ½åˆ†äº«ä½ CæŒ‡é’ˆç”¨å¾—æœ€çµæ´»ï¼ˆé£˜ï¼‰çš„ä¸€æ¬¡å—?&lt;/a>&lt;/p>
&lt;p>æ–‡ä¸­æåˆ°äº†Linuså…³äº&lt;strong>æ— å¤´èŠ‚ç‚¹å•é¡¹é“¾è¡¨çš„åˆ é™¤æ“ä½œ&lt;/strong>ç»™å‡ºçš„ä¸€ç§æ–°çš„æ€è·¯, æˆ‘è§‰å¾—å¯¹ç†è§£æŒ‡é’ˆéå¸¸æœ‰å¸®åŠ©, æ‰€ä»¥åœ¨è¿™é‡Œè¯¦ç»†æè¿°ä¸€ä¸‹è¿™ä»¶äº‹.&lt;/p>
&lt;p>ä»æˆ‘å­¦ä¹ æ•°æ®ç»“æ„èµ·, å¯¹ä¸å«å¤´èŠ‚ç‚¹çš„å•å‘é“¾è¡¨çš„åˆ é™¤æ“ä½œ, åšæ³•å¸¸æ˜¯: å€Ÿç”¨&lt;strong>preæŒ‡é’ˆ&lt;/strong>æœç´¢. è¿™ç§æƒ…å†µä¸‹é¿å…ä¸äº†å¯¹äºé“¾è¡¨ä¸­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„ç‰¹åˆ¤(ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰pre).&lt;/p>
&lt;p>Linusæåˆ°äº†ä¸€ç§å€ŸåŠ©&lt;strong>äºŒçº§æŒ‡é’ˆé¿å…è¯¥åˆ†æ”¯&lt;/strong>çš„æ–¹æ³•.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd">void&lt;/span> &lt;span style="color:#50fa7b">remove_if&lt;/span>(node &lt;span style="color:#ff79c6">**&lt;/span> head, remove_fn rm)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">for&lt;/span> (node&lt;span style="color:#ff79c6">**&lt;/span> curr &lt;span style="color:#ff79c6">=&lt;/span> head; &lt;span style="color:#ff79c6">*&lt;/span>curr; )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node &lt;span style="color:#ff79c6">*&lt;/span> entry &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#ff79c6">*&lt;/span>curr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">if&lt;/span> (rm(entry))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">*&lt;/span>curr &lt;span style="color:#ff79c6">=&lt;/span> entry&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> free(entry);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">else&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> curr &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#ff79c6">&amp;amp;&lt;/span>entry&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŒ‡é’ˆçš„å†…å®¹å°±æ˜¯åœ°å€, &lt;code>int *p = a&lt;/code> ä¹Ÿå°±æ„å‘³ç€å˜é‡&lt;code>p&lt;/code> ä¸­ä¿å­˜ç€å˜é‡&lt;code>a&lt;/code>çš„åœ°å€. æ‰€ä»¥å‚æ•°&lt;code>head&lt;/code>åœ¨å†…å­˜ä¸­çš„å«ä¹‰ä¸º:&lt;/p>
&lt;p>&lt;img src="./mem.png" alt="listçš„å†…å­˜å¸ƒå±€">&lt;/p>
&lt;p>å‡å¦‚è¦åˆ é™¤node2, é‚£ä¹ˆæ”¹å˜&lt;code>*curr&lt;/code>å®é™…ä¸Šå°±æ˜¯&lt;strong>æ”¹äº†node1çš„&lt;code>next&lt;/code>æˆå‘˜&lt;/strong>.&lt;/p>
- https://wangloo.github.io/posts/c/pointers-pointers-list/ - @2019 Notepadium.</description></item><item><title>å¤§å°ç«¯é—®é¢˜</title><link>https://wangloo.github.io/posts/os/big-little-endian/</link><pubDate>Thu, 17 Nov 2022 10:30:35 +0800</pubDate><guid>https://wangloo.github.io/posts/os/big-little-endian/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/os/big-little-endian/ -&lt;hr>
&lt;h2 id="å¤§å°ç«¯é—®é¢˜çš„ç”±æ¥">å¤§å°ç«¯é—®é¢˜çš„ç”±æ¥&lt;/h2>
&lt;p>ä¸ºä»€ä¹ˆè®¡ç®—æœºä¸–ç•Œéœ€è¦åŒºåˆ†å¤§å°ç«¯? &lt;strong>å†…å­˜é‡Œå­˜å–çš„å•ä½æ˜¯å­—èŠ‚&lt;/strong>, å¦‚æœæ‰€æœ‰çš„æ•°æ®ç±»å‹é•¿åº¦éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚, é‚£å°±å®Œå…¨ä¸éœ€è¦å¤§å°ç«¯äº†, æ¯ä¸ªå˜é‡éƒ½ä»…å æ®å•ç‹¬ä¸€ä¸ªå­—èŠ‚.&lt;/p>
&lt;p>ä¾‹å¦‚, ä¸‰ä¸ªå˜é‡ &lt;code>a=10, b=20, c=30&lt;/code>, åœ¨å†…å­˜ä¸­çš„å¸ƒå±€å¯èƒ½å°±æ˜¯:&lt;/p>
&lt;pre tabindex="0">&lt;code> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ 10 â”‚ a
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚
â”‚ 20 â”‚ b
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚
â”‚ 30 â”‚ c
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚
â”‚ â”‚
â”‚ â”‚
â”‚ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/code>&lt;/pre>&lt;p>ä½†æ˜¯æˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„æ•°æ®ç±»å‹è‚¯å®šæœ‰è¶…è¿‡ä¸€ä¸ªå­—èŠ‚çš„, &lt;code>int&lt;/code>ç±»å‹åœ¨64ä½çš„ç³»ç»Ÿä¸­å°±å &lt;strong>4ä¸ªå­—èŠ‚&lt;/strong>. ä¾‹å¦‚å˜é‡&lt;code>a=0xaabbccdd&lt;/code>&lt;/p>
&lt;p>ä¸€ä¸ªå˜é‡çš„å¤§å°ä¸€æ—¦è¶…è¿‡4ä¸ªå­—èŠ‚, &lt;strong>å†…å­˜çš„å­˜å–åˆæ˜¯ä»¥å­—èŠ‚ä½å•ä½çš„&lt;/strong>, é‚£ä¹ˆè¦æŠŠå®ƒå¡åˆ°å†…å­˜é‡Œå°±å¿…ç„¶ä¼šäº§ç”Ÿä¸¤ç§ä¸åŒå­˜æ”¾æ–¹å¼: &lt;strong>å…ˆæ”¾&lt;code>0xaa&lt;/code>è¿˜æ˜¯å…ˆæ”¾&lt;code>0xdd&lt;/code>&lt;/strong>&lt;/p>
&lt;p>é¦–å…ˆ, &lt;code>0xdd&lt;/code>æ˜¯å˜é‡açš„ä½8ä½, &lt;code>0xaa&lt;/code>æ˜¯æœ€é«˜8ä½, è¿™æ˜¯ç¡®å®šçš„.&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å¦‚æœå…ˆæ”¾&lt;code>0xaa&lt;/code>, å³ä½åœ°å€æ”¾é«˜ä½, å°±å«åš&lt;em>å¤§ç«¯&lt;/em>, å¦‚å·¦å›¾;&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœå…ˆæ”¾&lt;code>0xdd&lt;/code>, å³ä½åœ°å€æ”¾ä½ä½, å°±å«&lt;em>å°ç«¯&lt;/em>, å¦‚å³å›¾.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>
start addr of `a` start addr of `a`
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚ â”‚ â”‚
â”‚ aa â”‚ â”‚ dd â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ â”‚ â”‚
â”‚ bb â”‚ â”‚ cc â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ â”‚ â”‚
â”‚ cc â”‚ â”‚ bb â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ â”‚ â”‚
â”‚ dd â”‚ â”‚ aa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/code>&lt;/pre>&lt;h2 id="ä»€ä¹ˆæƒ…å†µ">ä»€ä¹ˆæƒ…å†µ?&lt;/h2>
&lt;p>çœ‹ä¸‹é¢çš„ä»£ç , çŒœæµ‹è¾“å‡ºçš„ç»“æœ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd">unsigned&lt;/span> &lt;span style="color:#8be9fd">int&lt;/span> i &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0x00646c72&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>printf(&lt;span style="color:#f1fa8c">&amp;#34;Hello Wo%s&amp;#34;&lt;/span>, &lt;span style="color:#ff79c6">&amp;amp;&lt;/span>i);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>%s&lt;/code> ä¼šæŒ‰å­—èŠ‚ä¸€ç›´æ‰“å°å†…å­˜ä¸­çš„å­—ç¬¦, ç›´åˆ°é‡åˆ°&lt;code>\0&lt;/code>. é¦–å…ˆæ‰“å°çš„å­—ç¬¦ä¾¿æ˜¯å˜é‡&lt;code>i&lt;/code>çš„åœ°å€å¤„çš„å†…å®¹.&lt;/p>
&lt;p>å¦‚æœæ˜¯å°ç«¯å­˜å‚¨æ–¹å¼, å˜é‡&lt;code>i&lt;/code>çš„åœ°å€å¤„çš„ä¸€ä¸ªå­—èŠ‚å€¼æ˜¯0x72, å³å­—ç¬¦&lt;code>r&lt;/code>. ä»¥æ­¤ç±»æ¨, æ‰€ä»¥å¦‚æœCPUçš„å­—èŠ‚åºæ˜¯å°ç«¯å½¢å¼, é‚£ä¹ˆ&lt;code>printf&lt;/code>çš„ç»“æœæ˜¯: Hello world&lt;/p>
&lt;h2 id="å¤§å°ç«¯å½¢å¼çš„ä¼˜ç¼ºç‚¹">å¤§å°ç«¯å½¢å¼çš„ä¼˜ç¼ºç‚¹&lt;/h2>
&lt;p>å°ç«¯çš„ä¼˜åŠ¿:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ä»¥ä¸åŒçš„é•¿åº¦è¯»å–å˜é‡éå¸¸æ–¹ä¾¿, ä¸ç”¨è®¡ç®—åœ°å€. ä¾‹å¦‚&lt;code>u64 a=0x1234&lt;/code>, å½“&lt;code>(u16)a&lt;/code>æ—¶, CPUä¸éœ€è¦é‡æ–°è®¡ç®—è¯»å–çš„èµ·å§‹ä½ç½®, æ°¸è¿œéƒ½æ˜¯å˜é‡açš„èµ·å§‹åœ°å€.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Easily to do mathematical computations â€œbecause of the 1:1 relationship between address offset and byte number (offset 0 is byte 0), multiple precision math routines are correspondingly easy to write.â€&lt;/p>
&lt;/li>
&lt;/ol>
- https://wangloo.github.io/posts/os/big-little-endian/ - @2019 Notepadium.</description></item><item><title>æ“ä½œç³»ç»Ÿâ€”â€”ä¸Šä¸‹æ–‡åˆ‡æ¢</title><link>https://wangloo.github.io/posts/os/context/</link><pubDate>Mon, 14 Nov 2022 22:13:06 +0800</pubDate><guid>https://wangloo.github.io/posts/os/context/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/os/context/ -&lt;p>æœ¬æ–‡åŸºäº&lt;strong>AArch64&lt;/strong>æ‰§è¡Œç¯å¢ƒ, ä»‹ç»ç°ä»£æ“ä½œç³»ç»Ÿä¸­ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ç›¸å…³å†…å®¹.&lt;/p>
&lt;h2 id="ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡">ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡ï¼Ÿ&lt;/h2>
&lt;p>ä¸Šä¸‹æ–‡åˆç§°â€œç°åœºâ€,&lt;/p>
&lt;h2 id="ä¸ºä»€ä¹ˆéœ€è¦ä¸Šä¸‹æ–‡åˆ‡æ¢">ä¸ºä»€ä¹ˆéœ€è¦ä¸Šä¸‹æ–‡åˆ‡æ¢?&lt;/h2>
&lt;p>(TODO: ä¸ºä»€ä¹ˆè¯´çº¿ç¨‹æ˜¯è°ƒåº¦çš„å•ä½?)&lt;/p>
&lt;p>ç°ä»£æ“ä½œç³»ç»Ÿä¸­åŒæ—¶å­˜åœ¨ç€æˆåƒä¸Šç™¾ä¸ªçº¿ç¨‹, ä½†æ˜¯ä¸€ä¸ªCPUåŒä¸€æ—¶åˆ»åªèƒ½è¿è¡Œä¸€ä¸ªçº¿ç¨‹, ä»–ä»¬æ˜¯è½®æµçš„å ç”¨CPU, ä¹Ÿå«å¹¶å‘æ‰§è¡Œ. (TODO: å¦‚ä½•æŸ¥çœ‹çº¿ç¨‹åˆ‡æ¢çš„é—´éš”?) çº¿ç¨‹é«˜é¢‘ç‡çš„åˆ‡æ¢, æ“ä½œç³»ç»Ÿæ˜¯å¦‚ä½•ä¿è¯åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ‰§è¡Œçš„çº¿ç¨‹æ—¶, å®ƒèƒ½å¤Ÿç»§ç»­ä¸Šæ¬¡çš„å·¥ä½œå‘¢?&lt;/p>
&lt;h3 id="ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡-1">ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡?&lt;/h3>
&lt;p>æˆ‘ä»¬æ­£åœ¨çœ‹ä¸€æœ¬ä¹¦çš„æ—¶å€™å¦‚æœè¢«å…¶ä»–çš„äº‹æƒ…æ‰“æ–­, è¿”å›æ—¶ä¸ºäº†èƒ½å¤Ÿä»ä¸Šæ¬¡è¢«æ‰“æ–­çš„ä½ç½®ç»§ç»­è¯», å°±è¦åœ¨è¢«æ‰“æ–­çš„æ—¶å€™è®°ä¸‹æ¥å½“å‰æ˜¯è¯»åˆ°äº†å“ªä¸ªç¬¬å‡ é¡µçš„ç¬¬å‡ è¡Œ.&lt;/p>
&lt;p>æ“ä½œç³»ç»Ÿå¯¹å¾…çº¿ç¨‹ä¹Ÿæ˜¯å¦‚æ­¤, éœ€è¦ä¿å­˜çš„ç”¨äºæ¢å¤çº¿ç¨‹æ‰§è¡Œçš„ä¿¡æ¯å°±ç§°ä¸ºçº¿ç¨‹çš„ä¸Šä¸‹æ–‡.&lt;/p>
&lt;p>é‚£ä¹ˆå¯¹äºçº¿ç¨‹æ¥è¯´éœ€è¦è®°ä¸‹çš„å†…å®¹æœ‰ä»€ä¹ˆå‘¢? å¯„å­˜å™¨å’Œæ ˆå³å¯. æ‹¿AArch64æ¶æ„æ¥è·ç¦», çº¿ç¨‹çš„ä¸Šä¸‹æ–‡å°±æ˜¯:&lt;/p>
&lt;ol>
&lt;li>é€šç”¨å¯„å­˜å™¨&lt;code>x0-x29&lt;/code>: å‡½æ•°è°ƒç”¨çš„å‚æ•°, æŸäº›è®¡ç®—è¿‡ç¨‹çš„ä¸­é—´å€¼, éƒ½è¦ç”¨åˆ°è¿™äº›å¯„å­˜å™¨. &lt;strong>çº¿ç¨‹çš„æ‰§è¡Œæµå¯èƒ½åœ¨ä»»ä½•æ—¶å€™è¢«æ‰“æ–­&lt;/strong>, å½“ç„¶è¿™äº›å†…å®¹ä¹Ÿä¸èƒ½ä¸¢.&lt;/li>
&lt;li>é€šç”¨å¯„å­˜å™¨&lt;code>lr(x30)&lt;/code>: &lt;code>lr&lt;/code> ä¿å­˜ç€è¿”å›åœ°å€, å³å½“å‰å‡½æ•°ç»“æŸä¹‹åè¯¥è¿”å›åˆ°å“ªæ‰§è¡Œ.&lt;/li>
&lt;li>æ ˆé¡¶æŒ‡é’ˆ &lt;code>sp&lt;/code>: æ ˆçš„é‡è¦æ€§æ— éœ€å¤šè¨€. ä½†æ˜¯éœ€è¦è¯´æ˜çš„æ˜¯æˆ‘ä»¬ä¿å­˜æ ˆçš„æ–¹å¼&lt;strong>å¹¶éå°†æ ˆä¸­çš„æ‰€æœ‰å†…å®¹ä¿å­˜, è€Œæ˜¯ä¿å­˜æ ˆçš„ä½ç½®&lt;/strong>å³å¯. å› ä¸ºæ“ä½œç³»ç»Ÿæœ‰åˆ«çš„æœºåˆ¶(TODO), èƒ½å¤Ÿä¿è¯å³ä¾¿çº¿ç¨‹ä¸åœ¨æ‰§è¡Œ, å±äºè¯¥çº¿ç¨‹çš„æ ˆä¹Ÿä¸ä¼šè¢«ç ´å.&lt;/li>
&lt;li>ç¨‹åºè®¡æ•°å™¨ &lt;code>pc&lt;/code>: è¢«æ‰“æ–­çš„çº¿ç¨‹å¦‚æœå†æ¬¡æ‰§è¡Œ, ä»å“ªé‡Œæ‰§è¡Œå‘¢? æ˜¾ç„¶æ˜¯è¢«æ‰“æ–­æŒ‡ä»¤çš„ä¸‹ä¸€æ¡(æˆ–è€…é‡æ–°æ‰§è¡Œå½“å‰). è¿™ä¸ªæŒ‡ä»¤çš„åœ°å€å½“ç„¶ä¹Ÿéœ€è¦è¢«ä¿å­˜å¥½.&lt;/li>
&lt;li>PSTATE: æƒ³ä¸€ä¸‹, æœ‰äº†ä»¥ä¸Šçš„å†…å®¹å°±èƒ½å¤Ÿä¿è¯çº¿ç¨‹å®Œæ•´çš„æ¢å¤ä¹‹å‰çš„ç¯å¢ƒå—? å…¶ä»–çš„ä¾‹å¦‚ä¸­æ–­æ˜¯å¼€è¿˜æ˜¯å…³, æœ‰å“ªäº›æ ‡å¿—ä½(NZCV)è¢«è®¾ç½®äº†. è¿™äº›ä¿¡æ¯åœ¨AArch64ä¸­æ˜¯ä¿å­˜åœ¨PSTATEçš„å„ä¸ªå­—æ®µä¸­.&lt;/li>
&lt;/ol>
&lt;p>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæœ‰ä¸€ä¸ªé€‚å½“çš„é€»è¾‘, åœ¨çº¿ç¨‹åˆ‡æ¢å‡ºå»çš„æ—¶å€™å°†ä¸Šä¸‹æ–‡ä¿å­˜èµ·æ¥, ç„¶åæ¢å¤æ–°çº¿ç¨‹çš„ä¸Šä¸‹æ–‡, æ˜¯ä¸æ˜¯çº¿ç¨‹åˆ‡æ¢è¿™ä»¶äº‹å°±èƒ½åšåˆ°äº†. å¦‚ä½•ç»„ç»‡è¿™ä¸ªä¿å­˜å’Œæ¢å¤çš„è¿‡ç¨‹åœ¨ä¸‹é¢ä¼šä»‹ç»åˆ°.&lt;/p>
&lt;h2 id="linux-å¦‚ä½•å¤„ç†ä¸Šä¸‹æ–‡åˆ‡æ¢">Linux å¦‚ä½•å¤„ç†ä¸Šä¸‹æ–‡åˆ‡æ¢&lt;/h2>
&lt;h2 id="å¦ä¸€ç§å¤„ç†ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ€è·¯">å¦ä¸€ç§å¤„ç†ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ€è·¯&lt;/h2>
&lt;h2 id="åç¨‹çš„ä¸Šä¸‹æ–‡">åç¨‹çš„ä¸Šä¸‹æ–‡&lt;/h2>
&lt;p>åç¨‹æ˜¯ç”¨æˆ·çº§åˆ«çš„çº¿ç¨‹,&lt;/p>
&lt;ul>
&lt;li>åç¨‹ä¹‹é—´çš„åˆ‡æ¢ä¸è¿›å…¥å†…æ ¸&lt;/li>
&lt;li>åˆ‡æ¢åç¨‹åªèƒ½æ˜¯æŸä¸ªåç¨‹&lt;strong>ä¸»åŠ¨æ”¾å¼ƒæ§åˆ¶æƒ&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä»¬åœ¨è¿™é‡Œè®¨è®ºä¸€ä¸‹åç¨‹åˆ‡æ¢æ—¶éœ€è¦ä¿å­˜çš„ä¸Šä¸‹æ–‡æ˜¯å¦ä¸çº¿ç¨‹æœ‰æ‰€ä¸åŒ.&lt;/p>
&lt;p>é¦–å…ˆ, PCä¸€å®šå±äº, è¿™ä¸ªæ¯‹åº¸ç½®ç–‘. å…¶æ¬¡æ˜¯æ ˆé¡¶æŒ‡é’ˆsp, &lt;strong>æ¯ä¸ªåç¨‹éƒ½æœ‰å•ç‹¬çš„æ ˆ&lt;/strong>, å¦‚æœä¸ä¿å­˜æ ˆçš„ä½ç½®, é‚£ä¹ˆåç¨‹å†…éƒ¨å®šä¹‰å±€éƒ¨å˜é‡å°±æ²¡æ³•è®¿é—®äº†(å±€éƒ¨å˜é‡çš„è®¿é—®æŒ‡ä»¤éƒ½æ˜¯ä»¥spä¸ºbaseçš„åç§»æ¥åšçš„).&lt;/p>
&lt;p>å¦å¤–, å…³äºé€šç”¨å¯„å­˜å™¨, ç”±äºåç¨‹çš„åˆ‡æ¢éœ€è¦ä¸»åŠ¨è°ƒç”¨æŸä¸ªå‡½æ•°(é€šå¸¸å«åš&lt;code>yield()&lt;/code>), åœ¨å‡½æ•°çš„æœ€åå°†PCè®¾ç½®ä¸ºæ–°åç¨‹çš„ä¸Šä¸‹æ–‡PC. ä¿å­˜å½“å‰åç¨‹ä¸Šä¸‹æ–‡çš„æ“ä½œä¹Ÿåœ¨è¿™ä¸ªå‡½æ•°ä¸­, è€Œå…¶å‚æ•°æˆ‘ä»¬å¹¶ä¸å…³å¿ƒ, å³&lt;code>x0&lt;/code>-&lt;code>x7&lt;/code>æ²¡å¿…è¦ä¿å­˜. åŒæ ·çš„, &lt;strong>caller-savedå¯„å­˜å™¨ä¹Ÿæ˜¯æ²¡å¿…è¦ä¿å­˜çš„&lt;/strong>, å› ä¸ºè¿™äº›å¯„å­˜å™¨ä½œä¸ºå‡½æ•°è°ƒç”¨ä½¿ç”¨çš„ä¸´æ—¶å˜é‡, å½“å†æ¬¡è¿”å›è¯¥åç¨‹æ—¶, PC=yield()è¿”å›åœ°å€, callerå¦‚æœå…³å¿ƒè¿™äº›å¯„å­˜å™¨åº”å½“è‡ªå·±æ‰§è¡Œä¿å­˜å’Œæ¢å¤. ä½†æ˜¯&lt;strong>callee-savedå¯„å­˜å™¨å¿…é¡»è¦ä¿å­˜åˆ°ä¸Šä¸‹æ–‡ä¸­&lt;/strong>, å› ä¸ºåœ¨yield()ä¸­, æˆ‘ä»¬å¦‚æœä¿®æ”¹äº†callee-savedå¯„å­˜å™¨, å°±éœ€è¦åœ¨è¿”å›æ—¶(ä¹Ÿå°±æ˜¯å†æ¬¡è°ƒåº¦åˆ°è¯¥åç¨‹æ—¶) æ¢å¤, è¿™æ˜¯calleeè¯¥åšçš„, ä¹Ÿå°±æ˜¯ä¸Šä¸‹æ–‡ä¸­åº”è¯¥æœ‰çš„å”¯ä¸€é€šç”¨å¯„å­˜å™¨ç»„.&lt;/p>
- https://wangloo.github.io/posts/os/context/ - @2019 Notepadium.</description></item></channel></rss>