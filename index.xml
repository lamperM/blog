<?xml-stylesheet href="/rss.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Homepage ğŸŒˆ on Wangloo's BLOG</title><link>https://wangloo.github.io/</link><description>Recent content in Homepage ğŸŒˆ on Wangloo's BLOG</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>@2019 Notepadium.</copyright><lastBuildDate>Thu, 15 Sep 2022 15:14:05 +0800</lastBuildDate><atom:link href="https://wangloo.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>Linux å†…æ ¸æ•°æ®ç»“æ„ hlist</title><link>https://wangloo.github.io/posts/os/linux/data_struct/hlist/</link><pubDate>Thu, 11 May 2023 20:51:49 +0800</pubDate><guid>https://wangloo.github.io/posts/os/linux/data_struct/hlist/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/os/linux/data_struct/hlist/ -&lt;p>linux å†…æ ¸ä¸ºåˆ›å»ºã€ç”¨å•é“¾è¡¨è§£å†³å†²çªçš„å“ˆå¸Œè¡¨ã€‘è®¾è®¡äº†ä¸“é—¨çš„æ•°æ®ç»“æ„ hlistã€‚&lt;/p>
&lt;p>hlist æ•´ä½“æ¥è¯´æ˜¯å¸¦å¤´ç»“ç‚¹çš„åŒå‘é“¾è¡¨ï¼Œå¤´ç»“ç‚¹çš„ç±»å‹ä¸º&lt;code>hlist_head&lt;/code>, æ™®é€šèŠ‚ç‚¹
çš„ç±»å‹ä¸º&lt;code>hlist_node&lt;/code>. &lt;strong>ä¸ºä»€ä¹ˆè¦åŒºåˆ«ä¸¤ç§ç±»å‹ï¼ŸèŠ‚çº¦ç©ºé—´&lt;/strong>ï¼Œ å› ä¸ºå“ˆå¸Œè¡¨çš„
è¡¨é¡¹ç±»å‹å¯ä»¥æ˜¯&lt;code>hlist_head&lt;/code>, å®ƒå…¶å®ä¸éœ€è¦&lt;code>prev&lt;/code>æŒ‡é’ˆ, æ¯”èµ·ä¸€èˆ¬çš„ç»“ç‚¹ï¼Œä¸€ä¸ª
å“ˆå¸Œè¡¨èƒ½èŠ‚çº¦ä¸€åŠçš„ç©ºé—´ã€‚&lt;/p>
&lt;p>æ‰€ä»¥ä¸€ä¸ªå“ˆå¸Œè¡¨å’Œå¤´ç»“ç‚¹çš„ç»“æ„å¯è¡¨ç¤ºä¸º:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">struct&lt;/span> hlist_head {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">struct&lt;/span> hlist_node &lt;span style="color:#ff79c6">*&lt;/span>first;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">struct&lt;/span> hlist_head table[TALBE_SZ];
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="äºŒè±¡æ€§">äºŒè±¡æ€§&lt;/h2>
&lt;p>ä»»ä½•äº‹ç‰©éƒ½å…·æœ‰äºŒè±¡æ€§ï¼ŒåŒºåˆ†ä¸¤ç§ç±»å‹èŠ‚çº¦ç©ºé—´çš„ç©ºé—´ï¼Œä¹Ÿå¸¦äº†ä¸€ä¸ªé—®é¢˜ï¼š
&lt;strong>é¦–ä¸ª&lt;code>hlist_node&lt;/code>ç»“ç‚¹çš„&lt;code>prev&lt;/code>æŒ‡å‘å“ªå‘¢ï¼Ÿ&lt;/strong>&lt;/p>
&lt;p>æ­£å¸¸æƒ…å†µä¸‹è‚¯å®šæ¯«ä¸çŠ¹è±«çš„æŒ‡å‘å¤´ç»“ç‚¹ï¼Œå³&lt;code>hlist_head&lt;/code>ï¼Œä½†æ³¨æ„æ­¤æ—¶ç±»å‹æ˜¯
ä¸åŒçš„ï¼Œ&lt;code>prev&lt;/code>ä¸èƒ½åŒæ—¶æ˜¯&lt;code>struct hlist_head*&lt;/code>å’Œ&lt;code>struct hlist_node *&lt;/code>ã€‚&lt;/p>
&lt;p>è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ä¸ªï¼Œé¦–å…ˆå¯ä»¥ä½¿é¦–ä¸ªç»“ç‚¹çš„&lt;code>prev=NULL&lt;/code>, è¿™æ ·è™½ç„¶é¿å…äº†ç±»å‹å¼•å‘çš„
é—®é¢˜ï¼Œä¹Ÿèƒ½ä¿è¯åŠŸèƒ½æ­£ç¡®ï¼Œä½†æ˜¯å´ç ´åäº†ä¸€è‡´æ€§ï¼Œä½¿å¾—æ“ä½œçš„å¤æ‚åº¦ä¸Šå‡ï¼Œå¢åŠ äº†è®¸å¤š
åˆ¤æ–­åˆ†æ”¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">// delelt a node
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#8be9fd">void&lt;/span> &lt;span style="color:#50fa7b">del_node&lt;/span>(&lt;span style="color:#ff79c6">struct&lt;/span> hlist_head &lt;span style="color:#ff79c6">*&lt;/span>head, &lt;span style="color:#ff79c6">struct&lt;/span> hlist_node &lt;span style="color:#ff79c6">*&lt;/span>node)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#6272a4">// è¿™ä¸ªif æœ¬æ¥æ˜¯ä¸éœ€è¦çš„ï¼Œç”šè‡³å‚æ•°çš„head ä¹Ÿä¸éœ€è¦ä¼ ï¼Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span> &lt;span style="color:#6272a4">// æ›´å¥½çš„å¤„ç†æ–¹å¼è§è§£å†³æ–¹æ¡ˆ2
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span> &lt;span style="color:#ff79c6">if&lt;/span> (node &lt;span style="color:#ff79c6">==&lt;/span> head&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>first) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> head&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>first &lt;span style="color:#ff79c6">=&lt;/span> node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>prev&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next &lt;span style="color:#ff79c6">=&lt;/span> node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">if&lt;/span> (node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>prev &lt;span style="color:#ff79c6">=&lt;/span> node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>prev;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">// insert a node
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#8be9fd">void&lt;/span> &lt;span style="color:#50fa7b">add_node_before&lt;/span>(&lt;span style="color:#ff79c6">struct&lt;/span> hlist_head &lt;span style="color:#ff79c6">*&lt;/span>head, &lt;span style="color:#ff79c6">struct&lt;/span> hlist_node &lt;span style="color:#ff79c6">*&lt;/span>new
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">struct&lt;/span> hlist_node &lt;span style="color:#ff79c6">*&lt;/span>next)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#6272a4">// è¿™ä¸ªif æœ¬æ¥æ˜¯ä¸éœ€è¦çš„ï¼Œå‚æ•°headä¹Ÿæ˜¯ä¸éœ€è¦ä¼ é€’çš„
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span> &lt;span style="color:#ff79c6">if&lt;/span> (next &lt;span style="color:#ff79c6">==&lt;/span> head&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>first) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>prev &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">NULL&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> head&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>first &lt;span style="color:#ff79c6">=&lt;/span> new;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>prev &lt;span style="color:#ff79c6">=&lt;/span> next&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>prev;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>prev&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next &lt;span style="color:#ff79c6">=&lt;/span> new;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next &lt;span style="color:#ff79c6">=&lt;/span> next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> next&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>prev &lt;span style="color:#ff79c6">=&lt;/span> new;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æ›´å¥½çš„è§£å†³æ–¹æ¡ˆ-prev">æ›´å¥½çš„è§£å†³æ–¹æ¡ˆ: &lt;code>**prev&lt;/code>&lt;/h2>
&lt;p>æ”¹å˜&lt;code>struct hlist_node&lt;/code>çš„æ„æˆï¼Œä½¿ç”¨äºŒçº§æŒ‡é’ˆ:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">struct&lt;/span> hlist_node {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">struct&lt;/span> hlist_node &lt;span style="color:#ff79c6">*&lt;/span>next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">struct&lt;/span> hlist_node &lt;span style="color:#ff79c6">**&lt;/span>pprev;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½¿å¾—æ¯ä¸ªç»“ç‚¹çš„&lt;code>pprev = &amp;amp;(prev_node-&amp;gt;next)&lt;/code>, é¦–å…ˆç±»å‹æ˜¯ç»Ÿä¸€çš„ï¼Œå…¶æ¬¡åˆ é™¤å’Œæ·»åŠ 
éƒ½æ— éœ€é¢å¤–çš„åˆ†æ”¯äº†ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd">void&lt;/span> &lt;span style="color:#50fa7b">del_node&lt;/span>(&lt;span style="color:#ff79c6">struct&lt;/span> hlist_node &lt;span style="color:#ff79c6">*&lt;/span>node)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">*&lt;/span>(node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>pprev) &lt;span style="color:#ff79c6">=&lt;/span> node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">if&lt;/span> (node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>pprev &lt;span style="color:#ff79c6">=&lt;/span> node&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>pprev;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd">void&lt;/span> &lt;span style="color:#50fa7b">add_node&lt;/span>(&lt;span style="color:#ff79c6">struct&lt;/span> hlist_node &lt;span style="color:#ff79c6">*&lt;/span>new, &lt;span style="color:#ff79c6">struct&lt;/span> hlist_node &lt;span style="color:#ff79c6">*&lt;/span>next)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>pprev &lt;span style="color:#ff79c6">=&lt;/span> next&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>pprev;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">*&lt;/span>(new&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>pprev) &lt;span style="color:#ff79c6">=&lt;/span> new;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next &lt;span style="color:#ff79c6">=&lt;/span> next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> next&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>pprev &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#ff79c6">&amp;amp;&lt;/span>(new&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>next);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ref:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://zhuanlan.zhihu.com/p/360217911">&lt;code>**prev&lt;/code> å¯ä»¥æé«˜åˆ é™¤çš„æ•ˆç‡&lt;/a>&lt;/li>
&lt;li>stackoverflow&lt;/li>
&lt;/ul>
- https://wangloo.github.io/posts/os/linux/data_struct/hlist/ - @2019 Notepadium.</description></item><item><title>Cè¯­è¨€çš„å†…å­˜å¯¹é½</title><link>https://wangloo.github.io/posts/c/alignment/</link><pubDate>Mon, 08 May 2023 17:19:44 +0800</pubDate><guid>https://wangloo.github.io/posts/c/alignment/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/c/alignment/ -&lt;h2 id="å†…å­˜å¯¹é½ä¸ºä½•è¢«éœ€è¦">å†…å­˜å¯¹é½ä¸ºä½•è¢«éœ€è¦&lt;/h2>
&lt;p>æ¶æ„è§„å®šäº†æ•°æ®ç±»å‹å¤§å°çš„åŒæ—¶ï¼Œä¹Ÿè§„å®šäº†å¯¹è¿™äº›ç±»å‹çš„å˜é‡åˆæ³•è®¿é—®çš„å¯¹é½è¦æ±‚ã€‚
ä¹Ÿå°±æ˜¯è¯´ï¼Œå˜é‡ä¸èƒ½éšä¾¿çš„æ”¾åœ¨å†…å­˜çš„ä»»æ„ä½ç½®ï¼Œèµ·å§‹åœ°å€å¿…é¡»æ»¡è¶³ç‰¹å®šçš„å¯¹é½è¦æ±‚ï¼Œ
å¯¹ä¸æ»¡è¶³è¦æ±‚çš„å˜é‡å¼ºè¡Œè®¿é—®å°±å«åš&lt;strong>éå¯¹é½è®¿é—®&lt;/strong>ï¼Œ éå¯¹é½è®¿é—®é€šå¸¸ä¼šè§¦å‘å¼‚å¸¸ã€‚&lt;/p>
&lt;h3 id="ä¸€èˆ¬æ•°æ®ç±»å‹çš„å¯¹é½è¦æ±‚">ä¸€èˆ¬æ•°æ®ç±»å‹çš„å¯¹é½è¦æ±‚&lt;/h3>
&lt;p>å¯¹äºä¸€èˆ¬çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ int, long, char è¿™äº›ï¼Œè¦æ±‚å…¶å˜é‡åœ°å€å¯¹é½åˆ°è‡ªèº«å¤§å°ï¼Œ
æ¯”å¦‚ ARM64 ä¸­ï¼Œint å˜é‡çš„åœ°å€å¿…é¡»å¯¹é½åˆ° 4 å­—èŠ‚ï¼Œlong å˜é‡åœ°å€å¿…é¡»å¯¹é½åˆ° 8 å­—èŠ‚ç­‰ç­‰ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆå¯¹äº&lt;code>*(int *)0x1001 = 1234;&lt;/code>, è¿™ç±»çš„å†…å­˜è®¿é—®å°±å«éå¯¹é½çš„å†…å­˜è®¿é—®ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å³ ï¼ˆå˜é‡ addr % å˜é‡ size) ï¼= 0, å°±ç§°ä¸ºéå¯¹é½å†…å­˜è®¿é—®ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç»“æ„ä½“çš„å¯¹é½è¦æ±‚">ç»“æ„ä½“çš„å¯¹é½è¦æ±‚&lt;/h3>
&lt;p>ä¸Šé¢è¯´çš„è¿˜éƒ½æ˜¯ä¸€èˆ¬çš„æ•°æ®ç±»å‹ï¼Œå¯¹äºç»“æ„ä½“è¿™ç§å¤æ‚çš„ç±»å‹ï¼Œå¯¹é½çš„è¦æ±‚ä¹Ÿå¤æ‚äº›ã€‚&lt;/p>
&lt;ul>
&lt;li>é¦–å…ˆæ˜¯ç»“æ„ä½“æˆå‘˜ï¼Œæ¯ä¸ªæˆå‘˜éƒ½å¿…é¡»æ»¡è¶³å…¶è‡ªèº«çš„å¯¹é½è¦æ±‚&lt;/li>
&lt;li>ç„¶åæ˜¯ç»“æ„ä½“å˜é‡è‡ªèº«çš„èµ·å§‹åœ°å€çš„å¯¹é½è¦æ±‚æ˜¯&lt;strong>å…¶æ‰€æœ‰æˆå‘˜çš„æœ€å¤§å¯¹é½è¦æ±‚&lt;/strong>ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç„¶è€Œä¸¤ä¸ªè¦æ±‚å‡æ»¡è¶³æœ‰æ—¶å€™æ ¹æœ¬ä¸å¯èƒ½ï¼Œæ¯”å¦‚ä¸€ä¸ªç»“æ„ä½“å£°æ˜ä¸º:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">struct&lt;/span> foo {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd">char&lt;/span> mem1;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd">int&lt;/span> mem2;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd">short&lt;/span> mem3;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸å¯èƒ½åŒæ—¶åšåˆ° foo å˜é‡å’Œå…¶æˆå‘˜ mem2 åŒæ—¶æ»¡è¶³å¯¹é½åˆ° 4 å­—èŠ‚ï¼Œæ‰€ä»¥&lt;strong>ç¼–è¯‘å™¨ä¼šä¾æ®
ä¸Šé¢çš„ä¸¤æ¡è¦æ±‚åœ¨æˆå‘˜ä¹‹é—´æ·»åŠ  padding&lt;/strong>ã€‚&lt;/p>
&lt;p>é™¤äº†å˜é‡ä¸­é—´æ·»åŠ  padding å¤–ï¼Œåœ¨æœ«å°¾ä¹Ÿä¼šæ·»åŠ ï¼Œ&lt;strong>ä½¿å¾—ç»“æ„ä½“æ•°ç»„å®¹æ˜“æ»¡è¶³å¯¹é½éœ€æ±‚&lt;/strong>ã€‚&lt;/p>
&lt;p>æœ€å foo å˜é‡åœ¨å†…å­˜ä¸­çš„æ ·å­å¯èƒ½æ˜¯:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">struct&lt;/span> foo {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd">char&lt;/span> mem1;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd">char&lt;/span> _pad1[&lt;span style="color:#bd93f9">3&lt;/span>]; &lt;span style="color:#6272a4">// ä¿è¯ç»“æ„ä½“å’Œæˆå‘˜å‡å¯¹é½æ­£ç¡®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span> &lt;span style="color:#8be9fd">int&lt;/span> mem2;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd">short&lt;/span> mem3;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd">char&lt;/span> _pad2[&lt;span style="color:#bd93f9">2&lt;/span>]; &lt;span style="color:#6272a4">// ä¿è¯ã€ç»“æ„ä½“æ•°ç»„ã€‘å¯¹é½æ­£ç¡®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>è‹¥ç»“æ„ä½“çš„æˆå‘˜è¿˜æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼ŒåµŒå¥—æ“ä½œå°±å¯ä»¥äº†ï¼Œç¼–è¯‘å™¨å¯ä»¥ handleã€‚&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>å¯¹äºç»“æ„ä½“çš„å®šä¹‰æ¥è¯´ï¼Œè‹¥ä¸æƒ³æ·»åŠ  paddingï¼Œå¯ä»¥ä½¿ç”¨&lt;code>__attribute((packed))&lt;/code>
æ¥å£°æ˜ã€‚ å¸¸ç”¨äºä¸€äº›æ•°æ®åŒ…çš„å£°æ˜ï¼Œé™¤éä½ æ¸…æ¥šè‡ªå·±ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Œè¦ä¸åˆ«ç”¨ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="å¦‚ä½•åšåˆ°å†…å­˜å¯¹é½">å¦‚ä½•åšåˆ°å†…å­˜å¯¹é½&lt;/h2>
&lt;p>ä¸Šé¢ä¸€èŠ‚è¯´æ˜äº†å„ä¸ªç±»å‹çš„å˜é‡å¯¹äºå†…å­˜å¯¹é½çš„éœ€æ±‚ï¼Œåªè¦æ˜¯å„ä¸ªç±»å‹å˜é‡çš„åœ°å€æ»¡è¶³è¦æ±‚äº†ï¼Œ
å¯¹æ‰€æœ‰å˜é‡çš„è®¿é—®ä¹Ÿå°± OK äº†ã€‚é‚£ä¹ˆ&lt;em>å¦‚ä½•ä¿è¯æ¯ä¸ªå˜é‡åœ°å€éƒ½æ»¡è¶³éœ€æ±‚å‘¢ï¼Ÿ&lt;/em>&lt;/p>
&lt;p>å¯¹äºé™æ€åˆ†é…çš„å˜é‡ï¼Œå³åœ¨ç¼–è¯‘é“¾æ¥æ—¶æœŸå°±èƒ½ç¡®å®šåœ°å€ï¼Œç”±ç¼–è¯‘å™¨å®Œæˆè¿™é¡¹å·¥ä½œã€‚ç¼–è¯‘å™¨ä¿è¯
åˆ†é…ç»™è¿™äº›å˜é‡çš„åœ°å€æ˜¯æ»¡è¶³å¯¹é½è¦æ±‚çš„ï¼Œè¿™ä¸ªå®Œå…¨ä¸ç”¨æ‹…å¿ƒã€‚&lt;/p>
&lt;p>å¯¹äºè¿è¡Œæ—¶åŠ¨æ€åˆ†é…çš„å˜é‡ï¼Œä¾‹å¦‚&lt;code>malloc()&lt;/code>æ¥å£è¿”å›çš„ï¼Œå…¶å® malloc æœ¬èº«ä¸çŸ¥é“è¦ç”³è¯·
ç©ºé—´çš„å¯¹é½è§„åˆ™ï¼Œå› ä¸ºå®ƒåªæ¥å—ä¸€ä¸ª size ä½œä¸ºå‚æ•°ã€‚ æ‰€ä»¥ä¸€èˆ¬æ¥è¯´ï¼Œä¸ºäº†ä¿è¯æ»¡è¶³æ‰€æœ‰çš„
å¯¹é½è¦æ±‚ï¼Œ&lt;code>malloc()&lt;/code> è¿”å›çš„åœ°å€&lt;strong>æ€»æ˜¯æ»¡è¶³æœ€å¤§çš„å¯¹é½è¯·æ±‚ï¼Œå³æŒ‡é’ˆçš„å¤§å° 8 å­—èŠ‚ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>&lt;code>malloc()&lt;/code> çš„å®é™…æ•ˆæœä¸è¿è¡Œåº“çš„å®ç°æœ‰å…³ï¼Œå¹¶ä¸æ˜¯è§„å®šæ­»çš„ã€‚ä¸è¿‡æˆ‘è¿˜æ²¡æœ‰è§è¿‡ä¸æ˜¯
æŒ‰ç…§æœ€å¤§å¯¹é½è¦æ±‚åˆ†é…çš„å®ç°æ–¹æ³•:)&lt;/p>
&lt;/blockquote>
&lt;h2 id="aarch64-å¯¹éå¯¹é½è®¿é—®çš„æ”¯æŒ">AArch64 å¯¹éå¯¹é½è®¿é—®çš„æ”¯æŒ&lt;/h2>
&lt;p>éå¯¹é½è®¿é—®çš„ç»“æœæ˜¯&lt;strong>æ¶æ„å®šä¹‰çš„&lt;/strong>ï¼Œ ä¸åŒçš„æ¶æ„å¯èƒ½é€ æˆçš„ç»“æœä¸åŒï¼š&lt;/p>
&lt;ul>
&lt;li>æ¶æ„å¯èƒ½æ”¯æŒéå¯¹é½è®¿é—®ï¼ŒæˆåŠŸè¯»å–æ•°æ®&lt;/li>
&lt;li>æ¶æ„ä¸æ”¯æŒéå¯¹é½è®¿é—®ï¼Œäº§ç”Ÿå¼‚å¸¸&lt;/li>
&lt;/ul>
&lt;p>AArch64 æ¶æ„æ”¯æŒ 16ã€32ã€64 å’Œ 128 ä½çš„éå¯¹é½è®¿é—®ï¼Œä½†æ˜¯æœ‰å‡ ä¸ªå‰ææ¡ä»¶:&lt;/p>
&lt;ul>
&lt;li>å…³é—­ç³»ç»Ÿçš„å¯¹é½æ£€æŸ¥: &lt;code>SCTLR_ELx.A&lt;/code> bit æ¥æ§åˆ¶&lt;/li>
&lt;li>exclusive load/store å’Œ load-acuqire/store-release ä¸¤ç±»æŒ‡ä»¤å¿…é¡»æ˜¯å¯¹é½è®¿é—®çš„
ã€‚è¿™å°±è¡¨ç¤ºæ„å»ºä¿¡å·é‡å’Œå…¶ä»–é”æœºåˆ¶æ—¶å¿…é¡»æ˜¯å¯¹é½è®¿é—®çš„&lt;/li>
&lt;li>éå¯¹é½è®¿é—®ä»…â€œæ™®é€šå†…å­˜â€å¯ç”¨ï¼Œ&amp;quot;&lt;strong>Device memory&lt;/strong>&amp;ldquo;å¿…é¡»æ˜¯å¯¹é½è®¿é—®çš„&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>AArch64 éå¯¹é½è®¿é—®çš„åŸç†æ˜¯&lt;strong>åˆ†è§£ä¸ºå¤šæ¬¡çš„è®¿å­˜&lt;/strong>ï¼Œæ‰€ä»¥&lt;strong>ä¸èƒ½ä¿è¯åŸå­æ€§&lt;/strong>ï¼Œä¸”æ€§èƒ½æ˜¯è¾ƒå·®çš„ã€‚&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>è™½ç„¶ AArch64 æ”¯æŒéå¯¹é½è®¿é—®ï¼Œ ä½†ç¼–è¯‘å™¨é»˜è®¤è¿˜æ˜¯ä¼šç”Ÿæˆæ»¡è¶³å¯¹é½è¦æ±‚çš„ä»£ç ã€‚&lt;/p>
&lt;/blockquote>
- https://wangloo.github.io/posts/c/alignment/ - @2019 Notepadium.</description></item><item><title>AArch64 å†…å­˜å±æ€§ä¸å†…å­˜ç±»å‹</title><link>https://wangloo.github.io/posts/armv8/memory_attr/</link><pubDate>Wed, 12 Apr 2023 08:01:33 +0800</pubDate><guid>https://wangloo.github.io/posts/armv8/memory_attr/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/armv8/memory_attr/ -&lt;p>æœ‰äº†è™šæ‹Ÿå†…å­˜ç³»ç»Ÿä¹‹åï¼ŒMMU å¯ä»¥æŠ½è±¡å‡ºä¸€äº›å¯é…ç½®çš„å†…å­˜å±æ€§ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œé…ç½®æŸä¸ªè™šæ‹Ÿå†…å­˜åŒºåŸŸä¸ºä¸å¯æ‰§è¡Œã€ä¸è¢« cache ç­‰ï¼Œä¸å¯æ‰§è¡Œçš„å±æ€§
æœ‰åŠ©äºé˜²èŒƒæ”»å‡»ï¼Œä¸è¿›å…¥ cache ç»å¸¸åˆ’åˆ†ç»™ å¤–è®¾ Memory-mapped åŒºåŸŸã€‚&lt;/p>
&lt;h2 id="è®¾ç½®å†…å­˜å±æ€§">è®¾ç½®å†…å­˜å±æ€§&lt;/h2>
&lt;blockquote>
&lt;p>ç›¸å…³å†…å®¹å¯ä»¥åœ¨ ARMv8 arm æ‰‹å†Œ D5.3.3 Attuibute fields in stage 1
VMSAv8-64 Block and Page descriptors ä¸­æ‰¾åˆ°å‚è€ƒ&lt;/p>
&lt;/blockquote>
&lt;p>å¯¹äºæ¯ä¸€ä¸ªè¡¨ç¤ºå†…å­˜å—(block)çš„é¡µè¡¨é¡¹ï¼Œéƒ½æœ‰ä¸¤ä¸ªå±æ€§å­—æ®µ: &lt;strong>lower attr å’Œ upper attr&lt;/strong>.&lt;/p>
&lt;p>ä»¥ä¸‹ä»»ä½•ç±»å‹æˆ–è€…å±æ€§çš„è®¾ç½®éƒ½æ˜¯é€šè¿‡è¿™ä¸¤ä¸ªå­—æ®µå®Œæˆçš„ã€‚&lt;/p>
&lt;h2 id="å¤§ç±»-å†…å­˜ç±»å‹">å¤§ç±»: å†…å­˜ç±»å‹&lt;/h2>
&lt;p>AArch64 æä¾›ä¸¤ç§å†…å­˜ç±»å‹: æ™®é€šå†…å­˜å’Œè®¾å¤‡å†…å­˜ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æ™®é€šå†…å­˜ä¼šå¯ç”¨æ¶æ„æä¾›çš„æ‰€æœ‰ä¼˜åŒ–æŠ€æœ¯ï¼Œä¾‹å¦‚åˆå¹¶è®¿å­˜ã€ä¹±åºæ‰§è¡Œç­‰ã€‚æ‰€ä»¥
æ™®é€šå†…å­˜æœ‰æœ€é«˜çš„æ€§èƒ½ï¼Œä½†åŒæ—¶ä¸æ˜¯é‚£ä¹ˆçš„â€œå®‰å…¨â€ï¼Œéœ€è¦åº•å±‚äººå‘˜æ‰‹åŠ¨ä½¿ç”¨
&lt;strong>å†…å­˜å±éšœ&lt;/strong>ç­‰æ‰‹æ®µä¿è¯æŸäº›æƒ…å†µä¸‹çš„é¡ºåºæ€§è¦æ±‚ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è®¾å¤‡å†…å­˜ï¼Œé¡¾åæ€ä¹‰ï¼Œå¸¸æ˜ å°„åˆ°å¤–è®¾çš„ Memory-mapped åŒºåŸŸã€‚å¯¹äºè®¾å¤‡æ¥è¯´ï¼Œ
é‚£äº›æé«˜æ€§èƒ½çš„æŠ€æœ¯ä¼šé€ æˆä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚æŸäº›å¯„å­˜å™¨çš„é…ç½®å¿…é¡»æŒ‰ç…§é¡ºåºï¼Œ
è¿™æ—¶å°±ä¸èƒ½ä½¿ç”¨ä¹±åºæ‰§è¡Œã€‚è®¾å¤‡å†…å­˜å°±ç‰ºç‰²äº†æ€§èƒ½ï¼Œä¼˜å…ˆä¿è¯æ­£ç¡®æ€§ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>é…ç½®å†…å­˜ç±»å‹ä¹Ÿæ˜¯é€šè¿‡é¡µè¡¨é¡¹ä¸­çš„å…¶ä¸­ä¸€ä¸ªå±æ€§å­—æ®µ: &lt;code>AttrIndx[2:0]&lt;/code>,
å®ƒä¸ç³»ç»Ÿå¯„å­˜å™¨&lt;code>MAIR_EL1&lt;/code>é…åˆå®ç°ã€‚&lt;/p>
&lt;p>å…·ä½“è¡¨ç°ä¸º: &lt;code>mair_el1&lt;/code>å¯„å­˜å™¨è¢«åˆ’åˆ†ä¸º 8 ä¸ªå­—æ®µï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªå­—æ®µå†™å…¥
ä¸åŒçš„å€¼å¯ä»£è¡¨ä¸åŒçš„å†…å­˜ç±»å‹å’Œä¸€äº›é…å¥—å±æ€§ï¼Œå…·ä½“çš„çœŸå€¼è¡¨å¯ä»¥å‚è§
&lt;code>mair_el1&lt;/code>å¯„å­˜å™¨çš„æè¿°ã€‚&lt;/p>
&lt;blockquote>
&lt;p>&lt;code>mair_el1&lt;/code>ä¸­å†…å­˜ç±»å‹é…å¥—å±æ€§åªæ˜¯å±æ€§çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯å’Œè®¾å¤‡ç±»å‹ç»‘å®šçš„
é‚£éƒ¨åˆ†ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="æ›´ç»†åˆ†çš„æè¿°1-cacheable">æ›´ç»†åˆ†çš„æè¿°(1): cacheable&lt;/h2>
&lt;p>å†…å­˜æ”¯æŒé…ç½®ä¸ºæ˜¯å¦è¢« cacheï¼Œè¿™åœ¨&lt;code>mair_el1&lt;/code>çš„å­—æ®µä¸­é…ç½®ã€‚&lt;/p>
&lt;p>è¦æ³¨æ„ï¼Œ&lt;strong>åªæœ‰æ™®é€šå†…å­˜æ‰æ”¯æŒé…ç½®æ˜¯å¦è¿›å…¥ cacheï¼Œæ‰€æœ‰çš„è®¾å¤‡å†…å­˜
éƒ½æ˜¯ non-cacheable çš„&lt;/strong>ã€‚&lt;/p>
&lt;h2 id="æ›´ç»†åˆ†çš„æè¿°2-shareable">æ›´ç»†åˆ†çš„æè¿°(2): shareable&lt;/h2>
&lt;p>shareable è¯´çš„æ˜¯ä¸€å—å†…å­˜çš„å¤–éƒ¨å¯è§æ€§ï¼Œä¹Ÿå¯åˆ†ä¸º inner/outer
shareable.&lt;/p>
&lt;p>shareable çš„è®¾ç½®éœ€è¦å‚è€ƒæ­¤å†…å­˜çš„ cacheable å±æ€§:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å¦‚æœä¸€å—å†…å­˜æ˜¯ cacheable çš„ï¼Œåˆ™éœ€è¦ç¡¬ä»¶æä¾› cache çš„ä¸€è‡´æ€§ç»´æŠ¤æœºåˆ¶ã€‚
å¦‚æœä¸èƒ½ä¿è¯ cache çš„ä¸€è‡´æ€§ï¼Œæƒ³è¦å¯ç”¨ shareable å°±å¿…é¡»æ˜¯ non-cacheable&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯¹äº non-cacheable çš„å†…å­˜ï¼Œä¸€å®šæ˜¯ shareable çš„ï¼Œ
ä¸éœ€è¦é…ç½®ã€‚å› ä¸ºæ­¤æ—¶å¯¹æ•°æ®çš„ä¿®æ”¹ç›´æ¥æ“ä½œå†…å­˜ï¼Œè¯»å–æ“ä½œäº¦æ˜¯å¦‚æ­¤ï¼Œä¸€å®š
æ˜¯å¤–éƒ¨å¯è§çš„&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="æ›´ç»†åˆ†çš„æè¿°x-">æ›´ç»†åˆ†çš„æè¿°(x): &amp;hellip;&lt;/h2>
&lt;p>TODO&lt;/p>
- https://wangloo.github.io/posts/armv8/memory_attr/ - @2019 Notepadium.</description></item><item><title>Cè¯­è¨€è‡ªèº«çš„éš¾ç‚¹</title><link>https://wangloo.github.io/posts/c/puzzle/</link><pubDate>Thu, 09 Mar 2023 17:18:57 +0800</pubDate><guid>https://wangloo.github.io/posts/c/puzzle/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/c/puzzle/ -&lt;h1 id="å‡½æ•°æŒ‡é’ˆ">å‡½æ•°æŒ‡é’ˆ&lt;/h1>
&lt;h2 id="æŒ‡é’ˆçš„æ•°ç»„-or-æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ">æŒ‡é’ˆçš„æ•°ç»„ or æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ?&lt;/h2>
&lt;pre tabindex="0">&lt;code>&amp;gt;&amp;gt; int (*p)[10] pæ˜¯æŒ‡é’ˆ, æŒ‡å‘é•¿åº¦ä¸º10çš„æ•°ç»„. åŠ æ‹¬å·æ˜¯ä¸ºäº†å¼ºè°ƒpæ˜¯ä¸€ä¸ªæŒ‡é’ˆ, åŒºåˆ«åŒ…å«10ä¸ªæŒ‡é’ˆçš„array.
&amp;gt;&amp;gt; int *(p[10]) pæ˜¯æ•°ç»„, å®ƒçš„å…ƒç´ ç±»å‹æ˜¯int *, åŠ æ‹¬å·æ˜¯ä¸ºäº†å¼ºè°ƒpæ˜¯æ•°ç»„.
&amp;gt;&amp;gt; int *p[10] ç­‰æ•ˆäºint *(p[10])
&lt;/code>&lt;/pre>&lt;h2 id="åŸºç¡€æ¶æ„">åŸºç¡€æ¶æ„&lt;/h2>
&lt;pre tabindex="0">&lt;code>// å‡½æ•°æŒ‡é’ˆ
&amp;gt;&amp;gt; int (*f)(int) è¯´æ˜fæ˜¯ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ, åŠ æ‹¬å·ä¸ºäº†åŒºåˆ«è¿”å›å€¼ä¸ºint*çš„å‡½æ•°
&amp;gt;&amp;gt; f = function; å‡½æ•°æŒ‡é’ˆçš„èµ‹å€¼
&amp;gt;&amp;gt; (*f)(x) å‡½æ•°æŒ‡é’ˆæŒ‡å‘å‡½æ•°çš„è°ƒç”¨, å¯ç®€åŒ–ä¸ºf(x). ä½†æ˜¯å®¹æ˜“å°†fè¯¯è®¤ä¸ºæ˜¯å‡½æ•°.
// å‡½æ•°æŒ‡é’ˆçš„æ•°ç»„
&amp;gt;&amp;gt; int (*(f[10])) (int) fæ˜¯æ•°ç»„,å…ƒç´ ä¸º10ä¸ªå‡½æ•°æŒ‡é’ˆ. å†…å±‚æ‹¬å·è¯´æ˜fæ˜¯æ•°ç»„,å¤–å±‚æ‹¬å·è¯´æ˜å…ƒç´ ç±»å‹æ˜¯å‡½æ•°æŒ‡é’ˆ
&amp;gt;&amp;gt; int (*f[10]) (int) ä¸ä¸Šé¢ç­‰æ•ˆ. ä½†å¤–å±‚æ‹¬å·ä¸èƒ½çœç•¥
&amp;gt;&amp;gt; f[0] = function() èµ‹å€¼
&amp;gt;&amp;gt; (*f[0])() æŒ‡å‘å‡½æ•°çš„è°ƒç”¨, å¯ç®€åŒ–ä¸ºf[0]()
// è¿”å›å‡½æ•°æŒ‡é’ˆçš„å‡½æ•°
&amp;gt;&amp;gt; void (*signal(int sig, ...))(int); signalæ˜¯ä¸€ä¸ªå‡½æ•°, å‚æ•°æœ‰sig.... å®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ, æŒ‡å‘ä»»æ„è¿”å›å€¼ä¸ºvoid, å‚æ•°ä¸ºintçš„å‡½æ•°.
&lt;/code>&lt;/pre>&lt;h2 id="typedefå¸®åŠ©ç†è§£å‡½æ•°æŒ‡é’ˆ">&lt;code>typedef&lt;/code>å¸®åŠ©ç†è§£å‡½æ•°æŒ‡é’ˆ&lt;/h2>
&lt;p>&lt;code>signal()&lt;/code>æ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨, ç”¨äºå‘Šè¯‰ç³»ç»Ÿ, å½“æŸç§ç‰¹å®š&amp;quot;è½¯ä»¶ä¸­æ–­&amp;quot;å‘ç”Ÿæ—¶è°ƒç”¨&lt;em>ç‰¹å®šçš„ç¨‹åº&lt;/em>. å®ƒçš„çœŸæ­£åç§°åº”å½“æ˜¯: &lt;em>Call that routine when the interrupt comes in&lt;/em>.&lt;/p>
&lt;p>çœ‹&lt;code>signal()&lt;/code>çš„åŸå‹, éå¸¸å¤æ‚. æ ¹æ®ä¸Šé¢åŸºç¡€æ¶æ„çš„é“ºå«, å¯ä»¥çœ‹å‡º&lt;code>signal()&lt;/code>çš„è¿”å›å€¼æ˜¯å‡½æ•°æŒ‡é’ˆ, åŒæ—¶å®ƒçš„å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ. ä¸”è¿™ä¸¤ä¸ªå‡½æ•°æŒ‡é’ˆæ‰€æŒ‡å‘å‡½æ•°çš„è¿”å›å€¼å’Œå‚æ•°ç›¸åŒ.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd">void&lt;/span> (&lt;span style="color:#ff79c6">*&lt;/span>signal(&lt;span style="color:#8be9fd">int&lt;/span> sig, &lt;span style="color:#8be9fd">void&lt;/span>(&lt;span style="color:#ff79c6">*&lt;/span>func)(&lt;span style="color:#8be9fd">int&lt;/span>)))(&lt;span style="color:#8be9fd">int&lt;/span>);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥å€Ÿç”¨&lt;code>typedef&lt;/code>è¡¨ç¤ºé€šç”¨éƒ¨åˆ†.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">typedef&lt;/span> &lt;span style="color:#50fa7b">void&lt;/span> (&lt;span style="color:#ff79c6">*&lt;/span>sighandler_t)(&lt;span style="color:#8be9fd">int&lt;/span>);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€Œå&lt;code>signal&lt;/code>çš„å£°æ˜å°±æ˜¯äººèƒ½çœ‹æ‡‚çš„äº†:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>sighandler_t &lt;span style="color:#50fa7b">signal&lt;/span>(&lt;span style="color:#8be9fd">int&lt;/span> signum, sighandler_t handler);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>- https://wangloo.github.io/posts/c/puzzle/ - @2019 Notepadium.</description></item><item><title>Cè¯­è¨€ç¨‹åºè®¾è®¡çš„ä¸€äº›ç»éªŒ</title><link>https://wangloo.github.io/posts/c/experience/</link><pubDate>Mon, 27 Feb 2023 19:20:20 +0800</pubDate><guid>https://wangloo.github.io/posts/c/experience/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/c/experience/ -&lt;h2 id="å¤´æ–‡ä»¶çš„å¼•ç”¨å½¢å¼">å¤´æ–‡ä»¶çš„å¼•ç”¨å½¢å¼&lt;/h2>
&lt;p>C ä¸­å¼•ç”¨ä¸€ä¸ªå¤´æ–‡ä»¶æœ‰ä¸¤ç§å½¢å¼ &lt;code>#include &amp;lt;&amp;gt;&lt;/code>å’Œ&lt;code>#include &amp;quot;&amp;quot;&lt;/code>ï¼Œåœ¨åº”ç”¨å¼€å‘ä¸­ï¼Œéœ€è¦å¼•ç”¨ä¸€äº›ç³»ç»Ÿåº“æ–‡ä»¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨&lt;code>&amp;lt;&amp;gt;&lt;/code>ï¼Œå¯¹äºè‡ªå·±å®šä¹‰çš„å¤´æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨&lt;code>&amp;quot;&amp;quot;&lt;/code>ã€‚&lt;/p>
&lt;p>ç„¶è€Œå¯¹äºåº•å±‚è½¯ä»¶çš„å¼€å‘ï¼Œæ¯”å¦‚è¯´æ“ä½œç³»ç»Ÿï¼Œç”¨åˆ°çš„åº“éƒ½æ˜¯è‡ªå·±å·¥ç¨‹ä¸­çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆæ­¤æ—¶ç”¨&lt;code>&amp;quot;&amp;quot;&lt;/code>å’Œ&lt;code>&amp;lt;&amp;gt;&lt;/code>æœ‰æ—¶éƒ½èƒ½ workï¼Œé‚£ä¹ˆå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p>
&lt;p>æœç´¢ç›¸å…³å…³é”®è¯å¾—åˆ°çš„ç»“è®ºæ˜¯: ä¸¤ç§æ–¹å¼çš„åŒºåˆ«æ˜¯&lt;strong>æœç´¢æ–‡ä»¶çš„ä¼˜å…ˆçº§ï¼Œ &lt;code>&amp;quot;&amp;quot;&lt;/code>ä¼˜å…ˆæœç´¢çš„å½“å‰ç›®å½•ï¼Œè€Œ&lt;code>&amp;lt;&amp;gt;&lt;/code>ä¼˜å…ˆæœç´¢ç³»ç»Ÿåº“æ–‡ä»¶ç›®å½•&lt;/strong>ã€‚å¯¹äºè¿™ä¸ªç³»ç»Ÿåº“ï¼Œå³é‚£äº›ä½¿ç”¨&lt;code>gcc -I&amp;lt;dir&amp;gt;&lt;/code>å‚æ•°æŒ‡å®šçš„è·¯å¾„ã€‚
å½“ç„¶ï¼Œå¦‚æœç¬¬ä¸€ä¼˜å…ˆçº§ä½ç½®æ²¡æœ‰è¢«æ‰¾åˆ°ï¼Œä¹Ÿä¼šåˆ°å¦ä¸€ä¸ªç›®å½•ä¸­æœç´¢ã€‚è¿™ä¹ˆä¸¤ç§æ–¹å¼å‡å¯ï¼Œå®é™…å·¥ç¨‹ä¸­ä¹Ÿæœ‰éƒ¨åˆ†äººæ··åˆä½¿ç”¨ï¼Œæ¯«ä¸åœ¨æ„è§„åˆ™ã€‚ä½†æ˜¯æœ‰æ—¶ä¼šå¯¼è‡´ä¸€äº›ç»†èŠ‚é—®é¢˜ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°&lt;code>-MMD&lt;/code>æˆ–è€…ç±»ä¼¼é€‰é¡¹ç”Ÿæˆç›®æ ‡æ–‡ä»¶çš„ä¾èµ–ï¼Œæ–¹ä¾¿å®ç°å¢é‡ç¼–è¯‘ã€‚æ­¤æ—¶å°±å¯èƒ½ä¼šäº§ç”Ÿä¸€äº›é—®é¢˜ã€‚&lt;/p>
&lt;p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå¤´æ–‡ä»¶&lt;code>inc/father.h&lt;/code>, å®ƒé‡Œé¢ä¼šå¼•ç”¨&lt;code>inc/child.h&lt;/code>, å¯¹äº&lt;strong>æ ¹ç›®å½•ä¸‹&lt;/strong>çš„æºæ–‡ä»¶&lt;code>main.c&lt;/code>ï¼Œå…¶å¼•ç”¨è¯­å¥è¯¥å¦‚ä½•å†™å‘¢ï¼Ÿä»¥ä¸‹åˆ—å‡ºçš„å‡ ç§å½¢å¼éƒ½å¯ä»¥ï¼Œä»»æ„çš„æ’åˆ—ç»„åˆ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">// ç¼–è¯‘å‚æ•°: -I. -MMD
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">// main.c
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#ff79c6">#include&lt;/span> &lt;span style="color:#ff79c6">&amp;#34;inc/father.h&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">#include&lt;/span> &lt;span style="color:#ff79c6">&amp;lt;inc/father.h&amp;gt;&lt;/span>&lt;span style="color:#ff79c6">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">// father.h
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#ff79c6">#include&lt;/span> &lt;span style="color:#ff79c6">&amp;#34;inc/child.h&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">#include&lt;/span> &lt;span style="color:#ff79c6">&amp;lt;inc/child.h&amp;gt;&lt;/span>&lt;span style="color:#ff79c6">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">#include&lt;/span> &lt;span style="color:#ff79c6">&amp;#34;child.h&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">#include&lt;/span> &lt;span style="color:#ff79c6">&amp;lt;child.h&amp;gt;&lt;/span>&lt;span style="color:#ff79c6">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>å¦‚æœ main.c æ˜¯ä½¿ç”¨ç³»ç»Ÿåº“è·¯å¾„(&lt;code>-I.&lt;/code>)æ¥æ‰¾åˆ°çš„ father.h, å³ä¸Šé¢ main.c çš„ç¬¬ 2 ç§æƒ…å†µï¼Œé‚£ä¹ˆå…¶ç”Ÿæˆä¾èµ–æ–‡ä»¶çš„å½¢å¼å†…å®¹éƒ½æ˜¯&lt;strong>ç»å¯¹è·¯å¾„&lt;/strong>ï¼ŒåŒ…æ‹¬ father.h ä¸­çš„å¼•ç”¨ï¼ˆå› ä¸ºå³ä¾¿ child.h æ˜¯ç›¸å¯¹è·¯å¾„æ‰¾åˆ°çš„ï¼Œç›¸å¯¹çš„ä¹Ÿæ˜¯ father.hï¼Œå…¶åŸºå‡†å°±æ˜¯ç»å¯¹è·¯å¾„ï¼‰ã€‚ä¾‹å¦‚:&lt;code>main.o: main.c /home/xx/father.h /home/xx/child.h&lt;/code>&lt;/li>
&lt;li>å¦åˆ™å³ä»¥ç›¸å¯¹è·¯å¾„æ‰¾åˆ° father.h,å³ä¸Šè¯´ main.c çš„ç¬¬ 1 ç§ï¼Œé‚£ä¹ˆç”Ÿæˆ father.h ä¾èµ–çš„æ–¹å¼&lt;strong>ä¸€å®šæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä½† child.h çš„å½¢å¼å´å–å†³äºå…¶æœ¬èº«&lt;/strong>.
&lt;ul>
&lt;li>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ child.h çš„å¯»æ‰¾æ–¹å¼æ˜¯ç»å¯¹çš„ï¼ˆä¸Šé¢çš„ç¬¬ 1,2,4 ç§ï¼‰ï¼Œé‚£ä¹ˆä¾èµ–æ–‡ä»¶çš„å½¢å¼å°±æ˜¯&lt;code>main.o: main.c inc/father.h /home/xx/child.h&lt;/code>.&lt;/li>
&lt;li>å¦‚æœ child.h çš„å¯»æ‰¾æ–¹å¼æ˜¯ç›¸å¯¹çš„(ä¸Šé¢çš„ç¬¬ 3 ç§)ï¼Œé‚£ä¹ˆä¾èµ–æ–‡ä»¶çš„å½¢å¼æ˜¯&lt;code>main.o: main.c inc/father.h inc/child.h&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ä¾èµ–æ–‡ä»¶çš„å½¢å¼å¾ˆé‡è¦ï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯å‡ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œæ­¤æ—¶ä¸éœ€è¦è€ƒè™‘ä¾èµ–æ–‡ä»¶åœ¨ makefile ä¸­ include çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ä¸éœ€è¦è€ƒè™‘ make çš„â€œå½“å‰è·¯å¾„â€ã€‚å¦‚æœéå¾—ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œé‚£ä¹ˆå·²ç»è¦ç¡®å®šèƒ½å¤Ÿ makefile ä¸­ include æ—¶çš„ make å½“å‰è·¯å¾„å°±æ˜¯ç”Ÿæˆä¾èµ–æ–‡ä»¶çš„è·¯å¾„ï¼Œå¦åˆ™ä¸èƒ½å»ºç«‹æ­£ç¡®çš„ä¾èµ–å…³ç³»ã€‚&lt;/p>
&lt;p>å®é™…ä¸Šï¼Œåœ¨â€œåŸºç¡€æ¶æ„â€ä¼˜ç§€çš„é¡¹ç›®ä¸­ï¼Œä¸å¯èƒ½å‡ºç°æˆ–è€…å°½é‡é¿å…å‡ºæ¥ä¸¤ç§å½¢å¼éƒ½èƒ½æ‰¾åˆ°å¤´æ–‡ä»¶çš„æƒ…å†µã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬ä¼šå°†æºæ–‡ä»¶ç»Ÿä¸€æ”¾åœ¨å­ç›®å½•&lt;code>src/&lt;/code>ä¸‹ä¸å¤´æ–‡ä»¶éš”ç¦»ï¼Œè¿™æ ·å°±ä»æ ¹æœ¬ä¸Šé¿å…äº†ç›¸å¯¹ä¾èµ–çš„ç”Ÿæˆï¼Œåªèƒ½é€šè¿‡ç³»ç»Ÿåº“çš„å½¢å¼æ¥æ‰¾å¤´æ–‡ä»¶ã€‚æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œæ­£ç¡®çš„æ–¹å¼æ˜¯ï¼šmain.c æ”¾å…¥ src/ä¸­ï¼Œç„¶åä¸ç®¡æ˜¯æºæ–‡ä»¶è¿˜æ˜¯å¤´æ–‡ä»¶ï¼Œéƒ½ç»Ÿä¸€ä½¿ç”¨&lt;code>#include &amp;quot;inc/xxx&amp;quot;&lt;/code>ã€‚è¿™æ ·åš&lt;strong>å³ç»Ÿä¸€ï¼Œä¹Ÿèƒ½ä¿è¯æ‰€æœ‰çš„ä¾èµ–éƒ½æ˜¯ç»å¯¹è·¯å¾„å½¢å¼&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å¦å¤–è¯´ä¸€ç‚¹ï¼Œå…¶å®ä¾èµ–æ–‡ä»¶(.d)ä¸­æºæ–‡ä»¶çš„ä¾èµ–é¡¹å½¢å¼ä¹Ÿæ˜¯éœ€è¦è€ƒè™‘çš„ï¼Œè¿™ä¸èƒ½é€šè¿‡ç³»ç»Ÿæ¶æ„æ¥è§£å†³ï¼Œåªèƒ½ç”¨ Makefile çš„æŠ€å·§æ¥å®ç°ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬çš„ make å½“å‰ç›®å½•æ€»æ˜¯æ ¹ç›®å½•ï¼Œè€Œåœ¨å»ºç«‹ OBJS å˜é‡æ—¶ä¸ºå…¶åŠ ä¸Šç»å¯¹è·¯å¾„çš„å‰ç¼€ï¼Œ ä»è€Œ make ä¸éœ€è¦è¿›å…¥å„çº§å­ç›®å½•ï¼Œç”Ÿæˆçš„ä¾èµ–æ–‡ä»¶ä¹Ÿéƒ½æ˜¯ç›¸å¯¹äºæ ¹ç›®å½•çš„ï¼Œinclude ä¾èµ–æ–‡ä»¶çš„è¡Œä¸ºä¹Ÿæ˜¯åœ¨æ ¹ç›®å½•è¿›è¡Œçš„ï¼Œä¿è¯ç»Ÿä¸€ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="å¤–éƒ¨åº“çš„ä½¿ç”¨æ–¹å¼">å¤–éƒ¨åº“çš„ä½¿ç”¨æ–¹å¼&lt;/h2>
&lt;p>æœ€è¿‘æˆ‘åœ¨å¼€å‘é¡¹ç›®æ˜¯, éœ€è¦ä½¿ç”¨åˆ° libelf åº“, æˆ‘åœ¨ Github ä¸Šæ‰¾åˆ°äº†å…¶æºä»£ç .&lt;/p>
&lt;p>æˆ‘ä¹‹å‰ä½¿ç”¨ä¸€ä¸ª lib éƒ½æ˜¯ä»¥é“¾æ¥çš„å½¢å¼ä½¿ç”¨åŠ¨æ€åº“/é™æ€åº“, ä½†æ˜¯æ—¢ç„¶å®ƒæä¾›äº†æºç , é‚£ä¹ˆæˆ‘å¯ä»¥ç›´æ¥å°†æºç æ‹·è´åˆ°æˆ‘çš„é¡¹ç›®ä¸­å—? ç­”æ¡ˆè‚¯å®šæ˜¯å¯ä»¥, é‚£ä¹ˆè¿™ä¸¤ç§æ–¹æ¡ˆè¯¥å¦‚ä½•æŠ‰æ‹©å‘¢?&lt;/p>
&lt;p>åœ¨æŸ¥é˜…äº†ä¸€äº›èµ„æ–™å, æˆ‘æ€»ç»“äº†ä»¥ä¸‹å‡ ä¸ªåˆ¤æ–­ä¾æ®:&lt;/p>
&lt;ol>
&lt;li>åº“çš„å¤§å°/å¯¹ç¼–è¯‘æ—¶é—´çš„æ•æ„Ÿåº¦; å¦‚æœä½¿ç”¨æºä»£ç , æ¯æ¬¡ç¼–è¯‘é¡¹ç›®æ—¶éœ€è¦é¢å¤–å¯¹åº“æ–‡ä»¶è¿›è¡Œç¼–è¯‘(èµ·ç æ˜¯ç¬¬ä¸€æ¬¡), è€Œåº“æ–‡ä»¶çš„å®šä¹‰æ˜¯ä¸å¸¸ä¿®æ”¹çš„, å¦‚æœåº“æ–‡ä»¶æ¯”è¾ƒå¤§, åˆ™ä¼šå»¶é•¿æ•´ä¸ªé¡¹ç›®çš„ç¼–è¯‘æ—¶é—´.&lt;/li>
&lt;li>æ˜¯å¦éœ€è¦ç‰ˆæœ¬æ§åˆ¶; è¦ä½¿ç”¨çš„åº“å¦‚æœéœ€è¦åŒºåˆ†ç‰ˆæœ¬, æˆ–è€…åˆ†é…ç»™å…¶ä»–çš„å›¢é˜Ÿæˆå‘˜ä½¿ç”¨, é‚£ä¹ˆç”¨åº“çš„å½¢å¼ä¼¼ä¹æ›´ä¸ºæ–¹ä¾¿&lt;/li>
&lt;li>å‘æŒ¥ git submodule çš„ä¼˜åŠ¿;&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>Ref: &lt;a href="https://softwareengineering.stackexchange.com/questions/313907/should-i-add-the-source-of-libraries-instead-of-linking-to-them">c++ - Should I add the source of libraries instead of linking to them? - Software Engineering Stack Exchange&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h2 id="const-ä¿®é¥°ç¬¦çš„å¦™ç”¨">&lt;code>const&lt;/code> ä¿®é¥°ç¬¦çš„å¦™ç”¨&lt;/h2>
&lt;p>æœ‰äº›æ—¶å€™, æˆ‘ä»¬è®¾è®¡çš„ç»“æ„ä½“ä¸­ä¼šæœ‰&lt;em>name&lt;/em>å­—æ®µ, ç±»å‹æ˜¯&lt;code>char *&lt;/code>. åœ¨ä½¿ç”¨æ—¶ä¸ºå®ƒåˆ†é…ç©ºé—´, ä¸ä½¿ç”¨æ—¶éœ€è¦å›æ”¶.&lt;/p>
&lt;p>å…¶å®è¿˜æœ‰å¦ä¸€ç§æƒ…å†µ, å°±æ˜¯&lt;em>name&lt;/em>è¦æŒ‡å‘é¢„å…ˆå®šä¹‰å¥½çš„&amp;quot;static name list&amp;quot;, é€‚ç”¨äº name çš„å–å€¼æ˜¯ç¡®å®šçš„èŒƒå›´. ä¾‹å¦‚, libdwarf åº“ä¸­çš„æè¿° section name çš„&lt;code>dss_name&lt;/code> æˆå‘˜.&lt;/p>
&lt;p>è¿™æ—¶, ä¸ºäº†é˜²æ­¢ä½¿ç”¨è€…è°ƒç”¨&lt;code>free()&lt;/code>æ¥é‡Šæ”¾å®ƒ, æˆ‘ä»¬å¯ä»¥å°†å…¶å£°æ˜ä¸º&lt;code>const char *&lt;/code>, æ­¤æ—¶å¦‚æœè°ƒç”¨&lt;code>free(.dss_name)&lt;/code>, ç¼–è¯‘å™¨ä¼šç»™å‡ºè­¦å‘Š:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>const.c:16:10: warning: passing argument &lt;span style="color:#bd93f9">1&lt;/span> of â€˜freeâ€™ discards â€˜constâ€™ qualifier from pointer target &lt;span style="color:#8be9fd;font-style:italic">type&lt;/span> &lt;span style="color:#ff79c6">[&lt;/span>-Wdiscarded-qualifiers&lt;span style="color:#ff79c6">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#bd93f9">16&lt;/span> | free&lt;span style="color:#ff79c6">(&lt;/span>dss_name&lt;span style="color:#ff79c6">)&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> | ^~~~~~~~
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>- https://wangloo.github.io/posts/c/experience/ - @2019 Notepadium.</description></item><item><title>è¡Œç»“æŸç¬¦åœ¨windowså’Œlinuxçš„åŒºåˆ«</title><link>https://wangloo.github.io/posts/c/end-of-line/</link><pubDate>Sat, 24 Dec 2022 01:35:24 +0800</pubDate><guid>https://wangloo.github.io/posts/c/end-of-line/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/c/end-of-line/ -&lt;p>ä½¿ç”¨VIM æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶, æœ‰æ—¶ä¼šçœ‹åˆ°ä¾‹å¦‚ &lt;code>^M&lt;/code> è¿™ç±»å­—ç¬¦å‡ºç°. ä¸‹é¢æˆ‘ä¼šæŒ–ä¸€ä¸‹å…¶å‡ºç°çš„åŸå› .&lt;/p>
&lt;h2 id="eol-å­—ç¬¦">EOL å­—ç¬¦&lt;/h2>
&lt;p>EOL æˆ–è€…è¯´ end-of-line è¡¨ç¤ºä¸€ä¸ªæ–°è¡Œçš„å¼€å§‹.&lt;/p>
&lt;p>EOL å­—ç¬¦åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸­æ˜¯ä¸åŒçš„. æœ¬æ–‡ä¸­ä»…ä»¥ Linux å’Œ Windows ä¸ºä¾‹è¯´æ˜.&lt;/p>
&lt;ul>
&lt;li>Windowsä¸­æ˜¯ä»¥è¯»åˆ°å›è½¦&amp;lt;CR&amp;gt;å’Œæ¢è¡Œ&amp;lt;LF&amp;gt; è¡¨ç¤º EOL.&lt;/li>
&lt;li>Linux ä¸­ä»…ä»¥æ¢è¡Œä½œä¸ºEOL&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>å›è½¦&amp;lt;CR&amp;gt; : Carriage return. å°†å…‰æ ‡å›åˆ°è¡Œé¦–, å¯¹åº”Cè¯­è¨€ä¸­çš„ &lt;code>\r&lt;/code>&lt;/li>
&lt;li>æ¢è¡Œ&amp;lt;LF&amp;gt; : Line feed. å°†å…‰æ ‡ä¸‹ç§»ä¸€è¡Œ, å¯¹åº”Cè¯­è¨€ä¸­çš„ &lt;code>\n&lt;/code>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>åœ¨ Linux ä¸­æ‰“å¼€ Windows ä¸‹çš„æ–‡ä»¶å°†å¤šä½™çš„å›è½¦é€šå¸¸æ˜¾ç¤ºæˆ &lt;code>^M&lt;/code> æˆ–è€… &lt;code>Control-M&lt;/code>&lt;/p>
&lt;h2 id="ref">Ref&lt;/h2>
&lt;p>&lt;a href="https://peterbenjamin.com/seminars/crossplatform/texteol.html">End Of Line Characters&lt;/a>&lt;/p>
- https://wangloo.github.io/posts/c/end-of-line/ - @2019 Notepadium.</description></item><item><title>æµ…è°ˆ errno çš„çº¿ç¨‹å®‰å…¨é—®é¢˜</title><link>https://wangloo.github.io/posts/os/errno_thread_safe/</link><pubDate>Wed, 21 Dec 2022 19:08:22 +0800</pubDate><guid>https://wangloo.github.io/posts/os/errno_thread_safe/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/os/errno_thread_safe/ -&lt;p>æˆ‘å§‹ç»ˆä»¥ä¸ºï¼ŒCåº“ä¸­å¸¸ç”¨çš„ &lt;code>errno&lt;/code> ä»…æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä½¿ç”¨äº†å…¨å±€å˜é‡å°±æ— æ³•ä¿è¯çº¿ç¨‹å®‰å…¨äº†ï¼Œå› ä¸ºå…¨å±€å˜é‡åœ¨æ‰€æœ‰çº¿ç¨‹ä¸­éƒ½æ˜¯å…±äº«çš„ã€‚&lt;/p>
&lt;p>è¦å®ç°çº¿ç¨‹å®‰å…¨çš„&lt;code>errno&lt;/code> å°±å¿…é¡»å°†å…¶è®¾ç½®ä¸º&lt;strong>çº¿ç¨‹ç§æœ‰çš„å˜é‡&lt;/strong>ï¼Œä¸‹é¢å°±æ¥çœ‹çœ‹GCCæ˜¯å¦‚ä½•å·§å¦™çš„å®ç°çš„ã€‚&lt;/p>
&lt;h2 id="æ­£æ–‡">æ­£æ–‡&lt;/h2>
&lt;p>ç°åœ¨çš„&lt;code>errno&lt;/code>å®šä¹‰å¹¶éä¸€ä¸ªå…¨å±€å˜é‡, è€Œæ˜¯ä¸€ä¸ª&lt;strong>å®å®šä¹‰&lt;/strong>, ä»¥ä¸‹æ˜¯åœ¨&lt;code>usr/include/errno&lt;/code>ä¸­çš„å£°æ˜:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">extern&lt;/span> &lt;span style="color:#8be9fd">int&lt;/span> &lt;span style="color:#ff79c6">*&lt;/span>&lt;span style="color:#50fa7b">__errno_location&lt;/span> (&lt;span style="color:#8be9fd">void&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6"># define errno (*__errno_location ())
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ç§æ–¹å¼ä¸‹å…¶å®ç°åŸç†å¤§æ¦‚æ˜¯: &lt;code>__errno_location&lt;/code> å‡½æ•°è¿”å›ä¸€ä¸ª&lt;code>int&lt;/code>æŒ‡é’ˆ, è€Œè¿™ä¸ªå‡½æ•°çš„å®ç°ä¸­, è¿”å›çš„å°±æ°å¥½æ˜¯&lt;strong>å®é™…çš„&lt;/strong>&lt;code>errno&lt;/code> å˜é‡(ä¸å®åŒå)çš„åœ°å€, æ‰€ä»¥å¯¹å…¶&lt;strong>è§£å¼•ç”¨&lt;/strong>å°±ç›¸å½“äºå¯¹å…¶å€¼è¿›è¡Œæ“ä½œ. æ‰€ä»¥, è¿™ç§å®šä¹‰è§„åˆ™ä¸‹, å·¦å€¼å’Œå³å€¼è¡¨è¾¾å¼å‡æˆç«‹.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>errno &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">10&lt;/span>; &lt;span style="color:#6272a4">// *__errno_location () = 10
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#8be9fd">int&lt;/span> x &lt;span style="color:#ff79c6">=&lt;/span> errno; &lt;span style="color:#6272a4">// x = *__errno_location ();
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>__errno_location&lt;/code> çš„å®ç°å°±è‡³å…³é‡è¦, å› ä¸ºå¦‚æœå…¶è¿”å›çš„å˜é‡åœ°å€ä¸åŒ…å«ä»»ä½•æŠ€å·§çš„è¯, å°±å’ŒåŸå…ˆç›´æ¥å®šä¹‰å…¨å±€å˜é‡çš„æ–¹å¼æ²¡å·®äº†, &lt;strong>è¯´åˆ°åº•èƒ½å¦å®ç°çº¿ç¨‹å®‰å…¨, è¿˜å¾—çœ‹å®é™…ä¿å­˜errnoçš„å˜é‡æ˜¯å¦ä¸ºçº¿ç¨‹ç‹¬æœ‰çš„&lt;/strong>. ç›®å‰è¿˜æ²¡æœ‰å‘æ˜åˆ°å…¶ç²¾é«“, åªæ˜¯å¥—å£³è€Œå·².&lt;/p>
&lt;p>ä»¥ä¸‹ç»™å‡º&lt;code>/csu/errno-loc.c&lt;/code>ä¸­&lt;code>__errno_location&lt;/code> çš„å®ç°, ä¸æˆ‘ä»¬é¢„æœŸä¸€è‡´, è¿”å›å˜é‡çš„åœ°å€. è€ŒåŒåå˜é‡&lt;code>errno&lt;/code>åˆ™å®šä¹‰åœ¨&lt;code>/csu/errno.c&lt;/code>ä¸­, &lt;strong>å†³å®šäº†èƒ½å¤Ÿå®ç°errnoçš„çº¿ç¨‹å®‰å…¨&lt;/strong>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd">int&lt;/span> &lt;span style="color:#ff79c6">*&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">__errno_location&lt;/span> (&lt;span style="color:#8be9fd">void&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">return&lt;/span> &lt;span style="color:#ff79c6">&amp;amp;&lt;/span>errno;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>__thread &lt;span style="color:#8be9fd">int&lt;/span> errno;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;ldquo;&lt;code>__thread&lt;/code>&amp;rdquo; æ˜¯GCCæä¾›çš„æ‰©å±•å‰ç¼€, è¡¨ç¤ºè¯¥å˜é‡å°†è¢«åº“å¤„ç†ä¸ºçº¿ç¨‹ç§æœ‰çš„, æ³¨æ„è¿™ä¸€æ­¥æ˜¯Cåº“å®Œæˆçš„, å¯¹ç¨‹åºå‘˜é€æ˜. ç›¸å…³çš„ç†è®ºå« &lt;em>Thread-local Storage&lt;/em>, AArch64 æ¶æ„å®ç°çš„åŸç†æ˜¯åˆ©ç”¨&lt;code>TPIDR_EL0&lt;/code> å¯„å­˜å™¨, å…¶ä»–æ¶æ„å¯ä»¥å‚è€ƒ&lt;a href="https://akkadia.org/drepper/tls.pdf">æ­¤PDF&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>â“ ä»¥ä¸Šæºæ–‡ä»¶ä¸­æœ‰æ³¨é‡Šä¸º &lt;em>non-threaded&lt;/em>ç‰ˆæœ¬çš„å®ç°, æ˜¯ä»£è¡¨ä»€ä¹ˆå«ä¹‰å‘¢?&lt;/p>
&lt;/blockquote>
&lt;p>â€‹&lt;/p>
&lt;p>è™½ç„¶æˆ‘æš‚æ—¶æ²¡æœ‰æŸ¥é˜…åˆ°errnoçš„å…¶ä»–çº¿ç¨‹å®‰å…¨çš„å®ç°åŸç†, ä½†èµ·ç GCCä¸‹è¯¥æ–¹å¼è¿™æ˜¯å¯è¡Œçš„. ä¾é çš„æ˜¯&amp;quot;&lt;code>__thread&lt;/code>&amp;ldquo;çš„æ”¯æŒ, &lt;strong>ä¸æ¢æˆå®å®šä¹‰çš„æ–¹å¼æ— å…³&lt;/strong>, ä¸æ’é™¤å¯èƒ½ä¸ºäº†è€ƒè™‘å…¼å®¹å…¶ä»–å®ç°æ–¹å¼çš„å¯èƒ½æ€§.&lt;/p>
&lt;h2 id="å‚è€ƒ">å‚è€ƒ&lt;/h2>
&lt;p>&lt;a href="https://stackoverflow.com/questions/18025995/how-is-thread-safe-errno-initialized-if-define-substitutes-errno-symbol">c - How is thread-safe errno initialized if #define substitutes errno symbol? - Stack Overflow&lt;/a>&lt;/p>
- https://wangloo.github.io/posts/os/errno_thread_safe/ - @2019 Notepadium.</description></item><item><title>git å®å…¸</title><link>https://wangloo.github.io/posts/git/</link><pubDate>Tue, 13 Dec 2022 17:39:42 +0800</pubDate><guid>https://wangloo.github.io/posts/git/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/git/ -&lt;h2 id="åˆå¹¶æ“ä½œ-git-merge">åˆå¹¶æ“ä½œ: git merge&lt;/h2>
&lt;p>merge æœ‰ä¸¤ç§æ–¹å¼:&lt;/p>
&lt;ul>
&lt;li>fast-forward&lt;/li>
&lt;li>three-way merger&lt;/li>
&lt;/ul>
&lt;h3 id="fast-forward-merge">Fast-forward Merge&lt;/h3>
&lt;p>å‡è®¾åˆå¹¶çš„åŒæ–¹ä¸º&lt;code>main&lt;/code>ä¸º&lt;code>dev&lt;/code>, å¦‚æœå…¶ä¸­ä¸€ä¸ªæ˜¯å¦ä¸€ä¸ªçš„ç¥–å…ˆ, æ­¤æ—¶ç›´æ¥ç§»åŠ¨ HEAD åˆ°å‰æ–¹å³å¯, ç§°ä¸º fast-forward.&lt;/p>
&lt;p>ä¾‹å¦‚, å½“å‰åœ¨ main, æ‰§è¡Œ&lt;code>git merge dev&lt;/code>çš„è¿‡ç¨‹å¦‚ä¸‹:&lt;/p>
&lt;pre tabindex="0">&lt;code> main main
| |
M1 --- M2 ===&amp;gt; M1 --- M2 -- F1
\ |
\--- F1 dev
|
dev
&lt;/code>&lt;/pre>&lt;h3 id="three-way-merge">three-way Merge&lt;/h3>
&lt;p>åˆå¹¶çš„ä¸¤è€…ä¸æ„æˆç›´æ¥çš„ç¥–å…ˆ-å­©å­å…³ç³», äº§ç”Ÿäº†åˆ†å‰. æ­¤æ—¶è¿›è¡Œåˆå¹¶å°±éœ€è¦æœ‰ä¸ªåŸºå‡†(å‚è€ƒ), å¯¹äºä¸¤è¾¹ç›¸è¾ƒäºåŸºå‡†çš„æ¯ä¸ª diff æ¥è¯´:&lt;/p>
&lt;ul>
&lt;li>åˆå¹¶çš„ä¸¤è€…éƒ½åœ¨åŸºå‡†ä¸Šè¿›è¡Œäº†æ”¹åŠ¨, ä¸”æ”¹åŠ¨ä¸ä¸€è‡´, &lt;strong>æ ‡è®°ä¸ºå†²çª&lt;/strong>&lt;/li>
&lt;li>å¦‚æœè¯¥ diff&lt;strong>ä»…åœ¨å…¶ä¸­ä¸€æ–¹&lt;/strong>æœ‰æ”¹åŠ¨, é‚£ä¹ˆå°±ä¿ç•™æ­¤æ¬¡æ”¹åŠ¨&lt;/li>
&lt;/ul>
&lt;p>åˆå¹¶æ—¶ä½¿ç”¨çš„å‚è€ƒå°±æ˜¯&lt;strong>ä¸¤ä¸ªåˆå¹¶ commit çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ&lt;/strong>, è¿™ç§å€ŸåŠ©ä¸‰ä¸ª commit(main, dev, å…¬å…±ç¥–å…ˆ)æ‰èƒ½å®Œæˆçš„åˆå¹¶æ“ä½œå°±å«åš three-way merge.&lt;/p>
&lt;p>ä¾‹å¦‚, å½“å‰åœ¨ main, æ‰§è¡Œ&lt;code>git merge dev&lt;/code>çš„è¿‡ç¨‹å¦‚ä¸‹:&lt;/p>
&lt;pre tabindex="0">&lt;code> main main
| |
M1 --- M2 --- M3 ===&amp;gt; M1 --- M2 --- M3 --- M4
\ \ /
\--- F1 \--- F1 ---
| |
dev dev
&lt;/code>&lt;/pre>&lt;blockquote>
&lt;p>three-way çš„åˆå¹¶æ–¹å¼å¦‚æœå‘ç”Ÿäº†å†²çª, ä¼šäº§ç”Ÿä¸€æ¬¡é¢å¤–çš„ merge commit, ä¸‹é¢ä»‹ç»å®ƒ&lt;/p>
&lt;/blockquote>
&lt;h3 id="ä»€ä¹ˆæƒ…å†µä¸‹-merge-commit-æ²¡æœ‰ä»»ä½•-diff">ä»€ä¹ˆæƒ…å†µä¸‹ merge commit æ²¡æœ‰ä»»ä½• diff?&lt;/h3>
&lt;p>æŒ‰ç…§ä¸Šé¢çš„ä¾‹å­, three-way merge å‘ç”Ÿå†²çªåä¼šäº§ç”Ÿä¸€æ¬¡é¢å¤–çš„ merge commit, å³ M4. å¦‚æœè¿™æ˜¯å»æŸ¥çœ‹ M4 ç›¸è¾ƒå‰ä¸€æ¬¡ commit çš„ diff, æœ‰æ—¶æ˜¯æ²¡æœ‰çš„, æœ‰æ—¶åˆä¼šäº§ç”Ÿ diff.&lt;/p>
&lt;p>å¦‚æœåœ¨è§£å†³å†²çªçš„è¿‡ç¨‹ä¸­, æˆ‘ä»¬ä»…ä»…æ˜¯æ¥æ”¶äº† M2,M3 æˆ–è€… F1 çš„ä¿®æ”¹, é‚£ä¹ˆæ­¤æ—¶ merge commit å°±ä¸ä¼šæœ‰ diff.&lt;/p>
&lt;p>ç„¶è€Œ, åœ¨è§£å†³å†²çªæ—¶, æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸é‡‡ç”¨æ¥è‡ªä¸¤æ¡è·¯å¾„çš„ä¿®æ”¹, åšä¸€æ¬¡æ–°çš„ä¿®æ”¹(å¯ä»¥è¯´, åŒæ—¶æ¥æ”¶ä¸¤æ¡ diff å°±æ˜¯è¿™ç§æƒ…å†µ), æ­¤æ—¶æŸ¥çœ‹ merge commit çš„ diff å°±æ˜¯æœ‰å†…å®¹çš„.&lt;/p>
&lt;h2 id="å˜åŸº-rebase">å˜åŸº: rebase&lt;/h2>
&lt;p>rebase å‘½ä»¤éœ€è¦æŒ‡å®šä¸€ä¸ª&lt;strong>åŸºå‡†åˆ†æ”¯&lt;/strong>ï¼Œ&lt;code>git rebase &amp;lt;base-branch&amp;gt;&lt;/code>ï¼Œ
rebase ä¼šå°†å½“å‰æ‰€å¤„åˆ†æ”¯æ•´ä½“ç§»åŠ¨åˆ°&lt;code>base-branch&lt;/code>ä¹‹åï¼Œå³æ”¹å˜äº†å½“å‰åˆ†æ”¯çš„å†å²ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>// before rebase
[A]---[B]---[C]---[D]&amp;lt;-dev
\
\--[E]&amp;lt;-master
// after rebase
[A]---[E]---[B]---[C]---[D]&amp;lt;-dev
|
master
&lt;/code>&lt;/pre>&lt;h3 id="äº¤äº’å¼-rebase">äº¤äº’å¼ rebase&lt;/h3>
&lt;p>äº¤äº’å¼ rebase æ˜¯ä¸€ç§æ›´é«˜çº§çš„ç”¨æ³•ã€‚åŸºç¡€çš„ rebase ä¸Šé¢è¯´äº†æ˜¯å°†å½“å‰åˆ†æ”¯çš„æ‰€æœ‰æäº¤ç§»åŠ¨åˆ° base-branch ä¹‹åã€‚è€Œäº¤äº’å¼ rebase æä¾›ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨ç§»åŠ¨ä¹‹å‰&amp;quot;æŒ‘é€‰&amp;quot;å½“å‰åˆ†æ”¯çš„ commitã€‚&lt;/p>
&lt;p>å®é™…å·¥ç¨‹ä¸­ï¼Œé€šå¸¸æ¥è¯´ï¼Œæˆ‘ä»¬å°†å¼€å‘åˆ†æ”¯ç§»åŠ¨åˆ° master ä¹‹å‰ï¼Œå¯ä»¥ç»è¿‡äº¤äº’ rebase æ¥æ•´ç†å¼€å‘åˆ†æ”¯ä¸­æ··ä¹±çš„ commit è®°å½•ã€‚&lt;/p>
&lt;p>å…·ä½“çš„ä½¿ç”¨æ–¹æ³•æ˜¯ï¼Œä¸º&lt;code>git rebase&lt;/code>æŒ‡ä»¤æä¾›&lt;code>-i&lt;/code>å‚æ•°:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>git checkout dev
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git rebase -i master
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªå‘½ä»¤ä¼šæ‰“å¼€ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œåˆ—å‡ºå½“å‰ feature åˆ†æ”¯çš„æ‰€æœ‰æäº¤:&lt;/p>
&lt;pre tabindex="0">&lt;code>pick 33d5b7a Message for commit #1
pick 9480b3d Message for commit #2
pick 5c67e61 Message for commit #3
&lt;/code>&lt;/pre>&lt;p>åˆ—å‡ºçš„å†…å®¹å°±èƒ½å®Œæ•´çš„è¡¨ç¤º dev åˆ†æ”¯çš„æ‰€æœ‰æäº¤ï¼ŒæŒ‰ç…§é¡ºåºã€‚è€Œæˆ‘ä»¬ä¸ä»…å¯ä»¥ä»»æ„çš„é‡æ’è¿™äº› commitï¼Œè€Œä¸”ä¿®æ”¹&lt;code>pick&lt;/code>å…³é”®å­—å°±èƒ½å¯¹è¿™äº› commit åšæ”¹åŠ¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯èƒ½å‘ç° commit2 åªæ˜¯å¯¹äº commit1 åšäº†ä¸€ä¸ªå¾ˆå°çš„æ”¹åŠ¨ï¼Œå®ƒä»¬å®Œå…¨å¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ª commitï¼Œé‚£ä¹ˆç›´æ¥ commit2 çš„&lt;code>pick&lt;/code>ä¿®æ”¹ä¸º&lt;code>fixup&lt;/code>ï¼Œæ•´ä¸ªå†…å®¹å˜ä¸º:&lt;/p>
&lt;pre tabindex="0">&lt;code>pick 33d5b7a Message for commit #1
fixup 9480b3d Message for commit #2
pick 5c67e61 Message for commit #3
&lt;/code>&lt;/pre>&lt;p>å½“ä½ ä¿å­˜å¹¶é€€å‡ºè¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œæ”¹åŠ¨å°±ä¼šç”Ÿæ•ˆï¼Œä¸ä»…å°† dev æ•´ä½“ç§»åŠ¨åˆ°äº† master åï¼Œå¹¶ä¸”åˆå¹¶äº†å‰ä¸¤ä¸ª commitã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>// after rebase interactive
[A]---[E]---[B]---[D]&amp;lt;-dev
|
master
&lt;/code>&lt;/pre>&lt;h3 id="rebase-æ•´ç†å¤šä¸ª-commit">rebase æ•´ç†å¤šä¸ª commit&lt;/h3>
&lt;p>å¦‚ä¸Šé¢äº¤äº’å¼ rebase æ‰€è¿°ï¼Œå½“ä½ å¼€å‘å®Œ dev åˆ†æ”¯ï¼Œéœ€è¦&lt;code>merge&lt;/code>åˆ° main åˆ†æ”¯æ—¶ï¼Œå¯ä»¥å…ˆåˆ©ç”¨äº¤äº’å¼ rebase&amp;quot;æ•´ç†&amp;quot;ä¸€ä¸‹ dev åˆ†æ”¯çš„ commitã€‚&lt;/p>
&lt;p>è¿™é‡Œå…¶å®è¦ç”¨åˆ°ä¸€ä¸ªå° trickï¼Œä¸Šé¢è¯´è¿‡ rebase å‘½ä»¤éœ€è¦æŒ‡å®šä¸€ä¸ª base-branchï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ª base-commitï¼Œè¿™ç§åœºæ™¯ä¸‹æˆ‘ä»¬ä¸æ˜¯è¦åˆå¹¶å…¶ä»–åˆ†æ”¯ï¼Œæ‰€ä»¥&lt;strong>base-branch&lt;/strong>å¯ä»¥é€‰æ‹©å½“å‰ dev åˆ†æ”¯çš„å‰é¢æŸä¸€æ¬¡ commitã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>git checkout dev
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git rebase -i HEAD~3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»¥ä¸ŠæŒ‡ä»¤å®ç°çš„åŠŸèƒ½å°±æ˜¯ç»™ä½ æ•´ç†æœ€å 3 æ¬¡æäº¤çš„æœºä¼šï¼Œä½†&lt;strong>ä¸ä¼šåˆå¹¶å…¶ä»–åˆ†æ”¯çš„ä¸œè¥¿&lt;/strong>ã€‚&lt;/p>
&lt;p>é‚£å¦‚æœæˆ‘æƒ³æ•´ç†æ•´ä¸ª dev åˆ†æ”¯å‘¢ï¼Ÿæ˜¯å‘ä¸Šæ‰¾åˆ° dev çš„ç¬¬ä¸€æ¬¡ commit å—ï¼Ÿ Git æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿æ‰¾åˆ° dev åˆ†å‰å‡ºæ¥çš„é‚£æ¬¡ commitï¼Œå°†å…¶è¾“å‡ºä¼ é€’ç»™&lt;code>git rebase -i&lt;/code>å³å¯å®ç°æ•´ç†æ•´ä¸ª dev çš„æ‰€æœ‰ commitã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>git merger-base dev main
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="git-merege-vs-git-rebase">&lt;code>git merege&lt;/code> vs &lt;code>git rebase&lt;/code>&lt;/h2>
&lt;h3 id="å‡†åˆ™">å‡†åˆ™&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>å¦‚æœåˆ†æ”¯å·²ç»è¢«æäº¤åˆ°è¿œç¨‹ä»“åº“ï¼Œå°±ä¸èƒ½å†æ”¹å˜ä»–çš„å†å²äº†ï¼Œå³ä¸èƒ½ä½¿ç”¨ rebaseã€‚
git ä¹Ÿä¼šé˜»æ­¢ä½ è¿™ä¹ˆåšï¼Œå› ä¸ºåˆ†æ”¯çš„å†å²å·²ç»è¢«ä¿®æ”¹ï¼Œé™¤é force-pushã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä½ èƒ½è¿›è¡Œ rebase çš„åˆ†æ”¯æ˜¯æœ¬åœ°çš„â€ç§äººåˆ†æ”¯â€ï¼Œç§äººè¡¨ç¤ºä¸º: åªæœ‰ä½ è‡ªå·±åœ¨ä½¿ç”¨ï¼Œåˆ«äººä¸ä¼šåŸºäºä½ çš„åˆ†æ”¯åšä¸œè¥¿ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="dev-åŒæ­¥ä¸»åˆ†æ”¯çš„æ”¹åŠ¨-rebase">dev åŒæ­¥ä¸»åˆ†æ”¯çš„æ”¹åŠ¨: rebase&lt;/h3>
&lt;p>å‡è®¾æˆ‘ä»¬æ­£åœ¨æœ¬åœ°çš„ dev åˆ†æ”¯å¼€å‘ä¸€ä¸ªç‰¹æ€§ï¼Œæ­¤æ—¶ä½ çš„åŒäº‹åœ¨ main(ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„è¿œç¨‹åˆ†æ”¯)ä¸Šæäº¤äº†ä¸€ä¸ªé‡è¦çš„ commitï¼Œä»¥è‡³äºä½ éœ€è¦å®ƒæ¥ç»§ç»­ä½ çš„å¼€å‘ä»»åŠ¡ã€‚&lt;/p>
&lt;p>è¿™ç§æƒ…å†µæˆ‘ä»¬ä½¿ç”¨ rebase å’Œ merge éƒ½èƒ½å®Œæˆç›®æ ‡ï¼Œä½†æ˜¯ rebase æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚&lt;/p>
&lt;ul>
&lt;li>é¦–å…ˆæ»¡è¶³ rebase çš„ä½¿ç”¨æ¡ä»¶ï¼Œæˆ‘ä»¬ä»…ä»…æ˜¯ç ´åäº†æœ¬åœ° dev åˆ†æ”¯çš„å†å²ï¼Œå¹¶æ²¡æœ‰åŠ¨åˆ°å…¶ä»–çš„è¿œç¨‹åˆ†æ”¯ï¼Œæ‰€ä»¥å°±ä¸å­˜åœ¨å¹²æ¶‰åˆ«äºº&lt;/li>
&lt;li>å…¶æ¬¡ï¼Œåœ¨ dev ä¸Š merge å…¶ä»–åˆ†æ”¯ä¼šäº§ç”Ÿä¸€æ¬¡ä¸å¿…è¦çš„&lt;em>merge commit&lt;/em>ï¼Œå…¶ä¸ä»£è¡¨ä»»ä½•å®é™…æ„ä¹‰ï¼Œæ²¡å¿…è¦å­˜åœ¨çš„&lt;/li>
&lt;/ul>
&lt;h3 id="åˆå¹¶-dev-åˆ°ä¸»åˆ†æ”¯-merge">åˆå¹¶ dev åˆ°ä¸»åˆ†æ”¯: merge&lt;/h3>
&lt;p>å¾ˆç®€å•çš„é€»è¾‘ï¼Œä¸»åˆ†æ”¯æˆ–è€…å…¶ä»–åˆä½œå¼€å‘çš„åˆ†æ”¯å¹¶ä¸æ˜¯ä½ ä¸€ä¸ªäººåœ¨ç”¨ï¼Œå¹¶ä¸”éœ€è¦æœ€ååŒæ­¥åˆ°è¿œç¨‹ä»“åº“ï¼Œä¸ç¬¦åˆä½¿ç”¨ rebase çš„å‡†åˆ™&lt;/p>
- https://wangloo.github.io/posts/git/ - @2019 Notepadium.</description></item><item><title>GNU äºŒè¿›åˆ¶å·¥å…·é›†</title><link>https://wangloo.github.io/posts/os/gnu_tools/</link><pubDate>Sat, 03 Dec 2022 19:08:22 +0800</pubDate><guid>https://wangloo.github.io/posts/os/gnu_tools/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/os/gnu_tools/ -&lt;p>..&lt;/p>
&lt;h2 id="nm---åˆ—å‡ºç¬¦å·">nm - åˆ—å‡ºç¬¦å·&lt;/h2>
&lt;p>&lt;a href="https://sourceware.org/binutils/docs/binutils/nm.html">nm (GNU Binary Utilities) (sourceware.org)&lt;/a>&lt;/p>
- https://wangloo.github.io/posts/os/gnu_tools/ - @2019 Notepadium.</description></item><item><title>Makefile ä¸€äº›æŠ€å·§</title><link>https://wangloo.github.io/posts/c/makefile_tricks/</link><pubDate>Sat, 03 Dec 2022 19:08:22 +0800</pubDate><guid>https://wangloo.github.io/posts/c/makefile_tricks/</guid><description>Wangloo's BLOG https://wangloo.github.io/posts/c/makefile_tricks/ -&lt;h2 id="ä¼ªç›®æ ‡çš„ä¾èµ–å…³ç³»">ä¼ªç›®æ ‡çš„ä¾èµ–å…³ç³»&lt;/h2>
&lt;p>Makefile ä¸­çš„ä¾èµ–å…³ç³»æŒ‡çš„æ˜¯ç›®æ ‡å’Œä¾èµ–ä¹‹é—´å»ºç«‹çš„å…³ç³»ï¼Œç›®æ ‡å¯¹åº”è§„åˆ™ä¸­çš„è¯­å¥æ˜¯å¦æ‰§è¡Œå–å†³äºä¾èµ–çš„çŠ¶æ€ã€‚&lt;/p>
&lt;p>æœ€ç®€å•çš„ä¾èµ–å…³ç³»å¯ä»¥æ‹¿ä¸¤ä¸ªæ–‡ä»¶æ¥ä¸¾ä¾‹:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-makefile" data-lang="makefile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># gccè¯­å¥æ‰§è¡Œå½“å‰ä»…å½“ main.c æ–°äº main.elf
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#50fa7b">main.elf&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> main.c
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> gcc main.c -o main.elf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>make åœ¨æ‰§è¡Œ&lt;code>main.elf&lt;/code>çš„è§„åˆ™æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­ä¾èµ–å…³ç³»ã€‚æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œ
gcc è¯­å¥æ˜¯å¦æ‰§è¡Œå–å†³äº&lt;code>main.c&lt;/code> å’Œ &lt;code>main.elf&lt;/code>çš„ä¿®æ”¹æ—¶é—´ï¼Œ&lt;strong>åªæœ‰å½“
ä¾èµ–æ–°ä¸ç›®æ ‡æ—¶ï¼Œè§„åˆ™è¯­å¥æ‰ä¼šæ‰§è¡Œ&lt;/strong>ã€‚&lt;/p>
&lt;p>ç„¶è€Œè®¸å¤šæƒ…å†µä¸‹ï¼Œç›®æ ‡æˆ–è€…ä¾èµ–å¹¶ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œæ˜¯&lt;strong>è™šæ‹Ÿç›®æ ‡&lt;/strong>ã€‚è™šæ‹Ÿç›®æ ‡
å¹¶ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå³å®ƒæ²¡æœ‰ä¿®æ”¹æ—¶é—´è¿™ä¸ªå±æ€§ï¼Œæ­¤æ—¶ make å°±ä¸èƒ½ä½œæ¯”è¾ƒï¼Œç»“æœå°±æ˜¯
&lt;strong>å¦‚æœç›®æ ‡æ˜¯ä¼ªç›®æ ‡ï¼Œé‚£ä¹ˆä¸ç®¡ä¾èµ–å¦‚ä½•éƒ½æ‰§è¡Œè§„åˆ™è¯­å¥ï¼›å¦‚æœä¾èµ–æ˜¯ä¼ªç›®æ ‡ï¼Œ
é‚£ä¹ˆç›®æ ‡çš„è§„åˆ™è¯­å¥ä¹Ÿæ°¸è¿œè¢«æ‰§è¡Œ&lt;/strong>ã€‚ä¸‹é¢æ˜¯ä¸¤ä¸ªä¾‹å­ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-make" data-lang="make">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># ä¼ªç›®æ ‡ä½œä¸ºç›®æ ‡æ–‡ä»¶å‡ºç°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># build finishæ€»æ˜¯è¾“å‡ºï¼Œ è€Œgccè¯­å¥ä»…å½“main.cæ¯”main.elfæ–°æ—¶æ‰æ‰§è¡Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#50fa7b">.PHONY &lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> all
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">all&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> main.elf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @echo &lt;span style="color:#f1fa8c">&amp;#39;build finish&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">main.elf&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> main.c
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> gcc $&amp;lt; -o &lt;span style="color:#8be9fd;font-style:italic">$@&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-make" data-lang="make">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># ä¼ªç›®æ ‡ä½œä¸ºä¾èµ–æ–‡ä»¶ä¸­å‡ºç°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># ä¸ç®¡main.cæ˜¯å¦æ¯”main.elfæ›´æ–°ï¼Œå› ä¸ºpre-workæ˜¯ä¼ªç›®æ ‡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># æ‰€ä»¥gccè¯­å¥æ€»æ˜¯æ‰§è¡Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#50fa7b">.PHONY &lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> pre-work
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">main.elf&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> main.c pre-work
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> gcc $&amp;lt; -o &lt;span style="color:#8be9fd;font-style:italic">$@&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šé¢çš„ä»£ç çš„æ•ˆæœæ˜¯ï¼šä¸¤æ¡è§„åˆ™ä¸­çš„è¯­å¥éƒ½ä¼šæ‰§è¡Œï¼Œå³ä½¿ä½ å¹¶æ²¡æœ‰å¯¹ main.c åšä»»ä½•ä¿®æ”¹ï¼&lt;/p>
&lt;h2 id="ææ€–çš„ç©ºæ ¼">ææ€–çš„ç©ºæ ¼&lt;/h2>
&lt;p>Makefile ä¸­çš„å˜é‡ç»“åˆå¾ˆå¸¸è§ï¼Œä¾‹å¦‚&lt;code>$(FIXDEP)=$(FIXDEP_PATH)/build/fixdep&lt;/code>.&lt;/p>
&lt;p>ç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬è¿™äº›è¯­å¥æ˜¯ä»æŸäº›åœ°æ–¹ç²˜è´´è¿‡æ¥ï¼Œè¦ç‰¹åˆ«æ³¨æ„å˜é‡ä¸­æ˜¯å¦æœ‰ç©ºæ ¼ï¼ŒMakefile éå¸¸é‡è§†è¿™ä¸ªã€‚å‡å¦‚&lt;code>$(FIXDEP_PATH)&lt;/code>ä¸­æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œé‚£ä¹ˆ&lt;code>$(FIXDEP)&lt;/code>å°±å˜æˆ&lt;strong>ä¸¤ä¸ªå®&lt;/strong>äº†ï¼ˆä¸çŸ¥é“å«å®åˆä¸åˆé€‚ï¼‰ã€‚è€Œä¸” Make çš„æ‰§è¡Œè¿‡ç¨‹å¾ˆéš¾æ£€æŸ¥å‡ºæ¥ã€‚&lt;/p>
&lt;h2 id="è§„åˆ™çš„æ‰§è¡Œé¡ºåº">è§„åˆ™çš„æ‰§è¡Œé¡ºåº&lt;/h2>
&lt;p>å¦‚æœä¸ä»å‘½ä»¤è¡Œä¼ å…¥ç›®æ ‡, Makefile ä¸­å®šä¹‰çš„è§„åˆ™å…¶å®æ˜¯ä»¥&lt;strong>ä»ä¸Šè€Œä¸‹&lt;/strong>çš„é¡ºåºæ‰§è¡Œçš„, ä½†æ˜¯æˆ‘ä¹ æƒ¯æŠŠ &lt;code>all&lt;/code> è¿™ç§é»˜è®¤è§„åˆ™æ”¾åœ¨æœ€ä¸‹é¢, æ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¾ˆå¤š Makefile ä¼šåœ¨å¼€å¤´å†™ä¸€å¥è§„åˆ™&lt;code>all:&lt;/code>, ä½œç”¨å°±æ˜¯å‘Šè¯‰ make é»˜è®¤(ä¸æ˜¾å¼æŒ‡å®š)çš„ç›®æ ‡æ˜¯&lt;code>all&lt;/code>.&lt;/p>
&lt;blockquote>
&lt;p>Busybox æ ¹ç›®å½• Makefile ä¸­çš„åšæ³•ç¤ºä¾‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-makefile" data-lang="makefile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4"># That&amp;#39;s our default target when &amp;gt;none is given on the command line
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#6272a4">&lt;/span>&lt;span style="color:#50fa7b">.PHONY&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> _all
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">_all&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/blockquote>
&lt;h2 id="å‡½æ•°çš„é­”æ³•">å‡½æ•°çš„é­”æ³•&lt;/h2>
&lt;h3 id="patsubst">patsubst&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-make" data-lang="make">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">patsubst&lt;/span> &amp;lt;&lt;span style="color:#8be9fd;font-style:italic">pattern&lt;/span>&amp;gt;,&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">replacement&lt;/span>&amp;gt;,&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">text&lt;/span>&amp;gt;&lt;span style="color:#ff79c6">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åŠŸèƒ½ï¼šæŸ¥æ‰¾&lt;code>&amp;lt;text&amp;gt;&lt;/code>ä¸­çš„å•è¯ï¼ˆä»¥ç©ºæ ¼ï¼Œtabï¼Œå›è½¦ï¼Œæ¢è¡Œåˆ†å‰²ï¼‰ï¼Œçœ‹å…¶æ˜¯å¦ç¬¦åˆ&lt;code>&amp;lt;pattern&amp;gt;&lt;/code>,
å¦‚æœç¬¦åˆï¼Œå°†å…¶ä½¿ç”¨&lt;code>&amp;lt;replacement&amp;gt;&lt;/code>æ›¿æ¢ã€‚å¯ä»¥ä½¿ç”¨é€šé…ç¬¦&lt;code>%&lt;/code>ã€‚&lt;/p>
&lt;p>ä»¥ä¸‹ä¸¤å¯¹æ˜¯ç­‰æ•ˆçš„, æ˜æ˜¾è¿˜æ˜¯ç›´æ¥ä½¿ç”¨å˜é‡çš„æ›¿æ¢è¯­æ³•æ“ä½œç®€å•:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-make" data-lang="make">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">patsubst&lt;/span> &amp;lt;&lt;span style="color:#8be9fd;font-style:italic">pattern&lt;/span>&amp;gt;,&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">replacement&lt;/span>&amp;gt;,&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">var&lt;/span>&lt;span style="color:#ff79c6">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">$(var&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span>&amp;lt;pattern&amp;gt;=&amp;lt;replacement&amp;gt;;)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">patsubst&lt;/span> %&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">suffix&lt;/span>&amp;gt;,%&amp;lt;&lt;span style="color:#8be9fd;font-style:italic">replacement&lt;/span>&amp;gt;,&lt;span style="color:#ff79c6">$(&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">var&lt;/span>&lt;span style="color:#ff79c6">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">$(var&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span>&amp;lt;suffix&amp;gt;=&amp;lt;replacement&amp;gt;)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ä½¿ç”¨-shell-å˜é‡">ä½¿ç”¨ shell å˜é‡&lt;/h2>
&lt;p>Make å°† &lt;code>$$var&lt;/code> è½¬ä¹‰ä¸º&lt;code>$var&lt;/code>, ä¾› shell å¤„ç†.&lt;/p>
&lt;p>demo(æºè‡ª 6.828 æ ¹ç›®å½•&lt;code>GNUmakefile&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-makefile" data-lang="makefile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#50fa7b">handin-check&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @if &lt;span style="color:#8be9fd;font-style:italic">test&lt;/span> -n &lt;span style="color:#f1fa8c">&amp;#34;`git status -s`&amp;#34;&lt;/span>; &lt;span style="color:#ff79c6">then&lt;/span> &lt;span style="color:#f1fa8c">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f1fa8c">&lt;/span> git status -s; &lt;span style="color:#f1fa8c">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f1fa8c">&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">read&lt;/span> -p &lt;span style="color:#f1fa8c">&amp;#34;Untracked files will not be handed in. Continue? [y/N] &amp;#34;&lt;/span> r; &lt;span style="color:#f1fa8c">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f1fa8c">&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">test&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">$$&lt;/span>&lt;span style="color:#f1fa8c">r&amp;#34;&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> y; &lt;span style="color:#f1fa8c">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f1fa8c">&lt;/span> &lt;span style="color:#ff79c6">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>ä»¥ä¸Š demo è¿˜ä½¿ç”¨äº† test å‘½ä»¤æ¥ç»ˆæ­¢ make çš„æ‰§è¡Œ, å¦‚æœç”¨æˆ·æ²¡æœ‰è¾“å…¥&lt;code>y&lt;/code>, make å°†ä¼šç»ˆæ­¢æ‰§è¡Œ&lt;/p>
&lt;/blockquote>
- https://wangloo.github.io/posts/c/makefile_tricks/ - @2019 Notepadium.</description></item></channel></rss>