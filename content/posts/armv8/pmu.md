---
title: "Cortex-A53 PMU介绍"
date: 2023-09-02T22:02:04+08:00
tags: [armv8]
categories: ["Architecture"]
---

# 关于PMU

PMU是一个独立的单元，不和体系结构绑定。而是每个SOC都可以不同。比如说Cortex-A53实现了PMUv3架构，但别的基于ARMv8架构的Soc可能实现PMUv4或者其他版本。

PMU内部有六个计数器，所以可以记录六个事件的发生次数。计数器的数值不一定绝对的正确，因为管道的存在，所以一般来说还是通过长时间计数来减弱影响。

# PMU和ETM的区别

## 1. 记录的事件不同
- PMU：Cache Miss、分支预测失败、TLB Miss等
- ETM：记录分支指令、内存屏障指令等所有指令的执行，包括地址、结果等。
  另外还可以记录数据读写的地址、结果（可选）。
## 2. 记录的粒度不同
- PMU：仅用计数器来记录事件发生的次数
- ETM：指令的类型、地址、执行结果等。数据访问也类似。

所以说，ETM的信息量大，需要专门的缓存机制。而PMU只需在定时器结束时记录发生的次数就行，
不需要什么缓存，没有实际的数据流。